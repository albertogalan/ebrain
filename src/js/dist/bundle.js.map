{"version":3,"sources":["../../../../../../usr/local/lib/npm/lib/node_modules/browserify/node_modules/browser-pack/_prelude.js","main.js","node_modules/money/money.js"],"names":[],"mappings":"AAAA;ACAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACn+BA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"bundle.js","sourcesContent":["(function(){function r(e,n,t){function o(i,f){if(!n[i]){if(!e[i]){var c=\"function\"==typeof require&&require;if(!f&&c)return c(i,!0);if(u)return u(i,!0);var a=new Error(\"Cannot find module '\"+i+\"'\");throw a.code=\"MODULE_NOT_FOUND\",a}var p=n[i]={exports:{}};e[i][0].call(p.exports,function(r){var n=e[i][1][r];return o(n||r)},p,p.exports,r,e,n,t)}return n[i].exports}for(var u=\"function\"==typeof require&&require,i=0;i<t.length;i++)o(t[i]);return o}return r})()","//\n// function saveintobrowser(filename,html){\n//\n// // filename=$( \"#tittle\" ).val()\n// // html=evt.editor.getData()\n// // lack of sync into the server\n//   var db = new Dexie(\"m13\");\n//   db.version(1).stores({\n//     files: \"filename,html\"\n//   });\n//\n//   db.open().catch(function (e) {\n//      alert (\"Open failed: \" + e);});\n//\n//\n//   db.transaction(\"rw\", db.files, function () {\n//       // Update the register if exists if not add\n//      db.files.where(\"filename\").equals(filename).modify({html: html}).then(function(updated)\n//      {\n//        if (updated)\n//            console.log (\"pedro found and update\");\n//        else\n//        {\n//        console.log (\"pedro not found \");\n//        db.files.add({filename: $( \"#tittle\" ).val(), html:  evt.editor.getData()});} });   });\n//\n// };\n\n\nvar ctrlI = false;\nvar fx = require('money');\n// require('ckeditor');\n// CKEDITOR.replace( 'editor' );\n\n\n// Add an event listener\ndocument.addEventListener(\"name-of-event\", function(e) {\n    // console.log(e.detail); // Prints \"Example of an event\"\n});\n\n\n// $(\".videolink\").click(function(){\n\n//     var src = $(this).attr(\"value\");\n//    // alert(src);\n// // console.log(evt);\n// // console.log($(this));\n// // console.log(\"clicked videolink in ckeditor\");\n// loadVideo(src);\n\n\n// })\n\n// function loadVideo2(){\n\n//     console.log('clicked loadVideo2');\n// }\n\n\n$(document).ready(function() {\n\n    // var b1 = document.getElementById(\"MW\");\n    // b1.tabIndex = 5; //change the default tabindex\n\n\n\n        var url = getParameterByName('url');\n    if (url) {\n\n        // console.log(url);\n\n        $(\"#tittle\").val(url);\n        $(\"#rename\").val(url);\n        //  read();\n        //$(\".first_editor\").focus();\n        // $(\"#tittle\").focus().select();\n    } else {\n        $(\"#tittle\").focus().select();\n    }\n\n\n    // loadautosearch(\"/resources/files2.json\");\n\n\n    // $( \".first_editor h3\" ).click(function() {\n    //   alert('clicked');\n    //   $(this).nextUntil( \".first_editor h3, .first_editor h2\" ).toggle();\n    // });\n    // $( \".first_editor h4\" ).click(function() {\n    //   $(this).nextUntil( \".first_editor h4, .first_editor h3 \" ).toggle();\n    // });\n    //\n    // $( \"h2\" ).click(function() {\n    //   $(this).next( \"h2, h1\" ).toggle();\n    // });\n    //\n    // $( \"h1\" ).click(function() {\n    //   $(this).next( \"h1\" ).toggle();\n    // });\n\n\n\n   $(\".jieba\").dblclick(function() {\n\ntext=$(this).text()\n\nlang='zh'\nlangto='en'\n fanyi(text, lang, langto).then(function(aa) {\n                        console.log(aa.src)\n                           aa.dst=aa.pinyin +\"<br>\"+ aa.translate +aa.handi\n                           var trad = aa.src + ': </br> ' + aa.dst+ aa.audio;\n                           \n                           $('#fanyi55').html(trad)\n                    })\n\n\n    });\n\n\n    $(\"button#autotrans\").click(function() {\n        // $(\"span[lang='zh-cn']\").each(function(i, v) {\n\n            $(\"span[lang='zh-cn']\").css('color', 'red')\n            \n            let lang = 'zh'\n            let langto = 'en'\n            let bb = $(\"span[lang='zh-cn']:eq(1)\").text()  \n            console.log(`to translate: ${bb}`)\n            fanyi(bb, 'zh', 'en').then(function(aa) {\n                let translation = \"<span class='original' lang='\" + lang + \"' data-pseudo-content='\" + aa.src + \"' >&nbsp;</span><span class='translate'  lang='\" + langto + \"' >\" + aa.translate + \"</span>\"\n                console.log(aa.i)\n                $(\"span[lang='zh-cn']:eq(1)\").html(translation)\n                $(\"span[lang='zh-cn']:eq(1)\").attr('lang','')\n            })\n\n    })\n\n\n\n\n    $(\"button#trans\").click(function() {\n        console.log('clicked translate')\n        $(\".translate\").show();\n        $(\".original\").hide();\n\n\n    });\n\n    $(\"button#showtranslate\").click(function() {\n        console.log('clicked showtranslate')\n        $(\".translate\").show();\n        $(\".original\").show();\n\n    });\n\n\n    $(\"button#addabsolutepath\").click(function() {\n\n        console.log('clicked addabsolutepath2')\n\n\n        $('img').each(function(i, v) {\n            if ($(this).attr('src').includes(\"http\")) {\n                console.log('not change')\n\n            } else {\n                var aaa = 'http://i487.lxc/' + $(this).attr('src');\n                $(this).attr('src', aaa);\n                console.log($(this).attr('src'))\n            }\n        });\n\n    });\n\n    $(\"button#sharelink\").click(function() {\n\n\n        console.log('clicked sharelink ')\n        console.log(\"http://i487.lxc/ebrain?url=\" + $('#tittle').val())\n\n        $.getJSON('ebrain?url=' + $('#tittle').val(),\n            function(data) {\n\n                $('#sharelink').attr('href', 'http://i487.lxc/view.php?url=' + data.hash)\n\n            })\n\n\n    });\n\n    $(\"button#updatecost\").click(function() {\n        console.log('clicked updatedcost ')\n\n        $.getJSON(\n            // NB: using Open Exchange Rates here, but you can use any source!\n            'https://openexchangerates.org/api/latest.json?app_id=960f0b8dca9344328b13ef816957d810',\n            function(data) {\n                // Check money.js has finished loading:\n                if (typeof fx !== \"undefined\" && fx.rates) {\n                    fx.rates = data.rates;\n                    fx.base = data.base;\n\n\n                    console.log('updating cost...')\n\n                    $('.cost').each(function(i, v) {\n                        aa = $(this).attr('data-cost')\n                        total = Math.round(fx(aa).from(\"CNY\").to(\"EUR\") / 0.0095) / 100;\n                        console.log(\"converting CNY into EUR\" + fx(1).from(\"CNY\").to(\"EUR\"));\n                        $(this).text(total)\n                    });\n  \n                } else {\n                    // If not, apply  to fxSetup global:\n                    var fxSetup = {\n                        rates: data.rates,\n                        base: data.base\n                    }\n\n                }\n                var d = new Date();\n                var datetime = d.getFullYear() + '-' + d.getMonth() + '-' + d.getDate();\n                editor.insertHtml(\"<span class='information'> date: \" + datetime + \" CNY to EUR Convert rate is  \" + fx(1).from(\"CNY\").to(\"EUR\") + \"</span>\")\n            }\n        );\n\n\n\n\n\n\n    });\n    // https://openexchangerates.github.io/money.js/#download\n\n\n    $(\"#tittle\").focusout(function() {\n        // console.log('1');\n\n        console.log($(\"#tittle\").val());\n        $(\"#rename\").val($(\"#tittle\").val());\n        $('.first_editor').attr('id', $(\"#tittle\").val());\n        $('.first_editor').attr(\"contenteditable\", \"true\");\n        $('.first_editor').focus();\n        read();\n        // editor.setData($( \"#hidden\" ).html());  // load data in the editor\n\n        // hljs.initHighlightingOnLoad();\n\n    });\n\n\n\n\n    $(\"#rename\").focusout(function() {\n        // console.log('2');\n\n        if ($(\"#tittle\").val() == $(\"#rename\").val())\n\n            // editor.setData($( \"#hidden\" ).html());  // load data in the editor\n            read();\n        else {\n            rename();\n        }\n\n\n    });\n\n\n\n\n\n    CKEDITOR.instances['introduction'].destroy();\n    var editor = CKEDITOR.inline(\"introduction\");\n\n\n\n\n    document.addEventListener('paste', function(e) {\n        //    var html = e.clipboardData.getData (\"Text\");\n        // e.preventDefault();\n        //      if ( ctrlI ){\n        //        // CKEDITOR.instances['introduction'].destroy();\n        //        //\n        //        //    var editor = CKEDITOR.inline(\"introduction\");\n        //\n        //        console.log (\"paste event\");\n        //        // editor.insertHtml(html);\n        //      }\n        //    // var html = e.clipboardData.getData('text/html');\n        //    console.log(html);\n        //    // Whatever you want to do with the html\n    });\n\n\n    editor.on('paste', function(evt) {\n        evt.stop();\n        var data = evt.data.dataValue;\n\n        if (window.chrome || window.safari) {\n            // removing span wrapper on webkit browsers.\n            data = $(data).html();\n        }\n        evt.editor.insertHtml(data);\n    });\n\n\n\n    editor.on('key', function(evt) {\n        // console.log('3');\n        //http://stackoverflow.com/questions/4401469/how-to-select-a-text-range-in-ckeditor-programatically\n\n        var charCode = evt.data.keyCode; // at the moment this is wrong, keyCode needs to be properly converted to charCode\n        // var clipboardData = evt.data.dataValue;\n        console.log(charCode);\n        var tag = \"h1\";\n        //  console.log(selectedText);\n        switch (charCode) {\n            case 1114161: // Ctrl 1\n                tag = \"<h1></h1>\";\n                break;\n            case 1114162: // Ctrl 2\n                tag = \"<h2></h2>\";\n                break;\n            case 1114163: // Ctrl 3\n                tag = \"<h3></h3>\";\n                break;\n            case 1114164: // Ctrl 4\n                tag = \"<h4></h4>\";\n                break;\n            case 1114166: // Ctrl 6\n                tag = \"<h5></h5>\";\n                break;\n            case 1114169: // Ctrl 6\n                editor.insertHtml(\"<div class='savetofile'>put text</div>\");\n                break;\n\n            case 1114300: // Ctrl ,\n                console.log('convert Coin');\n\n                sel = editor.getSelection().getSelectedText()\n                console.log(sel)\n\n                editor.insertHtml(convertCoin(sel, \"yuan\", \"euro\"))\n                $('p:has(span.cost)').addClass('middle');\n\n                break;\n\n\n            case 1114304: // Ctrl `\n                console.log('request fanyi');\n                let lang = $(\"#lang\").val(),\n                    langto = $(\"#langto\").val()\n\n\n\n                sel = editor.getSelection().getSelectedText().replace(/(\\r\\n\\t|\\n|\\r\\t)/gm, \"\");\n                if (sel.length > 0) {\n                    fanyi(sel, lang, langto).then(function(aa) {\n                        let translation = \"<span class='original' lang='\" + lang + \"' data-pseudo-content='\" + aa.src + \"' >&nbsp;</span><span class='translate'  lang='\" + langto + \"' >\" + aa.translate + \"</span>\"\n                        editor.insertHtml(translation);\n                    })\n                }\n\n\n\n                break;\n\n\n\n            case 5570638: // Ctrl Alt N\n                // tag=\"<b></b>\";\n                tag = \"<em></em>\"; //emphasis\n                break;\n\n\n            case 5570637: // Ctrl Alt M\n                tag = \"<mark></mark>\";\n                break;\n            case 5570628: // Ctrl Alt D\n                var d = new Date();\n                var datetime = d.getFullYear() + '-' + d.getMonth() + '-' + d.getDate();\n                tag = \"<del datetime=\" + datetime + \" title=\" + datetime + \"></div>\"; //del text\n                break;\n            case 5570633: // Ctrl Alt I\n                tag = \"<em></em>\"; //emphasis\n                break;\n            case 2228314: // Shift Z   Test\n                $(\"#cke_3_top\").toggle();\n                break;\n            case 3342408: // CTRL Shift H  Hide/show tool bar\n                // evt.data.stopPropagation();\n                // evt.data.preventDefault();\n                $(\"#cke_3_top\").toggle();\n                break;\n            case 1114195: //Ctrl S save a version\n                version();\n                if ($('.savetofile').length > 0)\n                    save(evt, \"savetofile\");\n\n                break;\n\n            case 3342404: // Ctrl Shift D  Insert detail/Summary html\n                var sel = editor.getSelection().getSelectedText();\n                if (sel.length > 0) {\n                    var details = new CKEDITOR.dom.element('details');\n                    details.setHtml(' <summary>' + sel + '</summary><p>More info about the details.</p>');\n                    editor.insertElement(details);\n                }\n                break;\n            case 1114191: // Ctrl O  Open codeSnippet dialog\n                editor.execCommand('codeSnippet'); //widget\n                break;\n\n            case 1114185: // Ctrl I  Inserthtml\n                // var sel = editor.getSelection().getSelectedText();\n                ctrlI = !ctrlI;\n\n                // evt.data.dataValue = evt.data.dataValue\n                // editor.fire( 'paste',editor);\n                // console.log(e.clipboardData.getData('text/html'));\n\n                // This code obviously will not preserve the case of the first and last letters.\n                // Let it be an exercise for the reader ;).\n                // editor.execCommand( 'inserthtml4x');  //widget\n\n                break;\n\n            case 1114182: // Ctrl F open dialog Find and replace\n                editor.execCommand('find');\n                break;\n\n            case 3342402: // Ctrl Shift B\n                editor.insertHtml(\"<br/>\");\n                break;\n                // case 7798868:// Ctrl ALT SHIT T\n                //   editor.insertHtml( \"<table class=table1Class' > <tbody> \\\n                //      <tr><td>1</td><td>2</td></tr><tr><td>1</td><td>2</td></tr> \\\n                //      </tbody></table>\");\n                //   //  editor.insertHtml( clipboardData);\n                //     // console.log(clipboardData);\n                //    break;\n            case 3342422: // Ctrol shift V\n                texto = 'Crtl + SHIFT V'; // Ctrl 1\n                // text = window.clipboardData.getData(\"Text\");\n                // console.log(texto);\n                // editor.insertHtml( clipboardData);\n                // console.log(texto);\n                break;\n            default:\n                texto = 'Other key';\n        }\n\n\n        var keypress = [1114161, 1114162, 1114163, 1114164, 1114166, 1114169, 5570637, 5570628, 5570633, 5570638];\n        // console.log(keypress.indexOf(charCode));\n        if (keypress.indexOf(charCode) > -1) { // retag the select area\n            var sel = editor.getSelection().getSelectedText();\n            if (sel.length > 0) {\n                //  var newElement = new CKEDITOR.dom.element(tag);\n                var newElement = CKEDITOR.dom.element.createFromHtml(tag)\n                // newElement.setAttributes({style: ''});\n                newElement.setText(sel);\n                editor.insertElement(newElement);\n            } else {\n                var newElement = new CKEDITOR.dom.element(tag);\n                // newElement.setAttributes({style: ''});\n                newElement.setText(sel);\n                //  editor.insertElement(newElement).selectElement();\n                //  editor.getSelection().selectElement(newElement);\n\n            }\n        }\n\n\n    });\n\n\n\n\n\n    // override shortcut firefox keyboard\n    $('.first_editor').keypress(function(event) {\n\n        // console.log('4');\n\n\n        // console.log('evento es: '+ event.key +'shift: '+event.ctrlKey + 'crtl: '+ event.ctrlKey);\n        var a = event.key;\n        var b = event.ctrlKey;\n        var c = event.shiftKey;\n        var d = event.altKey;\n        var response = event.key + event.ctrlKey + event.shiftKey + event.altKey;\n        //  console.log(response);\n        // console.log(b);\n        switch (true) {\n\n\n            case (a == 'F' && b && c && d):\n                var sel = editor.getSelection().getSelectedText();\n                sel = sel.replace(/\\s+/g, '+');; //replace any space with +\n                openInNewTab('https://en.wikipedia.org/w/index.php?search=' + sel);\n                // console.log(sel);\n                break;\n\n            case (a == 'F' && b && c):\n                var sel = editor.getSelection().getSelectedText();\n                sel = sel.replace(/\\s+/g, '+');; //replace any space with +\n                openInNewTab('https://www.google.com/search?q=' + sel);\n                // console.log(sel);\n                break;\n\n\n            case (a == 'H' && b && c):\n            case (a == 's' && b):\n                event.preventDefault(); //avoid other shortcut keys\n                break;\n\n                // case (a == 'L' && b  && c) : // Ctrl Shift L\n                //      event.preventDefault(); //avoid other shortcut keys\n                //     text = editor.getClipboardData(\"Text\");\n                //\n                //      console.log(text);\n                //\n                // break;\n\n\n\n\n            case (a == 'i' && b && d): //Ctrl Alt i\n                editor.execCommand('mathjax'); //widget\n                break;\n\n            case (a == 'i' && b):\n                // console.log('press ctrl I');\n                event.preventDefault(); //avoid other shortcut keys\n\n                editor.execCommand('inserthtml4x'); //widget\n                break;\n\n\n\n        }\n\n\n        // if (event.key === 'H' && event.ctrlKey && event.shiftKey  )\n        //     event.preventDefault();\n        // if (event.key === 's' && event.ctrlKey  )\n        //     event.preventDefault();\n    });\n\n\n    editor.on('paste', function(evt) {\n\n        //\n        // if ( ctrlI == 1){\n        //\n        //   // var html = editor.getClipboardData(\"Text\");\n        //   // console.log (\"paste event\" + html);\n        //   // editor.insertHtml(html);\n        //   ctrlI=0;\n        //   editor.getClipboardData( { title: 'Get my data' }, function( data ) {\n        //       if ( data )\n        //           console.log( 'data is: ' + data.dataValue );\n        //   } );\n        //\n        // }\n        //\n\n\n\n\n        // highlightjsworkers();\n    });\n\n\n    editor.on('focus', function(evt) {\n        // highlightjsworkers();\n    });\n\n    editor.on('click', function(evt) {\n\n        console.log('click');\n\n    });\n\n    editor.on('doubleclick', function(evt) {\n        var element = evt.data.element;\n        //console.log('doubleclick');\n        classe = element.getAttribute(\"class\");\n        if (classe == 'videolink') {\n            loadVideo(element);\n        }\n        classe = element.getAttribute(\"class\");\n        if (classe == 'videolink') {\n            loadVideo(element);\n        }\n        var tag = element.getName();\n        // console.log(tag);\n        if (tag == 'a') {\n            url = element.getAttribute(\"href\");\n            openInNewTab(url);\n            // console.log ('click link'+ url);\n\n\n        }\n\n    });\n\n\n\n\n    editor.on('blur', function(evt) {\n\n        console.log(\"blurr\");\n\n        save(evt, \"save\");\n        // editor.focus();\n\n    });\n\n\n    //change event\n    editor.on('change', function(evt) {\n        // console.log( 'Total bytes: ' + evt.editor.getData().length );\n        // console.log('saved'+$( \"#tittle\" ).val());\n        // $.post( \"/inc/save.php\", { editabledata: evt.editor.getData(), editorID: $( \"#tittle\" ).val() } );\n\n    });\n\n});\n\n\nfunction openInNewTab(url) {\n    var win = window.open(url, '_blank');\n    win.focus();\n}\n\nfunction hashCode(str) {\n    var hash = 0;\n    if (str.length == 0) return hash;\n    for (i = 0; i < str.length; i++) {\n        char = str.charCodeAt(i);\n        hash = ((hash << 5) - hash) + char;\n        hash = hash & hash; // Convert to 32bit integer\n    }\n    return hash;\n}\n\n\nfunction convertCoin(value,coin, tocoin) {\n    console.log('convertCoin')\n\n    let aa=\"<span data-cost='\" + value + \"' data-coin='\" + coin + \"' data-coin-convert='\" + tocoin + \"' class='cost'>To convert \" + coin + \" into \" + tocoin + \" \" + value + \"</span>\"\n    // $('td p:has(span.cost)').addClass('middle');\n    return aa\n}\n\n\nfunction doSomething() {\n    return new Promise((resolve, reject) => {\n        console.log(\"It is done.\");\n        // Succeed half of the time.\n        if (Math.random() > .5) {\n            resolve(\"SUCCESS\")\n        } else {\n            reject(\"FAILURE\")\n        }\n    })\n}\n\n\n\n\nfunction fanyi(text, lang, langto) {\n    return new Promise((resolve, reject) => {\n        console.log(`It is done. ${text} ${lang} ${langto}`);\n        // Succeed half of the time.\n        // lang = 'zh'\n        // langto = 'en'\n        var url = 'http://i487.lxc/fanyi'\n        var headers = {\n            \"Content-Type\": \"application/json\"\n        };\n        var data = {\n            \"from\": lang,\n            \"to\": langto,\n            \"src\": text,\n            \"i\":'1'\n        };\n        console.log('this is the text to translate ' + text)\n\n        var encode_params = $.param(data, true)\n        var url = url + '?' + encode_params\n\n        $.getJSON(url, function(data) {\n\n            resolve(data)\n        });\n\n\n    })\n\n}\n\n\n\n\n\n\nfunction message(str) {\n\n    $(\"#saving\").html(str).css({ opacity: 0.99 });\n    $(\"#saving\").animate({ opacity: 0 }, 1200);\n}\n\nfunction basename(path, suffix) {\n    var b = path\n    var lastChar = b.charAt(b.length - 1)\n\n    if (lastChar === '/' || lastChar === '\\\\') {\n        b = b.slice(0, -1)\n    }\n\n    b = b.replace(/^.*[\\/\\\\]/g, '')\n\n    if (typeof suffix === 'string' && b.substr(b.length - suffix.length) === suffix) {\n        b = b.substr(0, b.length - suffix.length)\n    }\n\n    return b\n}\n\n\nfunction dirname(path) {\n    return path.replace(/\\\\/g, '/').replace(/\\/[^\\/]*\\/?$/, '')\n}\n\nfunction agregatext(selector) {\n    var texts = '';\n\n    $(\".first_editor\").children(selector).each(function() {\n\n        $(this).children(\"p\").each(function() {\n\n            texts += $(this).text() + \"\\r\\n\";\n\n        });\n\n        var allListElements = $(\"li br\");\n\n        $(\".first_editor\").find(allListElements).each(function()\n            // $(this).nextAll(\"li\").each(function()\n            {\n                texts += \"  \" + $(this).contents().get(0).nodeValue + \"\\r\\n\";\n\n            });\n\n\n\n\n\n    });\n\n\n    return texts;\n}\n\n\n\n\n\n\nfunction save(evt, action) {\n\n\n    switch (action) {\n        case \"save\": // editor save content\n            console.log(\"editor save 2\");\n            $.post(\"/inc/save.php\", { action: \"save\", data: evt.editor.getData(), path: \"/data/rw1/m1\", file: $(\"#tittle\").val() });\n            //  to prevent time consuming\n            //  read();\n            message(\"file saved\");\n\n\n\n\n            break;\n        case \"savetofile\":\n            console.log(\"save text\");\n            var file = $(\".first_editor\").children(\".path\").text();\n            console.log(file);\n            message(\"file saved \" + file);\n\n\n            // var file = \"/data/m3/mm.mm\";\n            var path = dirname(file);\n            var file = basename(file, '');\n            // var data='';\n            // $(\"#savetofile\").each(function() {\n            //    data = data  +  $(this).val();\n            //    //code\n            // });\n            data = agregatext(\".savetofile\");\n            //  data=\"test\";\n            console.log(data);\n            console.log(path);\n            console.log(file);\n\n            $.post(\"/inc/save.php\", { action: \"save\", data: data, path: path, file: file });\n\n\n            // console.log(path.basename(str, '.html'));\n\n            break;\n        default:\n\n\n            console.log(\"save default\");\n\n    }\n\n\n\n\n    //  console.log(\"hascode is is: \" + hashCode($( \"#hidden\" ).text()));\n    // console.log (\"1 \" +hashCode($( \"#hidden\" ).text()));\n    // console.log (\"2 \" +$( \"#hash\" ).text());\n\n}\n\n\nfunction read() {\n\n\n\n    $.get('/m1/' + $(\"#tittle\").val(), { \"_\": $.now() }, function(data2) {\n        console.log(\"reading file \" + '/m1/' + $(\"#tittle\").val());\n\n\n        // console.log(data);\n        //  $('#hidden').html(data2);\n        $('.first_editor').html(data2);\n\n        highlightjsworkers();\n\n\n        // $('.first_editor').html(data);\n\n    }).done(function() {\n\n\n        // if (hashCode($( \"#hidden\" ).text()) == $( \"#hash\" ).text()   )\n        // message(\"no modifiations\");\n        // else {\n        //   message (\"saved!\")\n        //   $( \"#hash\" ).html(hashCode($( \"#hidden\" ).text()));}\n        //\n    }).fail(function() {\n        //$('.first_editor').html(\"<h1>error 404 no file</h1>\"); // or whatever\n    }, 'text');\n\n}\n\nfunction highlightjsworkers() {\n\n    // hljs.initHighlightingOnLoad();\n    $('pre code').each(function(i, block) {\n        hljs.highlightBlock(block);\n    });\n\n    //  var code = document.querySelector('pre code');\n    //  var worker = new Worker('/js/worker.js');\n    //  if (!worker.onmessage) {//avoid null object in case doesnt exists\n    //  worker.onmessage = function(event) { code.innerHTML = event.data; }\n    // // worker.postMessage(code.textContent);\n    // }\n};\n\n\n//rename file\nfunction rename() {\n\n    console.log(\"change this file: \" + $(\"#tittle\").val() + \" by this file: \" + $(\"#rename\").val());\n    $.post(\"/inc/save.php\", { action: \"rename\", file: $(\"#tittle\").val(), path: \"/data/rw1/m1\", fileout: $(\"#rename\").val() }, function() {\n            $(\"#tittle\").val($(\"#rename\").val());\n        })\n        .done(function() {\n            $(\"#saving\").html(\"file renamed to \" + $(\"#rename\").val());\n        })\n        .fail(function() {\n            alert(\"error\");\n        });\n\n};\n\n\n//rename file\nfunction version() {\n\n    console.log(\"creating a new version of this: \" + $(\"#tittle\").val());\n\n    $.post(\"/inc/save.php\", { action: \"version\", file: $(\"#tittle\").val(), path: \"/data/rw1/m1\", fileout: $(\"#rename\").val() }, function() {\n            $(\"#tittle\").val($(\"#rename\").val());\n        })\n        .done(function() {\n            message(\"New version backed\");\n        })\n        .fail(function() {\n            alert(\"error\");\n        });\n\n};\n\n\n\n\n\n\nfunction loadautosearch(source) {\n\n    var options = {\n        url: source,\n        getValue: \"filename\",\n        // minLength: 3,\n        //  autoFocus: true,\n        //  my : \"100 100\",\n        //  at: \"bottom\" ,\n        //  of:\"#tittle\",\n\n        template: {\n            type: \"description\",\n            fields: {\n                // description: \"email\"\n            }\n        },\n        list: {\n            match: {\n                enabled: true\n            }\n        },\n\n        theme: \"plate-dark\"\n    };\n\n    $(\"#tittle\").easyAutocomplete(options);\n\n};\n\n\n\n\nfunction loadVideo(element) {\n\n    console.log('element is videolink');\n    console.log(element.getAttribute(\"value\"));\n    src = element.getAttribute(\"value\");\n    // $('video.videoread source').attr('src', src);\n    $('#my-player_html5_api').attr('src', src);\n    $('#my-player_html5_api').load();\n    $('#my-player_html5_api').play();\n    // $(\"video.videoread\")[0].load();\n    // $(\"video.videoread\")[0].play();\n    // evt.data.dialog = 'tableProperties'   ;\n\n}\n\n\n\nfunction getParameterByName(name, url) {\n    if (!url) url = window.location.href;\n    name = name.replace(/[\\[\\]]/g, \"\\\\$&\");\n    var regex = new RegExp(\"[?&]\" + name + \"(=([^&#]*)|&|#|$)\"),\n        results = regex.exec(url);\n    if (!results) return null;\n    if (!results[2]) return '';\n    return decodeURIComponent(results[2].replace(/\\+/g, \" \"));\n}\n\n\nfunction insertBaidumap() {\n\n\n    var map = new BMap.Map(\"allmap\"); // 创建Map实例\n    map.centerAndZoom(new BMap.Point(116.404, 39.915), 11); // 初始化地图,设置中心点坐标和地图级别\n    //添加地图类型控件\n    map.addControl(new BMap.MapTypeControl({\n        mapTypes: [\n            BMAP_NORMAL_MAP,\n            BMAP_HYBRID_MAP\n        ]\n    }));\n    map.setCurrentCity(\"北京\"); // 设置地图显示的城市 此项是必须设置的\n    map.enableScrollWheelZoom(true); //开启鼠标滚轮缩放\n\n}","/*!\n * money.js / fx() v0.2\n * Copyright 2014 Open Exchange Rates\n *\n * JavaScript library for realtime currency conversion and exchange rate calculation.\n *\n * Freely distributable under the MIT license.\n * Portions of money.js are inspired by or borrowed from underscore.js\n *\n * For details, examples and documentation:\n * http://openexchangerates.github.io/money.js/\n */\n(function(root, undefined) {\n\n\t// Create a safe reference to the money.js object for use below.\n\tvar fx = function(obj) {\n\t\treturn new fxWrapper(obj);\n\t};\n\n\t// Current version.\n\tfx.version = '0.2';\n\n\n\t/* --- Setup --- */\n\n\t// fxSetup can be defined before loading money.js, to set the exchange rates and the base\n\t// (and default from/to) currencies - or the rates can be loaded in later if needed.\n\tvar fxSetup = root.fxSetup || {\n\t\trates : {},\n\t\tbase : \"\"\n\t};\n\n\t// Object containing exchange rates relative to the fx.base currency, eg { \"GBP\" : \"0.64\" }\n\tfx.rates = fxSetup.rates;\n\n\t// Default exchange rate base currency (eg \"USD\"), which all the exchange rates are relative to\n\tfx.base = fxSetup.base;\n\n\t// Default from / to currencies for conversion via fx.convert():\n\tfx.settings = {\n\t\tfrom : fxSetup.from || fx.base,\n\t\tto : fxSetup.to || fx.base\n\t};\n\n\n\t/* --- Conversion --- */\n\n\t// The base function of the library: converts a value from one currency to another\n\tvar convert = fx.convert = function(val, opts) {\n\t\t// Convert arrays recursively\n\t\tif (typeof val === 'object' && val.length) {\n\t\t\tfor (var i = 0; i< val.length; i++ ) {\n\t\t\t\tval[i] = convert(val[i], opts);\n\t\t\t}\n\t\t\treturn val;\n\t\t}\n\n\t\t// Make sure we gots some opts\n\t\topts = opts || {};\n\n\t\t// We need to know the `from` and `to` currencies\n\t\tif( !opts.from ) opts.from = fx.settings.from;\n\t\tif( !opts.to ) opts.to = fx.settings.to;\n\n\t\t// Multiple the value by the exchange rate\n\t\treturn val * getRate( opts.to, opts.from );\n\t};\n\n\t// Returns the exchange rate to `target` currency from `base` currency\n\tvar getRate = function(to, from) {\n\t\t// Save bytes in minified version\n\t\tvar rates = fx.rates;\n\n\t\t// Make sure the base rate is in the rates object:\n\t\trates[fx.base] = 1;\n\n\t\t// Throw an error if either rate isn't in the rates array\n\t\tif ( !rates[to] || !rates[from] ) throw \"fx error\";\n\n\t\t// If `from` currency === fx.base, return the basic exchange rate for the `to` currency\n\t\tif ( from === fx.base ) {\n\t\t\treturn rates[to];\n\t\t}\n\n\t\t// If `to` currency === fx.base, return the basic inverse rate of the `from` currency\n\t\tif ( to === fx.base ) {\n\t\t\treturn 1 / rates[from];\n\t\t}\n\n\t\t// Otherwise, return the `to` rate multipled by the inverse of the `from` rate to get the\n\t\t// relative exchange rate between the two currencies\n\t\treturn rates[to] * (1 / rates[from]);\n\t};\n\n\n\t/* --- OOP wrapper and chaining --- */\n\n\t// If fx(val) is called as a function, it returns a wrapped object that can be used OO-style\n\tvar fxWrapper = function(val) {\n\t\t// Experimental: parse strings to pull out currency code and value:\n\t\tif ( typeof\tval === \"string\" ) {\n\t\t\tthis._v = parseFloat(val.replace(/[^0-9-.]/g, \"\"));\n\t\t\tthis._fx = val.replace(/([^A-Za-z])/g, \"\");\n\t\t} else {\n\t\t\tthis._v = val;\n\t\t}\n\t};\n\n\t// Expose `wrapper.prototype` as `fx.prototype`\n\tvar fxProto = fx.prototype = fxWrapper.prototype;\n\n\t// fx(val).convert(opts) does the same thing as fx.convert(val, opts)\n\tfxProto.convert = function() {\n\t\tvar args = Array.prototype.slice.call(arguments);\n\t\targs.unshift(this._v);\n\t\treturn convert.apply(fx, args);\n\t};\n\n\t// fx(val).from(currency) returns a wrapped `fx` where the value has been converted from\n\t// `currency` to the `fx.base` currency. Should be followed by `.to(otherCurrency)`\n\tfxProto.from = function(currency) {\n\t\tvar wrapped = fx(convert(this._v, {from: currency, to: fx.base}));\n\t\twrapped._fx = fx.base;\n\t\treturn wrapped;\n\t};\n\n\t// fx(val).to(currency) returns the value, converted from `fx.base` to `currency`\n\tfxProto.to = function(currency) {\n\t\treturn convert(this._v, {from: this._fx ? this._fx : fx.settings.from, to: currency});\n\t};\n\n\n\t/* --- Module Definition --- */\n\n\t// Export the fx object for CommonJS. If being loaded as an AMD module, define it as such.\n\t// Otherwise, just add `fx` to the global object\n\tif (typeof exports !== 'undefined') {\n\t\tif (typeof module !== 'undefined' && module.exports) {\n\t\t\texports = module.exports = fx;\n\t\t}\n\t\texports.fx = fx;\n\t} else if (typeof define === 'function' && define.amd) {\n\t\t// Return the library as an AMD module:\n\t\tdefine([], function() {\n\t\t\treturn fx;\n\t\t});\n\t} else {\n\t\t// Use fx.noConflict to restore `fx` back to its original value before money.js loaded.\n\t\t// Returns a reference to the library's `fx` object; e.g. `var money = fx.noConflict();`\n\t\tfx.noConflict = (function(previousFx) {\n\t\t\treturn function() {\n\t\t\t\t// Reset the value of the root's `fx` variable:\n\t\t\t\troot.fx = previousFx;\n\t\t\t\t// Delete the noConflict function:\n\t\t\t\tfx.noConflict = undefined;\n\t\t\t\t// Return reference to the library to re-assign it:\n\t\t\t\treturn fx;\n\t\t\t};\n\t\t})(root.fx);\n\n\t\t// Declare `fx` on the root (global/window) object:\n\t\troot['fx'] = fx;\n\t}\n\n\t// Root will be `window` in browser or `global` on the server:\n}(this));\n"],"preExistingComment":"//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uLy4uLy4uLy4uLy4uL3Vzci9sb2NhbC9saWIvbnBtL2xpYi9ub2RlX21vZHVsZXMvYnJvd3NlcmlmeS9ub2RlX21vZHVsZXMvYnJvd3Nlci1wYWNrL19wcmVsdWRlLmpzIiwibWFpbi5qcyIsIm5vZGVfbW9kdWxlcy9tb25leS9tb25leS5qcyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQTtBQ0FBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUNuK0JBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EiLCJmaWxlIjoiZ2VuZXJhdGVkLmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXNDb250ZW50IjpbIihmdW5jdGlvbigpe2Z1bmN0aW9uIHIoZSxuLHQpe2Z1bmN0aW9uIG8oaSxmKXtpZighbltpXSl7aWYoIWVbaV0pe3ZhciBjPVwiZnVuY3Rpb25cIj09dHlwZW9mIHJlcXVpcmUmJnJlcXVpcmU7aWYoIWYmJmMpcmV0dXJuIGMoaSwhMCk7aWYodSlyZXR1cm4gdShpLCEwKTt2YXIgYT1uZXcgRXJyb3IoXCJDYW5ub3QgZmluZCBtb2R1bGUgJ1wiK2krXCInXCIpO3Rocm93IGEuY29kZT1cIk1PRFVMRV9OT1RfRk9VTkRcIixhfXZhciBwPW5baV09e2V4cG9ydHM6e319O2VbaV1bMF0uY2FsbChwLmV4cG9ydHMsZnVuY3Rpb24ocil7dmFyIG49ZVtpXVsxXVtyXTtyZXR1cm4gbyhufHxyKX0scCxwLmV4cG9ydHMscixlLG4sdCl9cmV0dXJuIG5baV0uZXhwb3J0c31mb3IodmFyIHU9XCJmdW5jdGlvblwiPT10eXBlb2YgcmVxdWlyZSYmcmVxdWlyZSxpPTA7aTx0Lmxlbmd0aDtpKyspbyh0W2ldKTtyZXR1cm4gb31yZXR1cm4gcn0pKCkiLCIvL1xuLy8gZnVuY3Rpb24gc2F2ZWludG9icm93c2VyKGZpbGVuYW1lLGh0bWwpe1xuLy9cbi8vIC8vIGZpbGVuYW1lPSQoIFwiI3RpdHRsZVwiICkudmFsKClcbi8vIC8vIGh0bWw9ZXZ0LmVkaXRvci5nZXREYXRhKClcbi8vIC8vIGxhY2sgb2Ygc3luYyBpbnRvIHRoZSBzZXJ2ZXJcbi8vICAgdmFyIGRiID0gbmV3IERleGllKFwibTEzXCIpO1xuLy8gICBkYi52ZXJzaW9uKDEpLnN0b3Jlcyh7XG4vLyAgICAgZmlsZXM6IFwiZmlsZW5hbWUsaHRtbFwiXG4vLyAgIH0pO1xuLy9cbi8vICAgZGIub3BlbigpLmNhdGNoKGZ1bmN0aW9uIChlKSB7XG4vLyAgICAgIGFsZXJ0IChcIk9wZW4gZmFpbGVkOiBcIiArIGUpO30pO1xuLy9cbi8vXG4vLyAgIGRiLnRyYW5zYWN0aW9uKFwicndcIiwgZGIuZmlsZXMsIGZ1bmN0aW9uICgpIHtcbi8vICAgICAgIC8vIFVwZGF0ZSB0aGUgcmVnaXN0ZXIgaWYgZXhpc3RzIGlmIG5vdCBhZGRcbi8vICAgICAgZGIuZmlsZXMud2hlcmUoXCJmaWxlbmFtZVwiKS5lcXVhbHMoZmlsZW5hbWUpLm1vZGlmeSh7aHRtbDogaHRtbH0pLnRoZW4oZnVuY3Rpb24odXBkYXRlZClcbi8vICAgICAge1xuLy8gICAgICAgIGlmICh1cGRhdGVkKVxuLy8gICAgICAgICAgICBjb25zb2xlLmxvZyAoXCJwZWRybyBmb3VuZCBhbmQgdXBkYXRlXCIpO1xuLy8gICAgICAgIGVsc2Vcbi8vICAgICAgICB7XG4vLyAgICAgICAgY29uc29sZS5sb2cgKFwicGVkcm8gbm90IGZvdW5kIFwiKTtcbi8vICAgICAgICBkYi5maWxlcy5hZGQoe2ZpbGVuYW1lOiAkKCBcIiN0aXR0bGVcIiApLnZhbCgpLCBodG1sOiAgZXZ0LmVkaXRvci5nZXREYXRhKCl9KTt9IH0pOyAgIH0pO1xuLy9cbi8vIH07XG5cblxudmFyIGN0cmxJID0gZmFsc2U7XG52YXIgZnggPSByZXF1aXJlKCdtb25leScpO1xuLy8gcmVxdWlyZSgnY2tlZGl0b3InKTtcbi8vIENLRURJVE9SLnJlcGxhY2UoICdlZGl0b3InICk7XG5cblxuLy8gQWRkIGFuIGV2ZW50IGxpc3RlbmVyXG5kb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKFwibmFtZS1vZi1ldmVudFwiLCBmdW5jdGlvbihlKSB7XG4gICAgLy8gY29uc29sZS5sb2coZS5kZXRhaWwpOyAvLyBQcmludHMgXCJFeGFtcGxlIG9mIGFuIGV2ZW50XCJcbn0pO1xuXG5cbi8vICQoXCIudmlkZW9saW5rXCIpLmNsaWNrKGZ1bmN0aW9uKCl7XG5cbi8vICAgICB2YXIgc3JjID0gJCh0aGlzKS5hdHRyKFwidmFsdWVcIik7XG4vLyAgICAvLyBhbGVydChzcmMpO1xuLy8gLy8gY29uc29sZS5sb2coZXZ0KTtcbi8vIC8vIGNvbnNvbGUubG9nKCQodGhpcykpO1xuLy8gLy8gY29uc29sZS5sb2coXCJjbGlja2VkIHZpZGVvbGluayBpbiBja2VkaXRvclwiKTtcbi8vIGxvYWRWaWRlbyhzcmMpO1xuXG5cbi8vIH0pXG5cbi8vIGZ1bmN0aW9uIGxvYWRWaWRlbzIoKXtcblxuLy8gICAgIGNvbnNvbGUubG9nKCdjbGlja2VkIGxvYWRWaWRlbzInKTtcbi8vIH1cblxuXG4kKGRvY3VtZW50KS5yZWFkeShmdW5jdGlvbigpIHtcblxuICAgIC8vIHZhciBiMSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwiTVdcIik7XG4gICAgLy8gYjEudGFiSW5kZXggPSA1OyAvL2NoYW5nZSB0aGUgZGVmYXVsdCB0YWJpbmRleFxuXG5cblxuICAgICAgICB2YXIgdXJsID0gZ2V0UGFyYW1ldGVyQnlOYW1lKCd1cmwnKTtcbiAgICBpZiAodXJsKSB7XG5cbiAgICAgICAgLy8gY29uc29sZS5sb2codXJsKTtcblxuICAgICAgICAkKFwiI3RpdHRsZVwiKS52YWwodXJsKTtcbiAgICAgICAgJChcIiNyZW5hbWVcIikudmFsKHVybCk7XG4gICAgICAgIC8vICByZWFkKCk7XG4gICAgICAgIC8vJChcIi5maXJzdF9lZGl0b3JcIikuZm9jdXMoKTtcbiAgICAgICAgLy8gJChcIiN0aXR0bGVcIikuZm9jdXMoKS5zZWxlY3QoKTtcbiAgICB9IGVsc2Uge1xuICAgICAgICAkKFwiI3RpdHRsZVwiKS5mb2N1cygpLnNlbGVjdCgpO1xuICAgIH1cblxuXG4gICAgLy8gbG9hZGF1dG9zZWFyY2goXCIvcmVzb3VyY2VzL2ZpbGVzMi5qc29uXCIpO1xuXG5cbiAgICAvLyAkKCBcIi5maXJzdF9lZGl0b3IgaDNcIiApLmNsaWNrKGZ1bmN0aW9uKCkge1xuICAgIC8vICAgYWxlcnQoJ2NsaWNrZWQnKTtcbiAgICAvLyAgICQodGhpcykubmV4dFVudGlsKCBcIi5maXJzdF9lZGl0b3IgaDMsIC5maXJzdF9lZGl0b3IgaDJcIiApLnRvZ2dsZSgpO1xuICAgIC8vIH0pO1xuICAgIC8vICQoIFwiLmZpcnN0X2VkaXRvciBoNFwiICkuY2xpY2soZnVuY3Rpb24oKSB7XG4gICAgLy8gICAkKHRoaXMpLm5leHRVbnRpbCggXCIuZmlyc3RfZWRpdG9yIGg0LCAuZmlyc3RfZWRpdG9yIGgzIFwiICkudG9nZ2xlKCk7XG4gICAgLy8gfSk7XG4gICAgLy9cbiAgICAvLyAkKCBcImgyXCIgKS5jbGljayhmdW5jdGlvbigpIHtcbiAgICAvLyAgICQodGhpcykubmV4dCggXCJoMiwgaDFcIiApLnRvZ2dsZSgpO1xuICAgIC8vIH0pO1xuICAgIC8vXG4gICAgLy8gJCggXCJoMVwiICkuY2xpY2soZnVuY3Rpb24oKSB7XG4gICAgLy8gICAkKHRoaXMpLm5leHQoIFwiaDFcIiApLnRvZ2dsZSgpO1xuICAgIC8vIH0pO1xuXG5cblxuICAgJChcIi5qaWViYVwiKS5kYmxjbGljayhmdW5jdGlvbigpIHtcblxudGV4dD0kKHRoaXMpLnRleHQoKVxuXG5sYW5nPSd6aCdcbmxhbmd0bz0nZW4nXG4gZmFueWkodGV4dCwgbGFuZywgbGFuZ3RvKS50aGVuKGZ1bmN0aW9uKGFhKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhhYS5zcmMpXG4gICAgICAgICAgICAgICAgICAgICAgICAgICBhYS5kc3Q9YWEucGlueWluICtcIjxicj5cIisgYWEudHJhbnNsYXRlICthYS5oYW5kaVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHRyYWQgPSBhYS5zcmMgKyAnOiA8L2JyPiAnICsgYWEuZHN0KyBhYS5hdWRpbztcbiAgICAgICAgICAgICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgJCgnI2ZhbnlpNTUnKS5odG1sKHRyYWQpXG4gICAgICAgICAgICAgICAgICAgIH0pXG5cblxuICAgIH0pO1xuXG5cbiAgICAkKFwiYnV0dG9uI2F1dG90cmFuc1wiKS5jbGljayhmdW5jdGlvbigpIHtcbiAgICAgICAgLy8gJChcInNwYW5bbGFuZz0nemgtY24nXVwiKS5lYWNoKGZ1bmN0aW9uKGksIHYpIHtcblxuICAgICAgICAgICAgJChcInNwYW5bbGFuZz0nemgtY24nXVwiKS5jc3MoJ2NvbG9yJywgJ3JlZCcpXG4gICAgICAgICAgICBcbiAgICAgICAgICAgIGxldCBsYW5nID0gJ3poJ1xuICAgICAgICAgICAgbGV0IGxhbmd0byA9ICdlbidcbiAgICAgICAgICAgIGxldCBiYiA9ICQoXCJzcGFuW2xhbmc9J3poLWNuJ106ZXEoMSlcIikudGV4dCgpICBcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKGB0byB0cmFuc2xhdGU6ICR7YmJ9YClcbiAgICAgICAgICAgIGZhbnlpKGJiLCAnemgnLCAnZW4nKS50aGVuKGZ1bmN0aW9uKGFhKSB7XG4gICAgICAgICAgICAgICAgbGV0IHRyYW5zbGF0aW9uID0gXCI8c3BhbiBjbGFzcz0nb3JpZ2luYWwnIGxhbmc9J1wiICsgbGFuZyArIFwiJyBkYXRhLXBzZXVkby1jb250ZW50PSdcIiArIGFhLnNyYyArIFwiJyA+Jm5ic3A7PC9zcGFuPjxzcGFuIGNsYXNzPSd0cmFuc2xhdGUnICBsYW5nPSdcIiArIGxhbmd0byArIFwiJyA+XCIgKyBhYS50cmFuc2xhdGUgKyBcIjwvc3Bhbj5cIlxuICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKGFhLmkpXG4gICAgICAgICAgICAgICAgJChcInNwYW5bbGFuZz0nemgtY24nXTplcSgxKVwiKS5odG1sKHRyYW5zbGF0aW9uKVxuICAgICAgICAgICAgICAgICQoXCJzcGFuW2xhbmc9J3poLWNuJ106ZXEoMSlcIikuYXR0cignbGFuZycsJycpXG4gICAgICAgICAgICB9KVxuXG4gICAgfSlcblxuXG5cblxuICAgICQoXCJidXR0b24jdHJhbnNcIikuY2xpY2soZnVuY3Rpb24oKSB7XG4gICAgICAgIGNvbnNvbGUubG9nKCdjbGlja2VkIHRyYW5zbGF0ZScpXG4gICAgICAgICQoXCIudHJhbnNsYXRlXCIpLnNob3coKTtcbiAgICAgICAgJChcIi5vcmlnaW5hbFwiKS5oaWRlKCk7XG5cblxuICAgIH0pO1xuXG4gICAgJChcImJ1dHRvbiNzaG93dHJhbnNsYXRlXCIpLmNsaWNrKGZ1bmN0aW9uKCkge1xuICAgICAgICBjb25zb2xlLmxvZygnY2xpY2tlZCBzaG93dHJhbnNsYXRlJylcbiAgICAgICAgJChcIi50cmFuc2xhdGVcIikuc2hvdygpO1xuICAgICAgICAkKFwiLm9yaWdpbmFsXCIpLnNob3coKTtcblxuICAgIH0pO1xuXG5cbiAgICAkKFwiYnV0dG9uI2FkZGFic29sdXRlcGF0aFwiKS5jbGljayhmdW5jdGlvbigpIHtcblxuICAgICAgICBjb25zb2xlLmxvZygnY2xpY2tlZCBhZGRhYnNvbHV0ZXBhdGgyJylcblxuXG4gICAgICAgICQoJ2ltZycpLmVhY2goZnVuY3Rpb24oaSwgdikge1xuICAgICAgICAgICAgaWYgKCQodGhpcykuYXR0cignc3JjJykuaW5jbHVkZXMoXCJodHRwXCIpKSB7XG4gICAgICAgICAgICAgICAgY29uc29sZS5sb2coJ25vdCBjaGFuZ2UnKVxuXG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIHZhciBhYWEgPSAnaHR0cDovL2k0ODcubHhjLycgKyAkKHRoaXMpLmF0dHIoJ3NyYycpO1xuICAgICAgICAgICAgICAgICQodGhpcykuYXR0cignc3JjJywgYWFhKTtcbiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZygkKHRoaXMpLmF0dHIoJ3NyYycpKVxuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcblxuICAgIH0pO1xuXG4gICAgJChcImJ1dHRvbiNzaGFyZWxpbmtcIikuY2xpY2soZnVuY3Rpb24oKSB7XG5cblxuICAgICAgICBjb25zb2xlLmxvZygnY2xpY2tlZCBzaGFyZWxpbmsgJylcbiAgICAgICAgY29uc29sZS5sb2coXCJodHRwOi8vaTQ4Ny5seGMvZWJyYWluP3VybD1cIiArICQoJyN0aXR0bGUnKS52YWwoKSlcblxuICAgICAgICAkLmdldEpTT04oJ2VicmFpbj91cmw9JyArICQoJyN0aXR0bGUnKS52YWwoKSxcbiAgICAgICAgICAgIGZ1bmN0aW9uKGRhdGEpIHtcblxuICAgICAgICAgICAgICAgICQoJyNzaGFyZWxpbmsnKS5hdHRyKCdocmVmJywgJ2h0dHA6Ly9pNDg3Lmx4Yy92aWV3LnBocD91cmw9JyArIGRhdGEuaGFzaClcblxuICAgICAgICAgICAgfSlcblxuXG4gICAgfSk7XG5cbiAgICAkKFwiYnV0dG9uI3VwZGF0ZWNvc3RcIikuY2xpY2soZnVuY3Rpb24oKSB7XG4gICAgICAgIGNvbnNvbGUubG9nKCdjbGlja2VkIHVwZGF0ZWRjb3N0ICcpXG5cbiAgICAgICAgJC5nZXRKU09OKFxuICAgICAgICAgICAgLy8gTkI6IHVzaW5nIE9wZW4gRXhjaGFuZ2UgUmF0ZXMgaGVyZSwgYnV0IHlvdSBjYW4gdXNlIGFueSBzb3VyY2UhXG4gICAgICAgICAgICAnaHR0cHM6Ly9vcGVuZXhjaGFuZ2VyYXRlcy5vcmcvYXBpL2xhdGVzdC5qc29uP2FwcF9pZD05NjBmMGI4ZGNhOTM0NDMyOGIxM2VmODE2OTU3ZDgxMCcsXG4gICAgICAgICAgICBmdW5jdGlvbihkYXRhKSB7XG4gICAgICAgICAgICAgICAgLy8gQ2hlY2sgbW9uZXkuanMgaGFzIGZpbmlzaGVkIGxvYWRpbmc6XG4gICAgICAgICAgICAgICAgaWYgKHR5cGVvZiBmeCAhPT0gXCJ1bmRlZmluZWRcIiAmJiBmeC5yYXRlcykge1xuICAgICAgICAgICAgICAgICAgICBmeC5yYXRlcyA9IGRhdGEucmF0ZXM7XG4gICAgICAgICAgICAgICAgICAgIGZ4LmJhc2UgPSBkYXRhLmJhc2U7XG5cblxuICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZygndXBkYXRpbmcgY29zdC4uLicpXG5cbiAgICAgICAgICAgICAgICAgICAgJCgnLmNvc3QnKS5lYWNoKGZ1bmN0aW9uKGksIHYpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGFhID0gJCh0aGlzKS5hdHRyKCdkYXRhLWNvc3QnKVxuICAgICAgICAgICAgICAgICAgICAgICAgdG90YWwgPSBNYXRoLnJvdW5kKGZ4KGFhKS5mcm9tKFwiQ05ZXCIpLnRvKFwiRVVSXCIpIC8gMC4wMDk1KSAvIDEwMDtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKFwiY29udmVydGluZyBDTlkgaW50byBFVVJcIiArIGZ4KDEpLmZyb20oXCJDTllcIikudG8oXCJFVVJcIikpO1xuICAgICAgICAgICAgICAgICAgICAgICAgJCh0aGlzKS50ZXh0KHRvdGFsKVxuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgXG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgLy8gSWYgbm90LCBhcHBseSAgdG8gZnhTZXR1cCBnbG9iYWw6XG4gICAgICAgICAgICAgICAgICAgIHZhciBmeFNldHVwID0ge1xuICAgICAgICAgICAgICAgICAgICAgICAgcmF0ZXM6IGRhdGEucmF0ZXMsXG4gICAgICAgICAgICAgICAgICAgICAgICBiYXNlOiBkYXRhLmJhc2VcbiAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHZhciBkID0gbmV3IERhdGUoKTtcbiAgICAgICAgICAgICAgICB2YXIgZGF0ZXRpbWUgPSBkLmdldEZ1bGxZZWFyKCkgKyAnLScgKyBkLmdldE1vbnRoKCkgKyAnLScgKyBkLmdldERhdGUoKTtcbiAgICAgICAgICAgICAgICBlZGl0b3IuaW5zZXJ0SHRtbChcIjxzcGFuIGNsYXNzPSdpbmZvcm1hdGlvbic+IGRhdGU6IFwiICsgZGF0ZXRpbWUgKyBcIiBDTlkgdG8gRVVSIENvbnZlcnQgcmF0ZSBpcyAgXCIgKyBmeCgxKS5mcm9tKFwiQ05ZXCIpLnRvKFwiRVVSXCIpICsgXCI8L3NwYW4+XCIpXG4gICAgICAgICAgICB9XG4gICAgICAgICk7XG5cblxuXG5cblxuXG4gICAgfSk7XG4gICAgLy8gaHR0cHM6Ly9vcGVuZXhjaGFuZ2VyYXRlcy5naXRodWIuaW8vbW9uZXkuanMvI2Rvd25sb2FkXG5cblxuICAgICQoXCIjdGl0dGxlXCIpLmZvY3Vzb3V0KGZ1bmN0aW9uKCkge1xuICAgICAgICAvLyBjb25zb2xlLmxvZygnMScpO1xuXG4gICAgICAgIGNvbnNvbGUubG9nKCQoXCIjdGl0dGxlXCIpLnZhbCgpKTtcbiAgICAgICAgJChcIiNyZW5hbWVcIikudmFsKCQoXCIjdGl0dGxlXCIpLnZhbCgpKTtcbiAgICAgICAgJCgnLmZpcnN0X2VkaXRvcicpLmF0dHIoJ2lkJywgJChcIiN0aXR0bGVcIikudmFsKCkpO1xuICAgICAgICAkKCcuZmlyc3RfZWRpdG9yJykuYXR0cihcImNvbnRlbnRlZGl0YWJsZVwiLCBcInRydWVcIik7XG4gICAgICAgICQoJy5maXJzdF9lZGl0b3InKS5mb2N1cygpO1xuICAgICAgICByZWFkKCk7XG4gICAgICAgIC8vIGVkaXRvci5zZXREYXRhKCQoIFwiI2hpZGRlblwiICkuaHRtbCgpKTsgIC8vIGxvYWQgZGF0YSBpbiB0aGUgZWRpdG9yXG5cbiAgICAgICAgLy8gaGxqcy5pbml0SGlnaGxpZ2h0aW5nT25Mb2FkKCk7XG5cbiAgICB9KTtcblxuXG5cblxuICAgICQoXCIjcmVuYW1lXCIpLmZvY3Vzb3V0KGZ1bmN0aW9uKCkge1xuICAgICAgICAvLyBjb25zb2xlLmxvZygnMicpO1xuXG4gICAgICAgIGlmICgkKFwiI3RpdHRsZVwiKS52YWwoKSA9PSAkKFwiI3JlbmFtZVwiKS52YWwoKSlcblxuICAgICAgICAgICAgLy8gZWRpdG9yLnNldERhdGEoJCggXCIjaGlkZGVuXCIgKS5odG1sKCkpOyAgLy8gbG9hZCBkYXRhIGluIHRoZSBlZGl0b3JcbiAgICAgICAgICAgIHJlYWQoKTtcbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICByZW5hbWUoKTtcbiAgICAgICAgfVxuXG5cbiAgICB9KTtcblxuXG5cblxuXG4gICAgQ0tFRElUT1IuaW5zdGFuY2VzWydpbnRyb2R1Y3Rpb24nXS5kZXN0cm95KCk7XG4gICAgdmFyIGVkaXRvciA9IENLRURJVE9SLmlubGluZShcImludHJvZHVjdGlvblwiKTtcblxuXG5cblxuICAgIGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ3Bhc3RlJywgZnVuY3Rpb24oZSkge1xuICAgICAgICAvLyAgICB2YXIgaHRtbCA9IGUuY2xpcGJvYXJkRGF0YS5nZXREYXRhIChcIlRleHRcIik7XG4gICAgICAgIC8vIGUucHJldmVudERlZmF1bHQoKTtcbiAgICAgICAgLy8gICAgICBpZiAoIGN0cmxJICl7XG4gICAgICAgIC8vICAgICAgICAvLyBDS0VESVRPUi5pbnN0YW5jZXNbJ2ludHJvZHVjdGlvbiddLmRlc3Ryb3koKTtcbiAgICAgICAgLy8gICAgICAgIC8vXG4gICAgICAgIC8vICAgICAgICAvLyAgICB2YXIgZWRpdG9yID0gQ0tFRElUT1IuaW5saW5lKFwiaW50cm9kdWN0aW9uXCIpO1xuICAgICAgICAvL1xuICAgICAgICAvLyAgICAgICAgY29uc29sZS5sb2cgKFwicGFzdGUgZXZlbnRcIik7XG4gICAgICAgIC8vICAgICAgICAvLyBlZGl0b3IuaW5zZXJ0SHRtbChodG1sKTtcbiAgICAgICAgLy8gICAgICB9XG4gICAgICAgIC8vICAgIC8vIHZhciBodG1sID0gZS5jbGlwYm9hcmREYXRhLmdldERhdGEoJ3RleHQvaHRtbCcpO1xuICAgICAgICAvLyAgICBjb25zb2xlLmxvZyhodG1sKTtcbiAgICAgICAgLy8gICAgLy8gV2hhdGV2ZXIgeW91IHdhbnQgdG8gZG8gd2l0aCB0aGUgaHRtbFxuICAgIH0pO1xuXG5cbiAgICBlZGl0b3Iub24oJ3Bhc3RlJywgZnVuY3Rpb24oZXZ0KSB7XG4gICAgICAgIGV2dC5zdG9wKCk7XG4gICAgICAgIHZhciBkYXRhID0gZXZ0LmRhdGEuZGF0YVZhbHVlO1xuXG4gICAgICAgIGlmICh3aW5kb3cuY2hyb21lIHx8IHdpbmRvdy5zYWZhcmkpIHtcbiAgICAgICAgICAgIC8vIHJlbW92aW5nIHNwYW4gd3JhcHBlciBvbiB3ZWJraXQgYnJvd3NlcnMuXG4gICAgICAgICAgICBkYXRhID0gJChkYXRhKS5odG1sKCk7XG4gICAgICAgIH1cbiAgICAgICAgZXZ0LmVkaXRvci5pbnNlcnRIdG1sKGRhdGEpO1xuICAgIH0pO1xuXG5cblxuICAgIGVkaXRvci5vbigna2V5JywgZnVuY3Rpb24oZXZ0KSB7XG4gICAgICAgIC8vIGNvbnNvbGUubG9nKCczJyk7XG4gICAgICAgIC8vaHR0cDovL3N0YWNrb3ZlcmZsb3cuY29tL3F1ZXN0aW9ucy80NDAxNDY5L2hvdy10by1zZWxlY3QtYS10ZXh0LXJhbmdlLWluLWNrZWRpdG9yLXByb2dyYW1hdGljYWxseVxuXG4gICAgICAgIHZhciBjaGFyQ29kZSA9IGV2dC5kYXRhLmtleUNvZGU7IC8vIGF0IHRoZSBtb21lbnQgdGhpcyBpcyB3cm9uZywga2V5Q29kZSBuZWVkcyB0byBiZSBwcm9wZXJseSBjb252ZXJ0ZWQgdG8gY2hhckNvZGVcbiAgICAgICAgLy8gdmFyIGNsaXBib2FyZERhdGEgPSBldnQuZGF0YS5kYXRhVmFsdWU7XG4gICAgICAgIGNvbnNvbGUubG9nKGNoYXJDb2RlKTtcbiAgICAgICAgdmFyIHRhZyA9IFwiaDFcIjtcbiAgICAgICAgLy8gIGNvbnNvbGUubG9nKHNlbGVjdGVkVGV4dCk7XG4gICAgICAgIHN3aXRjaCAoY2hhckNvZGUpIHtcbiAgICAgICAgICAgIGNhc2UgMTExNDE2MTogLy8gQ3RybCAxXG4gICAgICAgICAgICAgICAgdGFnID0gXCI8aDE+PC9oMT5cIjtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIGNhc2UgMTExNDE2MjogLy8gQ3RybCAyXG4gICAgICAgICAgICAgICAgdGFnID0gXCI8aDI+PC9oMj5cIjtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIGNhc2UgMTExNDE2MzogLy8gQ3RybCAzXG4gICAgICAgICAgICAgICAgdGFnID0gXCI8aDM+PC9oMz5cIjtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIGNhc2UgMTExNDE2NDogLy8gQ3RybCA0XG4gICAgICAgICAgICAgICAgdGFnID0gXCI8aDQ+PC9oND5cIjtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIGNhc2UgMTExNDE2NjogLy8gQ3RybCA2XG4gICAgICAgICAgICAgICAgdGFnID0gXCI8aDU+PC9oNT5cIjtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIGNhc2UgMTExNDE2OTogLy8gQ3RybCA2XG4gICAgICAgICAgICAgICAgZWRpdG9yLmluc2VydEh0bWwoXCI8ZGl2IGNsYXNzPSdzYXZldG9maWxlJz5wdXQgdGV4dDwvZGl2PlwiKTtcbiAgICAgICAgICAgICAgICBicmVhaztcblxuICAgICAgICAgICAgY2FzZSAxMTE0MzAwOiAvLyBDdHJsICxcbiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZygnY29udmVydCBDb2luJyk7XG5cbiAgICAgICAgICAgICAgICBzZWwgPSBlZGl0b3IuZ2V0U2VsZWN0aW9uKCkuZ2V0U2VsZWN0ZWRUZXh0KClcbiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhzZWwpXG5cbiAgICAgICAgICAgICAgICBlZGl0b3IuaW5zZXJ0SHRtbChjb252ZXJ0Q29pbihzZWwsIFwieXVhblwiLCBcImV1cm9cIikpXG4gICAgICAgICAgICAgICAgJCgncDpoYXMoc3Bhbi5jb3N0KScpLmFkZENsYXNzKCdtaWRkbGUnKTtcblxuICAgICAgICAgICAgICAgIGJyZWFrO1xuXG5cbiAgICAgICAgICAgIGNhc2UgMTExNDMwNDogLy8gQ3RybCBgXG4gICAgICAgICAgICAgICAgY29uc29sZS5sb2coJ3JlcXVlc3QgZmFueWknKTtcbiAgICAgICAgICAgICAgICBsZXQgbGFuZyA9ICQoXCIjbGFuZ1wiKS52YWwoKSxcbiAgICAgICAgICAgICAgICAgICAgbGFuZ3RvID0gJChcIiNsYW5ndG9cIikudmFsKClcblxuXG5cbiAgICAgICAgICAgICAgICBzZWwgPSBlZGl0b3IuZ2V0U2VsZWN0aW9uKCkuZ2V0U2VsZWN0ZWRUZXh0KCkucmVwbGFjZSgvKFxcclxcblxcdHxcXG58XFxyXFx0KS9nbSwgXCJcIik7XG4gICAgICAgICAgICAgICAgaWYgKHNlbC5sZW5ndGggPiAwKSB7XG4gICAgICAgICAgICAgICAgICAgIGZhbnlpKHNlbCwgbGFuZywgbGFuZ3RvKS50aGVuKGZ1bmN0aW9uKGFhKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBsZXQgdHJhbnNsYXRpb24gPSBcIjxzcGFuIGNsYXNzPSdvcmlnaW5hbCcgbGFuZz0nXCIgKyBsYW5nICsgXCInIGRhdGEtcHNldWRvLWNvbnRlbnQ9J1wiICsgYWEuc3JjICsgXCInID4mbmJzcDs8L3NwYW4+PHNwYW4gY2xhc3M9J3RyYW5zbGF0ZScgIGxhbmc9J1wiICsgbGFuZ3RvICsgXCInID5cIiArIGFhLnRyYW5zbGF0ZSArIFwiPC9zcGFuPlwiXG4gICAgICAgICAgICAgICAgICAgICAgICBlZGl0b3IuaW5zZXJ0SHRtbCh0cmFuc2xhdGlvbik7XG4gICAgICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgfVxuXG5cblxuICAgICAgICAgICAgICAgIGJyZWFrO1xuXG5cblxuICAgICAgICAgICAgY2FzZSA1NTcwNjM4OiAvLyBDdHJsIEFsdCBOXG4gICAgICAgICAgICAgICAgLy8gdGFnPVwiPGI+PC9iPlwiO1xuICAgICAgICAgICAgICAgIHRhZyA9IFwiPGVtPjwvZW0+XCI7IC8vZW1waGFzaXNcbiAgICAgICAgICAgICAgICBicmVhaztcblxuXG4gICAgICAgICAgICBjYXNlIDU1NzA2Mzc6IC8vIEN0cmwgQWx0IE1cbiAgICAgICAgICAgICAgICB0YWcgPSBcIjxtYXJrPjwvbWFyaz5cIjtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIGNhc2UgNTU3MDYyODogLy8gQ3RybCBBbHQgRFxuICAgICAgICAgICAgICAgIHZhciBkID0gbmV3IERhdGUoKTtcbiAgICAgICAgICAgICAgICB2YXIgZGF0ZXRpbWUgPSBkLmdldEZ1bGxZZWFyKCkgKyAnLScgKyBkLmdldE1vbnRoKCkgKyAnLScgKyBkLmdldERhdGUoKTtcbiAgICAgICAgICAgICAgICB0YWcgPSBcIjxkZWwgZGF0ZXRpbWU9XCIgKyBkYXRldGltZSArIFwiIHRpdGxlPVwiICsgZGF0ZXRpbWUgKyBcIj48L2Rpdj5cIjsgLy9kZWwgdGV4dFxuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgY2FzZSA1NTcwNjMzOiAvLyBDdHJsIEFsdCBJXG4gICAgICAgICAgICAgICAgdGFnID0gXCI8ZW0+PC9lbT5cIjsgLy9lbXBoYXNpc1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgY2FzZSAyMjI4MzE0OiAvLyBTaGlmdCBaICAgVGVzdFxuICAgICAgICAgICAgICAgICQoXCIjY2tlXzNfdG9wXCIpLnRvZ2dsZSgpO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgY2FzZSAzMzQyNDA4OiAvLyBDVFJMIFNoaWZ0IEggIEhpZGUvc2hvdyB0b29sIGJhclxuICAgICAgICAgICAgICAgIC8vIGV2dC5kYXRhLnN0b3BQcm9wYWdhdGlvbigpO1xuICAgICAgICAgICAgICAgIC8vIGV2dC5kYXRhLnByZXZlbnREZWZhdWx0KCk7XG4gICAgICAgICAgICAgICAgJChcIiNja2VfM190b3BcIikudG9nZ2xlKCk7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICBjYXNlIDExMTQxOTU6IC8vQ3RybCBTIHNhdmUgYSB2ZXJzaW9uXG4gICAgICAgICAgICAgICAgdmVyc2lvbigpO1xuICAgICAgICAgICAgICAgIGlmICgkKCcuc2F2ZXRvZmlsZScpLmxlbmd0aCA+IDApXG4gICAgICAgICAgICAgICAgICAgIHNhdmUoZXZ0LCBcInNhdmV0b2ZpbGVcIik7XG5cbiAgICAgICAgICAgICAgICBicmVhaztcblxuICAgICAgICAgICAgY2FzZSAzMzQyNDA0OiAvLyBDdHJsIFNoaWZ0IEQgIEluc2VydCBkZXRhaWwvU3VtbWFyeSBodG1sXG4gICAgICAgICAgICAgICAgdmFyIHNlbCA9IGVkaXRvci5nZXRTZWxlY3Rpb24oKS5nZXRTZWxlY3RlZFRleHQoKTtcbiAgICAgICAgICAgICAgICBpZiAoc2VsLmxlbmd0aCA+IDApIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIGRldGFpbHMgPSBuZXcgQ0tFRElUT1IuZG9tLmVsZW1lbnQoJ2RldGFpbHMnKTtcbiAgICAgICAgICAgICAgICAgICAgZGV0YWlscy5zZXRIdG1sKCcgPHN1bW1hcnk+JyArIHNlbCArICc8L3N1bW1hcnk+PHA+TW9yZSBpbmZvIGFib3V0IHRoZSBkZXRhaWxzLjwvcD4nKTtcbiAgICAgICAgICAgICAgICAgICAgZWRpdG9yLmluc2VydEVsZW1lbnQoZGV0YWlscyk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgY2FzZSAxMTE0MTkxOiAvLyBDdHJsIE8gIE9wZW4gY29kZVNuaXBwZXQgZGlhbG9nXG4gICAgICAgICAgICAgICAgZWRpdG9yLmV4ZWNDb21tYW5kKCdjb2RlU25pcHBldCcpOyAvL3dpZGdldFxuICAgICAgICAgICAgICAgIGJyZWFrO1xuXG4gICAgICAgICAgICBjYXNlIDExMTQxODU6IC8vIEN0cmwgSSAgSW5zZXJ0aHRtbFxuICAgICAgICAgICAgICAgIC8vIHZhciBzZWwgPSBlZGl0b3IuZ2V0U2VsZWN0aW9uKCkuZ2V0U2VsZWN0ZWRUZXh0KCk7XG4gICAgICAgICAgICAgICAgY3RybEkgPSAhY3RybEk7XG5cbiAgICAgICAgICAgICAgICAvLyBldnQuZGF0YS5kYXRhVmFsdWUgPSBldnQuZGF0YS5kYXRhVmFsdWVcbiAgICAgICAgICAgICAgICAvLyBlZGl0b3IuZmlyZSggJ3Bhc3RlJyxlZGl0b3IpO1xuICAgICAgICAgICAgICAgIC8vIGNvbnNvbGUubG9nKGUuY2xpcGJvYXJkRGF0YS5nZXREYXRhKCd0ZXh0L2h0bWwnKSk7XG5cbiAgICAgICAgICAgICAgICAvLyBUaGlzIGNvZGUgb2J2aW91c2x5IHdpbGwgbm90IHByZXNlcnZlIHRoZSBjYXNlIG9mIHRoZSBmaXJzdCBhbmQgbGFzdCBsZXR0ZXJzLlxuICAgICAgICAgICAgICAgIC8vIExldCBpdCBiZSBhbiBleGVyY2lzZSBmb3IgdGhlIHJlYWRlciA7KS5cbiAgICAgICAgICAgICAgICAvLyBlZGl0b3IuZXhlY0NvbW1hbmQoICdpbnNlcnRodG1sNHgnKTsgIC8vd2lkZ2V0XG5cbiAgICAgICAgICAgICAgICBicmVhaztcblxuICAgICAgICAgICAgY2FzZSAxMTE0MTgyOiAvLyBDdHJsIEYgb3BlbiBkaWFsb2cgRmluZCBhbmQgcmVwbGFjZVxuICAgICAgICAgICAgICAgIGVkaXRvci5leGVjQ29tbWFuZCgnZmluZCcpO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuXG4gICAgICAgICAgICBjYXNlIDMzNDI0MDI6IC8vIEN0cmwgU2hpZnQgQlxuICAgICAgICAgICAgICAgIGVkaXRvci5pbnNlcnRIdG1sKFwiPGJyLz5cIik7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgLy8gY2FzZSA3Nzk4ODY4Oi8vIEN0cmwgQUxUIFNISVQgVFxuICAgICAgICAgICAgICAgIC8vICAgZWRpdG9yLmluc2VydEh0bWwoIFwiPHRhYmxlIGNsYXNzPXRhYmxlMUNsYXNzJyA+IDx0Ym9keT4gXFxcbiAgICAgICAgICAgICAgICAvLyAgICAgIDx0cj48dGQ+MTwvdGQ+PHRkPjI8L3RkPjwvdHI+PHRyPjx0ZD4xPC90ZD48dGQ+MjwvdGQ+PC90cj4gXFxcbiAgICAgICAgICAgICAgICAvLyAgICAgIDwvdGJvZHk+PC90YWJsZT5cIik7XG4gICAgICAgICAgICAgICAgLy8gICAvLyAgZWRpdG9yLmluc2VydEh0bWwoIGNsaXBib2FyZERhdGEpO1xuICAgICAgICAgICAgICAgIC8vICAgICAvLyBjb25zb2xlLmxvZyhjbGlwYm9hcmREYXRhKTtcbiAgICAgICAgICAgICAgICAvLyAgICBicmVhaztcbiAgICAgICAgICAgIGNhc2UgMzM0MjQyMjogLy8gQ3Ryb2wgc2hpZnQgVlxuICAgICAgICAgICAgICAgIHRleHRvID0gJ0NydGwgKyBTSElGVCBWJzsgLy8gQ3RybCAxXG4gICAgICAgICAgICAgICAgLy8gdGV4dCA9IHdpbmRvdy5jbGlwYm9hcmREYXRhLmdldERhdGEoXCJUZXh0XCIpO1xuICAgICAgICAgICAgICAgIC8vIGNvbnNvbGUubG9nKHRleHRvKTtcbiAgICAgICAgICAgICAgICAvLyBlZGl0b3IuaW5zZXJ0SHRtbCggY2xpcGJvYXJkRGF0YSk7XG4gICAgICAgICAgICAgICAgLy8gY29uc29sZS5sb2codGV4dG8pO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgICAgICB0ZXh0byA9ICdPdGhlciBrZXknO1xuICAgICAgICB9XG5cblxuICAgICAgICB2YXIga2V5cHJlc3MgPSBbMTExNDE2MSwgMTExNDE2MiwgMTExNDE2MywgMTExNDE2NCwgMTExNDE2NiwgMTExNDE2OSwgNTU3MDYzNywgNTU3MDYyOCwgNTU3MDYzMywgNTU3MDYzOF07XG4gICAgICAgIC8vIGNvbnNvbGUubG9nKGtleXByZXNzLmluZGV4T2YoY2hhckNvZGUpKTtcbiAgICAgICAgaWYgKGtleXByZXNzLmluZGV4T2YoY2hhckNvZGUpID4gLTEpIHsgLy8gcmV0YWcgdGhlIHNlbGVjdCBhcmVhXG4gICAgICAgICAgICB2YXIgc2VsID0gZWRpdG9yLmdldFNlbGVjdGlvbigpLmdldFNlbGVjdGVkVGV4dCgpO1xuICAgICAgICAgICAgaWYgKHNlbC5sZW5ndGggPiAwKSB7XG4gICAgICAgICAgICAgICAgLy8gIHZhciBuZXdFbGVtZW50ID0gbmV3IENLRURJVE9SLmRvbS5lbGVtZW50KHRhZyk7XG4gICAgICAgICAgICAgICAgdmFyIG5ld0VsZW1lbnQgPSBDS0VESVRPUi5kb20uZWxlbWVudC5jcmVhdGVGcm9tSHRtbCh0YWcpXG4gICAgICAgICAgICAgICAgLy8gbmV3RWxlbWVudC5zZXRBdHRyaWJ1dGVzKHtzdHlsZTogJyd9KTtcbiAgICAgICAgICAgICAgICBuZXdFbGVtZW50LnNldFRleHQoc2VsKTtcbiAgICAgICAgICAgICAgICBlZGl0b3IuaW5zZXJ0RWxlbWVudChuZXdFbGVtZW50KTtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgdmFyIG5ld0VsZW1lbnQgPSBuZXcgQ0tFRElUT1IuZG9tLmVsZW1lbnQodGFnKTtcbiAgICAgICAgICAgICAgICAvLyBuZXdFbGVtZW50LnNldEF0dHJpYnV0ZXMoe3N0eWxlOiAnJ30pO1xuICAgICAgICAgICAgICAgIG5ld0VsZW1lbnQuc2V0VGV4dChzZWwpO1xuICAgICAgICAgICAgICAgIC8vICBlZGl0b3IuaW5zZXJ0RWxlbWVudChuZXdFbGVtZW50KS5zZWxlY3RFbGVtZW50KCk7XG4gICAgICAgICAgICAgICAgLy8gIGVkaXRvci5nZXRTZWxlY3Rpb24oKS5zZWxlY3RFbGVtZW50KG5ld0VsZW1lbnQpO1xuXG4gICAgICAgICAgICB9XG4gICAgICAgIH1cblxuXG4gICAgfSk7XG5cblxuXG5cblxuICAgIC8vIG92ZXJyaWRlIHNob3J0Y3V0IGZpcmVmb3gga2V5Ym9hcmRcbiAgICAkKCcuZmlyc3RfZWRpdG9yJykua2V5cHJlc3MoZnVuY3Rpb24oZXZlbnQpIHtcblxuICAgICAgICAvLyBjb25zb2xlLmxvZygnNCcpO1xuXG5cbiAgICAgICAgLy8gY29uc29sZS5sb2coJ2V2ZW50byBlczogJysgZXZlbnQua2V5ICsnc2hpZnQ6ICcrZXZlbnQuY3RybEtleSArICdjcnRsOiAnKyBldmVudC5jdHJsS2V5KTtcbiAgICAgICAgdmFyIGEgPSBldmVudC5rZXk7XG4gICAgICAgIHZhciBiID0gZXZlbnQuY3RybEtleTtcbiAgICAgICAgdmFyIGMgPSBldmVudC5zaGlmdEtleTtcbiAgICAgICAgdmFyIGQgPSBldmVudC5hbHRLZXk7XG4gICAgICAgIHZhciByZXNwb25zZSA9IGV2ZW50LmtleSArIGV2ZW50LmN0cmxLZXkgKyBldmVudC5zaGlmdEtleSArIGV2ZW50LmFsdEtleTtcbiAgICAgICAgLy8gIGNvbnNvbGUubG9nKHJlc3BvbnNlKTtcbiAgICAgICAgLy8gY29uc29sZS5sb2coYik7XG4gICAgICAgIHN3aXRjaCAodHJ1ZSkge1xuXG5cbiAgICAgICAgICAgIGNhc2UgKGEgPT0gJ0YnICYmIGIgJiYgYyAmJiBkKTpcbiAgICAgICAgICAgICAgICB2YXIgc2VsID0gZWRpdG9yLmdldFNlbGVjdGlvbigpLmdldFNlbGVjdGVkVGV4dCgpO1xuICAgICAgICAgICAgICAgIHNlbCA9IHNlbC5yZXBsYWNlKC9cXHMrL2csICcrJyk7OyAvL3JlcGxhY2UgYW55IHNwYWNlIHdpdGggK1xuICAgICAgICAgICAgICAgIG9wZW5Jbk5ld1RhYignaHR0cHM6Ly9lbi53aWtpcGVkaWEub3JnL3cvaW5kZXgucGhwP3NlYXJjaD0nICsgc2VsKTtcbiAgICAgICAgICAgICAgICAvLyBjb25zb2xlLmxvZyhzZWwpO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuXG4gICAgICAgICAgICBjYXNlIChhID09ICdGJyAmJiBiICYmIGMpOlxuICAgICAgICAgICAgICAgIHZhciBzZWwgPSBlZGl0b3IuZ2V0U2VsZWN0aW9uKCkuZ2V0U2VsZWN0ZWRUZXh0KCk7XG4gICAgICAgICAgICAgICAgc2VsID0gc2VsLnJlcGxhY2UoL1xccysvZywgJysnKTs7IC8vcmVwbGFjZSBhbnkgc3BhY2Ugd2l0aCArXG4gICAgICAgICAgICAgICAgb3BlbkluTmV3VGFiKCdodHRwczovL3d3dy5nb29nbGUuY29tL3NlYXJjaD9xPScgKyBzZWwpO1xuICAgICAgICAgICAgICAgIC8vIGNvbnNvbGUubG9nKHNlbCk7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG5cblxuICAgICAgICAgICAgY2FzZSAoYSA9PSAnSCcgJiYgYiAmJiBjKTpcbiAgICAgICAgICAgIGNhc2UgKGEgPT0gJ3MnICYmIGIpOlxuICAgICAgICAgICAgICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7IC8vYXZvaWQgb3RoZXIgc2hvcnRjdXQga2V5c1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuXG4gICAgICAgICAgICAgICAgLy8gY2FzZSAoYSA9PSAnTCcgJiYgYiAgJiYgYykgOiAvLyBDdHJsIFNoaWZ0IExcbiAgICAgICAgICAgICAgICAvLyAgICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7IC8vYXZvaWQgb3RoZXIgc2hvcnRjdXQga2V5c1xuICAgICAgICAgICAgICAgIC8vICAgICB0ZXh0ID0gZWRpdG9yLmdldENsaXBib2FyZERhdGEoXCJUZXh0XCIpO1xuICAgICAgICAgICAgICAgIC8vXG4gICAgICAgICAgICAgICAgLy8gICAgICBjb25zb2xlLmxvZyh0ZXh0KTtcbiAgICAgICAgICAgICAgICAvL1xuICAgICAgICAgICAgICAgIC8vIGJyZWFrO1xuXG5cblxuXG4gICAgICAgICAgICBjYXNlIChhID09ICdpJyAmJiBiICYmIGQpOiAvL0N0cmwgQWx0IGlcbiAgICAgICAgICAgICAgICBlZGl0b3IuZXhlY0NvbW1hbmQoJ21hdGhqYXgnKTsgLy93aWRnZXRcbiAgICAgICAgICAgICAgICBicmVhaztcblxuICAgICAgICAgICAgY2FzZSAoYSA9PSAnaScgJiYgYik6XG4gICAgICAgICAgICAgICAgLy8gY29uc29sZS5sb2coJ3ByZXNzIGN0cmwgSScpO1xuICAgICAgICAgICAgICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7IC8vYXZvaWQgb3RoZXIgc2hvcnRjdXQga2V5c1xuXG4gICAgICAgICAgICAgICAgZWRpdG9yLmV4ZWNDb21tYW5kKCdpbnNlcnRodG1sNHgnKTsgLy93aWRnZXRcbiAgICAgICAgICAgICAgICBicmVhaztcblxuXG5cbiAgICAgICAgfVxuXG5cbiAgICAgICAgLy8gaWYgKGV2ZW50LmtleSA9PT0gJ0gnICYmIGV2ZW50LmN0cmxLZXkgJiYgZXZlbnQuc2hpZnRLZXkgIClcbiAgICAgICAgLy8gICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XG4gICAgICAgIC8vIGlmIChldmVudC5rZXkgPT09ICdzJyAmJiBldmVudC5jdHJsS2V5ICApXG4gICAgICAgIC8vICAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xuICAgIH0pO1xuXG5cbiAgICBlZGl0b3Iub24oJ3Bhc3RlJywgZnVuY3Rpb24oZXZ0KSB7XG5cbiAgICAgICAgLy9cbiAgICAgICAgLy8gaWYgKCBjdHJsSSA9PSAxKXtcbiAgICAgICAgLy9cbiAgICAgICAgLy8gICAvLyB2YXIgaHRtbCA9IGVkaXRvci5nZXRDbGlwYm9hcmREYXRhKFwiVGV4dFwiKTtcbiAgICAgICAgLy8gICAvLyBjb25zb2xlLmxvZyAoXCJwYXN0ZSBldmVudFwiICsgaHRtbCk7XG4gICAgICAgIC8vICAgLy8gZWRpdG9yLmluc2VydEh0bWwoaHRtbCk7XG4gICAgICAgIC8vICAgY3RybEk9MDtcbiAgICAgICAgLy8gICBlZGl0b3IuZ2V0Q2xpcGJvYXJkRGF0YSggeyB0aXRsZTogJ0dldCBteSBkYXRhJyB9LCBmdW5jdGlvbiggZGF0YSApIHtcbiAgICAgICAgLy8gICAgICAgaWYgKCBkYXRhIClcbiAgICAgICAgLy8gICAgICAgICAgIGNvbnNvbGUubG9nKCAnZGF0YSBpczogJyArIGRhdGEuZGF0YVZhbHVlICk7XG4gICAgICAgIC8vICAgfSApO1xuICAgICAgICAvL1xuICAgICAgICAvLyB9XG4gICAgICAgIC8vXG5cblxuXG5cbiAgICAgICAgLy8gaGlnaGxpZ2h0anN3b3JrZXJzKCk7XG4gICAgfSk7XG5cblxuICAgIGVkaXRvci5vbignZm9jdXMnLCBmdW5jdGlvbihldnQpIHtcbiAgICAgICAgLy8gaGlnaGxpZ2h0anN3b3JrZXJzKCk7XG4gICAgfSk7XG5cbiAgICBlZGl0b3Iub24oJ2NsaWNrJywgZnVuY3Rpb24oZXZ0KSB7XG5cbiAgICAgICAgY29uc29sZS5sb2coJ2NsaWNrJyk7XG5cbiAgICB9KTtcblxuICAgIGVkaXRvci5vbignZG91YmxlY2xpY2snLCBmdW5jdGlvbihldnQpIHtcbiAgICAgICAgdmFyIGVsZW1lbnQgPSBldnQuZGF0YS5lbGVtZW50O1xuICAgICAgICAvL2NvbnNvbGUubG9nKCdkb3VibGVjbGljaycpO1xuICAgICAgICBjbGFzc2UgPSBlbGVtZW50LmdldEF0dHJpYnV0ZShcImNsYXNzXCIpO1xuICAgICAgICBpZiAoY2xhc3NlID09ICd2aWRlb2xpbmsnKSB7XG4gICAgICAgICAgICBsb2FkVmlkZW8oZWxlbWVudCk7XG4gICAgICAgIH1cbiAgICAgICAgY2xhc3NlID0gZWxlbWVudC5nZXRBdHRyaWJ1dGUoXCJjbGFzc1wiKTtcbiAgICAgICAgaWYgKGNsYXNzZSA9PSAndmlkZW9saW5rJykge1xuICAgICAgICAgICAgbG9hZFZpZGVvKGVsZW1lbnQpO1xuICAgICAgICB9XG4gICAgICAgIHZhciB0YWcgPSBlbGVtZW50LmdldE5hbWUoKTtcbiAgICAgICAgLy8gY29uc29sZS5sb2codGFnKTtcbiAgICAgICAgaWYgKHRhZyA9PSAnYScpIHtcbiAgICAgICAgICAgIHVybCA9IGVsZW1lbnQuZ2V0QXR0cmlidXRlKFwiaHJlZlwiKTtcbiAgICAgICAgICAgIG9wZW5Jbk5ld1RhYih1cmwpO1xuICAgICAgICAgICAgLy8gY29uc29sZS5sb2cgKCdjbGljayBsaW5rJysgdXJsKTtcblxuXG4gICAgICAgIH1cblxuICAgIH0pO1xuXG5cblxuXG4gICAgZWRpdG9yLm9uKCdibHVyJywgZnVuY3Rpb24oZXZ0KSB7XG5cbiAgICAgICAgY29uc29sZS5sb2coXCJibHVyclwiKTtcblxuICAgICAgICBzYXZlKGV2dCwgXCJzYXZlXCIpO1xuICAgICAgICAvLyBlZGl0b3IuZm9jdXMoKTtcblxuICAgIH0pO1xuXG5cbiAgICAvL2NoYW5nZSBldmVudFxuICAgIGVkaXRvci5vbignY2hhbmdlJywgZnVuY3Rpb24oZXZ0KSB7XG4gICAgICAgIC8vIGNvbnNvbGUubG9nKCAnVG90YWwgYnl0ZXM6ICcgKyBldnQuZWRpdG9yLmdldERhdGEoKS5sZW5ndGggKTtcbiAgICAgICAgLy8gY29uc29sZS5sb2coJ3NhdmVkJyskKCBcIiN0aXR0bGVcIiApLnZhbCgpKTtcbiAgICAgICAgLy8gJC5wb3N0KCBcIi9pbmMvc2F2ZS5waHBcIiwgeyBlZGl0YWJsZWRhdGE6IGV2dC5lZGl0b3IuZ2V0RGF0YSgpLCBlZGl0b3JJRDogJCggXCIjdGl0dGxlXCIgKS52YWwoKSB9ICk7XG5cbiAgICB9KTtcblxufSk7XG5cblxuZnVuY3Rpb24gb3BlbkluTmV3VGFiKHVybCkge1xuICAgIHZhciB3aW4gPSB3aW5kb3cub3Blbih1cmwsICdfYmxhbmsnKTtcbiAgICB3aW4uZm9jdXMoKTtcbn1cblxuZnVuY3Rpb24gaGFzaENvZGUoc3RyKSB7XG4gICAgdmFyIGhhc2ggPSAwO1xuICAgIGlmIChzdHIubGVuZ3RoID09IDApIHJldHVybiBoYXNoO1xuICAgIGZvciAoaSA9IDA7IGkgPCBzdHIubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgY2hhciA9IHN0ci5jaGFyQ29kZUF0KGkpO1xuICAgICAgICBoYXNoID0gKChoYXNoIDw8IDUpIC0gaGFzaCkgKyBjaGFyO1xuICAgICAgICBoYXNoID0gaGFzaCAmIGhhc2g7IC8vIENvbnZlcnQgdG8gMzJiaXQgaW50ZWdlclxuICAgIH1cbiAgICByZXR1cm4gaGFzaDtcbn1cblxuXG5mdW5jdGlvbiBjb252ZXJ0Q29pbih2YWx1ZSxjb2luLCB0b2NvaW4pIHtcbiAgICBjb25zb2xlLmxvZygnY29udmVydENvaW4nKVxuXG4gICAgbGV0IGFhPVwiPHNwYW4gZGF0YS1jb3N0PSdcIiArIHZhbHVlICsgXCInIGRhdGEtY29pbj0nXCIgKyBjb2luICsgXCInIGRhdGEtY29pbi1jb252ZXJ0PSdcIiArIHRvY29pbiArIFwiJyBjbGFzcz0nY29zdCc+VG8gY29udmVydCBcIiArIGNvaW4gKyBcIiBpbnRvIFwiICsgdG9jb2luICsgXCIgXCIgKyB2YWx1ZSArIFwiPC9zcGFuPlwiXG4gICAgLy8gJCgndGQgcDpoYXMoc3Bhbi5jb3N0KScpLmFkZENsYXNzKCdtaWRkbGUnKTtcbiAgICByZXR1cm4gYWFcbn1cblxuXG5mdW5jdGlvbiBkb1NvbWV0aGluZygpIHtcbiAgICByZXR1cm4gbmV3IFByb21pc2UoKHJlc29sdmUsIHJlamVjdCkgPT4ge1xuICAgICAgICBjb25zb2xlLmxvZyhcIkl0IGlzIGRvbmUuXCIpO1xuICAgICAgICAvLyBTdWNjZWVkIGhhbGYgb2YgdGhlIHRpbWUuXG4gICAgICAgIGlmIChNYXRoLnJhbmRvbSgpID4gLjUpIHtcbiAgICAgICAgICAgIHJlc29sdmUoXCJTVUNDRVNTXCIpXG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICByZWplY3QoXCJGQUlMVVJFXCIpXG4gICAgICAgIH1cbiAgICB9KVxufVxuXG5cblxuXG5mdW5jdGlvbiBmYW55aSh0ZXh0LCBsYW5nLCBsYW5ndG8pIHtcbiAgICByZXR1cm4gbmV3IFByb21pc2UoKHJlc29sdmUsIHJlamVjdCkgPT4ge1xuICAgICAgICBjb25zb2xlLmxvZyhgSXQgaXMgZG9uZS4gJHt0ZXh0fSAke2xhbmd9ICR7bGFuZ3RvfWApO1xuICAgICAgICAvLyBTdWNjZWVkIGhhbGYgb2YgdGhlIHRpbWUuXG4gICAgICAgIC8vIGxhbmcgPSAnemgnXG4gICAgICAgIC8vIGxhbmd0byA9ICdlbidcbiAgICAgICAgdmFyIHVybCA9ICdodHRwOi8vaTQ4Ny5seGMvZmFueWknXG4gICAgICAgIHZhciBoZWFkZXJzID0ge1xuICAgICAgICAgICAgXCJDb250ZW50LVR5cGVcIjogXCJhcHBsaWNhdGlvbi9qc29uXCJcbiAgICAgICAgfTtcbiAgICAgICAgdmFyIGRhdGEgPSB7XG4gICAgICAgICAgICBcImZyb21cIjogbGFuZyxcbiAgICAgICAgICAgIFwidG9cIjogbGFuZ3RvLFxuICAgICAgICAgICAgXCJzcmNcIjogdGV4dCxcbiAgICAgICAgICAgIFwiaVwiOicxJ1xuICAgICAgICB9O1xuICAgICAgICBjb25zb2xlLmxvZygndGhpcyBpcyB0aGUgdGV4dCB0byB0cmFuc2xhdGUgJyArIHRleHQpXG5cbiAgICAgICAgdmFyIGVuY29kZV9wYXJhbXMgPSAkLnBhcmFtKGRhdGEsIHRydWUpXG4gICAgICAgIHZhciB1cmwgPSB1cmwgKyAnPycgKyBlbmNvZGVfcGFyYW1zXG5cbiAgICAgICAgJC5nZXRKU09OKHVybCwgZnVuY3Rpb24oZGF0YSkge1xuXG4gICAgICAgICAgICByZXNvbHZlKGRhdGEpXG4gICAgICAgIH0pO1xuXG5cbiAgICB9KVxuXG59XG5cblxuXG5cblxuXG5mdW5jdGlvbiBtZXNzYWdlKHN0cikge1xuXG4gICAgJChcIiNzYXZpbmdcIikuaHRtbChzdHIpLmNzcyh7IG9wYWNpdHk6IDAuOTkgfSk7XG4gICAgJChcIiNzYXZpbmdcIikuYW5pbWF0ZSh7IG9wYWNpdHk6IDAgfSwgMTIwMCk7XG59XG5cbmZ1bmN0aW9uIGJhc2VuYW1lKHBhdGgsIHN1ZmZpeCkge1xuICAgIHZhciBiID0gcGF0aFxuICAgIHZhciBsYXN0Q2hhciA9IGIuY2hhckF0KGIubGVuZ3RoIC0gMSlcblxuICAgIGlmIChsYXN0Q2hhciA9PT0gJy8nIHx8IGxhc3RDaGFyID09PSAnXFxcXCcpIHtcbiAgICAgICAgYiA9IGIuc2xpY2UoMCwgLTEpXG4gICAgfVxuXG4gICAgYiA9IGIucmVwbGFjZSgvXi4qW1xcL1xcXFxdL2csICcnKVxuXG4gICAgaWYgKHR5cGVvZiBzdWZmaXggPT09ICdzdHJpbmcnICYmIGIuc3Vic3RyKGIubGVuZ3RoIC0gc3VmZml4Lmxlbmd0aCkgPT09IHN1ZmZpeCkge1xuICAgICAgICBiID0gYi5zdWJzdHIoMCwgYi5sZW5ndGggLSBzdWZmaXgubGVuZ3RoKVxuICAgIH1cblxuICAgIHJldHVybiBiXG59XG5cblxuZnVuY3Rpb24gZGlybmFtZShwYXRoKSB7XG4gICAgcmV0dXJuIHBhdGgucmVwbGFjZSgvXFxcXC9nLCAnLycpLnJlcGxhY2UoL1xcL1teXFwvXSpcXC8/JC8sICcnKVxufVxuXG5mdW5jdGlvbiBhZ3JlZ2F0ZXh0KHNlbGVjdG9yKSB7XG4gICAgdmFyIHRleHRzID0gJyc7XG5cbiAgICAkKFwiLmZpcnN0X2VkaXRvclwiKS5jaGlsZHJlbihzZWxlY3RvcikuZWFjaChmdW5jdGlvbigpIHtcblxuICAgICAgICAkKHRoaXMpLmNoaWxkcmVuKFwicFwiKS5lYWNoKGZ1bmN0aW9uKCkge1xuXG4gICAgICAgICAgICB0ZXh0cyArPSAkKHRoaXMpLnRleHQoKSArIFwiXFxyXFxuXCI7XG5cbiAgICAgICAgfSk7XG5cbiAgICAgICAgdmFyIGFsbExpc3RFbGVtZW50cyA9ICQoXCJsaSBiclwiKTtcblxuICAgICAgICAkKFwiLmZpcnN0X2VkaXRvclwiKS5maW5kKGFsbExpc3RFbGVtZW50cykuZWFjaChmdW5jdGlvbigpXG4gICAgICAgICAgICAvLyAkKHRoaXMpLm5leHRBbGwoXCJsaVwiKS5lYWNoKGZ1bmN0aW9uKClcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICB0ZXh0cyArPSBcIiAgXCIgKyAkKHRoaXMpLmNvbnRlbnRzKCkuZ2V0KDApLm5vZGVWYWx1ZSArIFwiXFxyXFxuXCI7XG5cbiAgICAgICAgICAgIH0pO1xuXG5cblxuXG5cbiAgICB9KTtcblxuXG4gICAgcmV0dXJuIHRleHRzO1xufVxuXG5cblxuXG5cblxuZnVuY3Rpb24gc2F2ZShldnQsIGFjdGlvbikge1xuXG5cbiAgICBzd2l0Y2ggKGFjdGlvbikge1xuICAgICAgICBjYXNlIFwic2F2ZVwiOiAvLyBlZGl0b3Igc2F2ZSBjb250ZW50XG4gICAgICAgICAgICBjb25zb2xlLmxvZyhcImVkaXRvciBzYXZlIDJcIik7XG4gICAgICAgICAgICAkLnBvc3QoXCIvaW5jL3NhdmUucGhwXCIsIHsgYWN0aW9uOiBcInNhdmVcIiwgZGF0YTogZXZ0LmVkaXRvci5nZXREYXRhKCksIHBhdGg6IFwiL2RhdGEvcncxL20xXCIsIGZpbGU6ICQoXCIjdGl0dGxlXCIpLnZhbCgpIH0pO1xuICAgICAgICAgICAgLy8gIHRvIHByZXZlbnQgdGltZSBjb25zdW1pbmdcbiAgICAgICAgICAgIC8vICByZWFkKCk7XG4gICAgICAgICAgICBtZXNzYWdlKFwiZmlsZSBzYXZlZFwiKTtcblxuXG5cblxuICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgIGNhc2UgXCJzYXZldG9maWxlXCI6XG4gICAgICAgICAgICBjb25zb2xlLmxvZyhcInNhdmUgdGV4dFwiKTtcbiAgICAgICAgICAgIHZhciBmaWxlID0gJChcIi5maXJzdF9lZGl0b3JcIikuY2hpbGRyZW4oXCIucGF0aFwiKS50ZXh0KCk7XG4gICAgICAgICAgICBjb25zb2xlLmxvZyhmaWxlKTtcbiAgICAgICAgICAgIG1lc3NhZ2UoXCJmaWxlIHNhdmVkIFwiICsgZmlsZSk7XG5cblxuICAgICAgICAgICAgLy8gdmFyIGZpbGUgPSBcIi9kYXRhL20zL21tLm1tXCI7XG4gICAgICAgICAgICB2YXIgcGF0aCA9IGRpcm5hbWUoZmlsZSk7XG4gICAgICAgICAgICB2YXIgZmlsZSA9IGJhc2VuYW1lKGZpbGUsICcnKTtcbiAgICAgICAgICAgIC8vIHZhciBkYXRhPScnO1xuICAgICAgICAgICAgLy8gJChcIiNzYXZldG9maWxlXCIpLmVhY2goZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICAvLyAgICBkYXRhID0gZGF0YSAgKyAgJCh0aGlzKS52YWwoKTtcbiAgICAgICAgICAgIC8vICAgIC8vY29kZVxuICAgICAgICAgICAgLy8gfSk7XG4gICAgICAgICAgICBkYXRhID0gYWdyZWdhdGV4dChcIi5zYXZldG9maWxlXCIpO1xuICAgICAgICAgICAgLy8gIGRhdGE9XCJ0ZXN0XCI7XG4gICAgICAgICAgICBjb25zb2xlLmxvZyhkYXRhKTtcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKHBhdGgpO1xuICAgICAgICAgICAgY29uc29sZS5sb2coZmlsZSk7XG5cbiAgICAgICAgICAgICQucG9zdChcIi9pbmMvc2F2ZS5waHBcIiwgeyBhY3Rpb246IFwic2F2ZVwiLCBkYXRhOiBkYXRhLCBwYXRoOiBwYXRoLCBmaWxlOiBmaWxlIH0pO1xuXG5cbiAgICAgICAgICAgIC8vIGNvbnNvbGUubG9nKHBhdGguYmFzZW5hbWUoc3RyLCAnLmh0bWwnKSk7XG5cbiAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICBkZWZhdWx0OlxuXG5cbiAgICAgICAgICAgIGNvbnNvbGUubG9nKFwic2F2ZSBkZWZhdWx0XCIpO1xuXG4gICAgfVxuXG5cblxuXG4gICAgLy8gIGNvbnNvbGUubG9nKFwiaGFzY29kZSBpcyBpczogXCIgKyBoYXNoQ29kZSgkKCBcIiNoaWRkZW5cIiApLnRleHQoKSkpO1xuICAgIC8vIGNvbnNvbGUubG9nIChcIjEgXCIgK2hhc2hDb2RlKCQoIFwiI2hpZGRlblwiICkudGV4dCgpKSk7XG4gICAgLy8gY29uc29sZS5sb2cgKFwiMiBcIiArJCggXCIjaGFzaFwiICkudGV4dCgpKTtcblxufVxuXG5cbmZ1bmN0aW9uIHJlYWQoKSB7XG5cblxuXG4gICAgJC5nZXQoJy9tMS8nICsgJChcIiN0aXR0bGVcIikudmFsKCksIHsgXCJfXCI6ICQubm93KCkgfSwgZnVuY3Rpb24oZGF0YTIpIHtcbiAgICAgICAgY29uc29sZS5sb2coXCJyZWFkaW5nIGZpbGUgXCIgKyAnL20xLycgKyAkKFwiI3RpdHRsZVwiKS52YWwoKSk7XG5cblxuICAgICAgICAvLyBjb25zb2xlLmxvZyhkYXRhKTtcbiAgICAgICAgLy8gICQoJyNoaWRkZW4nKS5odG1sKGRhdGEyKTtcbiAgICAgICAgJCgnLmZpcnN0X2VkaXRvcicpLmh0bWwoZGF0YTIpO1xuXG4gICAgICAgIGhpZ2hsaWdodGpzd29ya2VycygpO1xuXG5cbiAgICAgICAgLy8gJCgnLmZpcnN0X2VkaXRvcicpLmh0bWwoZGF0YSk7XG5cbiAgICB9KS5kb25lKGZ1bmN0aW9uKCkge1xuXG5cbiAgICAgICAgLy8gaWYgKGhhc2hDb2RlKCQoIFwiI2hpZGRlblwiICkudGV4dCgpKSA9PSAkKCBcIiNoYXNoXCIgKS50ZXh0KCkgICApXG4gICAgICAgIC8vIG1lc3NhZ2UoXCJubyBtb2RpZmlhdGlvbnNcIik7XG4gICAgICAgIC8vIGVsc2Uge1xuICAgICAgICAvLyAgIG1lc3NhZ2UgKFwic2F2ZWQhXCIpXG4gICAgICAgIC8vICAgJCggXCIjaGFzaFwiICkuaHRtbChoYXNoQ29kZSgkKCBcIiNoaWRkZW5cIiApLnRleHQoKSkpO31cbiAgICAgICAgLy9cbiAgICB9KS5mYWlsKGZ1bmN0aW9uKCkge1xuICAgICAgICAvLyQoJy5maXJzdF9lZGl0b3InKS5odG1sKFwiPGgxPmVycm9yIDQwNCBubyBmaWxlPC9oMT5cIik7IC8vIG9yIHdoYXRldmVyXG4gICAgfSwgJ3RleHQnKTtcblxufVxuXG5mdW5jdGlvbiBoaWdobGlnaHRqc3dvcmtlcnMoKSB7XG5cbiAgICAvLyBobGpzLmluaXRIaWdobGlnaHRpbmdPbkxvYWQoKTtcbiAgICAkKCdwcmUgY29kZScpLmVhY2goZnVuY3Rpb24oaSwgYmxvY2spIHtcbiAgICAgICAgaGxqcy5oaWdobGlnaHRCbG9jayhibG9jayk7XG4gICAgfSk7XG5cbiAgICAvLyAgdmFyIGNvZGUgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCdwcmUgY29kZScpO1xuICAgIC8vICB2YXIgd29ya2VyID0gbmV3IFdvcmtlcignL2pzL3dvcmtlci5qcycpO1xuICAgIC8vICBpZiAoIXdvcmtlci5vbm1lc3NhZ2UpIHsvL2F2b2lkIG51bGwgb2JqZWN0IGluIGNhc2UgZG9lc250IGV4aXN0c1xuICAgIC8vICB3b3JrZXIub25tZXNzYWdlID0gZnVuY3Rpb24oZXZlbnQpIHsgY29kZS5pbm5lckhUTUwgPSBldmVudC5kYXRhOyB9XG4gICAgLy8gLy8gd29ya2VyLnBvc3RNZXNzYWdlKGNvZGUudGV4dENvbnRlbnQpO1xuICAgIC8vIH1cbn07XG5cblxuLy9yZW5hbWUgZmlsZVxuZnVuY3Rpb24gcmVuYW1lKCkge1xuXG4gICAgY29uc29sZS5sb2coXCJjaGFuZ2UgdGhpcyBmaWxlOiBcIiArICQoXCIjdGl0dGxlXCIpLnZhbCgpICsgXCIgYnkgdGhpcyBmaWxlOiBcIiArICQoXCIjcmVuYW1lXCIpLnZhbCgpKTtcbiAgICAkLnBvc3QoXCIvaW5jL3NhdmUucGhwXCIsIHsgYWN0aW9uOiBcInJlbmFtZVwiLCBmaWxlOiAkKFwiI3RpdHRsZVwiKS52YWwoKSwgcGF0aDogXCIvZGF0YS9ydzEvbTFcIiwgZmlsZW91dDogJChcIiNyZW5hbWVcIikudmFsKCkgfSwgZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICAkKFwiI3RpdHRsZVwiKS52YWwoJChcIiNyZW5hbWVcIikudmFsKCkpO1xuICAgICAgICB9KVxuICAgICAgICAuZG9uZShmdW5jdGlvbigpIHtcbiAgICAgICAgICAgICQoXCIjc2F2aW5nXCIpLmh0bWwoXCJmaWxlIHJlbmFtZWQgdG8gXCIgKyAkKFwiI3JlbmFtZVwiKS52YWwoKSk7XG4gICAgICAgIH0pXG4gICAgICAgIC5mYWlsKGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgYWxlcnQoXCJlcnJvclwiKTtcbiAgICAgICAgfSk7XG5cbn07XG5cblxuLy9yZW5hbWUgZmlsZVxuZnVuY3Rpb24gdmVyc2lvbigpIHtcblxuICAgIGNvbnNvbGUubG9nKFwiY3JlYXRpbmcgYSBuZXcgdmVyc2lvbiBvZiB0aGlzOiBcIiArICQoXCIjdGl0dGxlXCIpLnZhbCgpKTtcblxuICAgICQucG9zdChcIi9pbmMvc2F2ZS5waHBcIiwgeyBhY3Rpb246IFwidmVyc2lvblwiLCBmaWxlOiAkKFwiI3RpdHRsZVwiKS52YWwoKSwgcGF0aDogXCIvZGF0YS9ydzEvbTFcIiwgZmlsZW91dDogJChcIiNyZW5hbWVcIikudmFsKCkgfSwgZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICAkKFwiI3RpdHRsZVwiKS52YWwoJChcIiNyZW5hbWVcIikudmFsKCkpO1xuICAgICAgICB9KVxuICAgICAgICAuZG9uZShmdW5jdGlvbigpIHtcbiAgICAgICAgICAgIG1lc3NhZ2UoXCJOZXcgdmVyc2lvbiBiYWNrZWRcIik7XG4gICAgICAgIH0pXG4gICAgICAgIC5mYWlsKGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgYWxlcnQoXCJlcnJvclwiKTtcbiAgICAgICAgfSk7XG5cbn07XG5cblxuXG5cblxuXG5mdW5jdGlvbiBsb2FkYXV0b3NlYXJjaChzb3VyY2UpIHtcblxuICAgIHZhciBvcHRpb25zID0ge1xuICAgICAgICB1cmw6IHNvdXJjZSxcbiAgICAgICAgZ2V0VmFsdWU6IFwiZmlsZW5hbWVcIixcbiAgICAgICAgLy8gbWluTGVuZ3RoOiAzLFxuICAgICAgICAvLyAgYXV0b0ZvY3VzOiB0cnVlLFxuICAgICAgICAvLyAgbXkgOiBcIjEwMCAxMDBcIixcbiAgICAgICAgLy8gIGF0OiBcImJvdHRvbVwiICxcbiAgICAgICAgLy8gIG9mOlwiI3RpdHRsZVwiLFxuXG4gICAgICAgIHRlbXBsYXRlOiB7XG4gICAgICAgICAgICB0eXBlOiBcImRlc2NyaXB0aW9uXCIsXG4gICAgICAgICAgICBmaWVsZHM6IHtcbiAgICAgICAgICAgICAgICAvLyBkZXNjcmlwdGlvbjogXCJlbWFpbFwiXG4gICAgICAgICAgICB9XG4gICAgICAgIH0sXG4gICAgICAgIGxpc3Q6IHtcbiAgICAgICAgICAgIG1hdGNoOiB7XG4gICAgICAgICAgICAgICAgZW5hYmxlZDogdHJ1ZVxuICAgICAgICAgICAgfVxuICAgICAgICB9LFxuXG4gICAgICAgIHRoZW1lOiBcInBsYXRlLWRhcmtcIlxuICAgIH07XG5cbiAgICAkKFwiI3RpdHRsZVwiKS5lYXN5QXV0b2NvbXBsZXRlKG9wdGlvbnMpO1xuXG59O1xuXG5cblxuXG5mdW5jdGlvbiBsb2FkVmlkZW8oZWxlbWVudCkge1xuXG4gICAgY29uc29sZS5sb2coJ2VsZW1lbnQgaXMgdmlkZW9saW5rJyk7XG4gICAgY29uc29sZS5sb2coZWxlbWVudC5nZXRBdHRyaWJ1dGUoXCJ2YWx1ZVwiKSk7XG4gICAgc3JjID0gZWxlbWVudC5nZXRBdHRyaWJ1dGUoXCJ2YWx1ZVwiKTtcbiAgICAvLyAkKCd2aWRlby52aWRlb3JlYWQgc291cmNlJykuYXR0cignc3JjJywgc3JjKTtcbiAgICAkKCcjbXktcGxheWVyX2h0bWw1X2FwaScpLmF0dHIoJ3NyYycsIHNyYyk7XG4gICAgJCgnI215LXBsYXllcl9odG1sNV9hcGknKS5sb2FkKCk7XG4gICAgJCgnI215LXBsYXllcl9odG1sNV9hcGknKS5wbGF5KCk7XG4gICAgLy8gJChcInZpZGVvLnZpZGVvcmVhZFwiKVswXS5sb2FkKCk7XG4gICAgLy8gJChcInZpZGVvLnZpZGVvcmVhZFwiKVswXS5wbGF5KCk7XG4gICAgLy8gZXZ0LmRhdGEuZGlhbG9nID0gJ3RhYmxlUHJvcGVydGllcycgICA7XG5cbn1cblxuXG5cbmZ1bmN0aW9uIGdldFBhcmFtZXRlckJ5TmFtZShuYW1lLCB1cmwpIHtcbiAgICBpZiAoIXVybCkgdXJsID0gd2luZG93LmxvY2F0aW9uLmhyZWY7XG4gICAgbmFtZSA9IG5hbWUucmVwbGFjZSgvW1xcW1xcXV0vZywgXCJcXFxcJCZcIik7XG4gICAgdmFyIHJlZ2V4ID0gbmV3IFJlZ0V4cChcIls/Jl1cIiArIG5hbWUgKyBcIig9KFteJiNdKil8JnwjfCQpXCIpLFxuICAgICAgICByZXN1bHRzID0gcmVnZXguZXhlYyh1cmwpO1xuICAgIGlmICghcmVzdWx0cykgcmV0dXJuIG51bGw7XG4gICAgaWYgKCFyZXN1bHRzWzJdKSByZXR1cm4gJyc7XG4gICAgcmV0dXJuIGRlY29kZVVSSUNvbXBvbmVudChyZXN1bHRzWzJdLnJlcGxhY2UoL1xcKy9nLCBcIiBcIikpO1xufVxuXG5cbmZ1bmN0aW9uIGluc2VydEJhaWR1bWFwKCkge1xuXG5cbiAgICB2YXIgbWFwID0gbmV3IEJNYXAuTWFwKFwiYWxsbWFwXCIpOyAvLyDliJvlu7pNYXDlrp7kvotcbiAgICBtYXAuY2VudGVyQW5kWm9vbShuZXcgQk1hcC5Qb2ludCgxMTYuNDA0LCAzOS45MTUpLCAxMSk7IC8vIOWIneWni+WMluWcsOWbvizorr7nva7kuK3lv4PngrnlnZDmoIflkozlnLDlm77nuqfliKtcbiAgICAvL+a3u+WKoOWcsOWbvuexu+Wei+aOp+S7tlxuICAgIG1hcC5hZGRDb250cm9sKG5ldyBCTWFwLk1hcFR5cGVDb250cm9sKHtcbiAgICAgICAgbWFwVHlwZXM6IFtcbiAgICAgICAgICAgIEJNQVBfTk9STUFMX01BUCxcbiAgICAgICAgICAgIEJNQVBfSFlCUklEX01BUFxuICAgICAgICBdXG4gICAgfSkpO1xuICAgIG1hcC5zZXRDdXJyZW50Q2l0eShcIuWMl+S6rFwiKTsgLy8g6K6+572u5Zyw5Zu+5pi+56S655qE5Z+O5biCIOatpOmhueaYr+W/hemhu+iuvue9rueahFxuICAgIG1hcC5lbmFibGVTY3JvbGxXaGVlbFpvb20odHJ1ZSk7IC8v5byA5ZCv6byg5qCH5rua6L2u57yp5pS+XG5cbn0iLCIvKiFcbiAqIG1vbmV5LmpzIC8gZngoKSB2MC4yXG4gKiBDb3B5cmlnaHQgMjAxNCBPcGVuIEV4Y2hhbmdlIFJhdGVzXG4gKlxuICogSmF2YVNjcmlwdCBsaWJyYXJ5IGZvciByZWFsdGltZSBjdXJyZW5jeSBjb252ZXJzaW9uIGFuZCBleGNoYW5nZSByYXRlIGNhbGN1bGF0aW9uLlxuICpcbiAqIEZyZWVseSBkaXN0cmlidXRhYmxlIHVuZGVyIHRoZSBNSVQgbGljZW5zZS5cbiAqIFBvcnRpb25zIG9mIG1vbmV5LmpzIGFyZSBpbnNwaXJlZCBieSBvciBib3Jyb3dlZCBmcm9tIHVuZGVyc2NvcmUuanNcbiAqXG4gKiBGb3IgZGV0YWlscywgZXhhbXBsZXMgYW5kIGRvY3VtZW50YXRpb246XG4gKiBodHRwOi8vb3BlbmV4Y2hhbmdlcmF0ZXMuZ2l0aHViLmlvL21vbmV5LmpzL1xuICovXG4oZnVuY3Rpb24ocm9vdCwgdW5kZWZpbmVkKSB7XG5cblx0Ly8gQ3JlYXRlIGEgc2FmZSByZWZlcmVuY2UgdG8gdGhlIG1vbmV5LmpzIG9iamVjdCBmb3IgdXNlIGJlbG93LlxuXHR2YXIgZnggPSBmdW5jdGlvbihvYmopIHtcblx0XHRyZXR1cm4gbmV3IGZ4V3JhcHBlcihvYmopO1xuXHR9O1xuXG5cdC8vIEN1cnJlbnQgdmVyc2lvbi5cblx0ZngudmVyc2lvbiA9ICcwLjInO1xuXG5cblx0LyogLS0tIFNldHVwIC0tLSAqL1xuXG5cdC8vIGZ4U2V0dXAgY2FuIGJlIGRlZmluZWQgYmVmb3JlIGxvYWRpbmcgbW9uZXkuanMsIHRvIHNldCB0aGUgZXhjaGFuZ2UgcmF0ZXMgYW5kIHRoZSBiYXNlXG5cdC8vIChhbmQgZGVmYXVsdCBmcm9tL3RvKSBjdXJyZW5jaWVzIC0gb3IgdGhlIHJhdGVzIGNhbiBiZSBsb2FkZWQgaW4gbGF0ZXIgaWYgbmVlZGVkLlxuXHR2YXIgZnhTZXR1cCA9IHJvb3QuZnhTZXR1cCB8fCB7XG5cdFx0cmF0ZXMgOiB7fSxcblx0XHRiYXNlIDogXCJcIlxuXHR9O1xuXG5cdC8vIE9iamVjdCBjb250YWluaW5nIGV4Y2hhbmdlIHJhdGVzIHJlbGF0aXZlIHRvIHRoZSBmeC5iYXNlIGN1cnJlbmN5LCBlZyB7IFwiR0JQXCIgOiBcIjAuNjRcIiB9XG5cdGZ4LnJhdGVzID0gZnhTZXR1cC5yYXRlcztcblxuXHQvLyBEZWZhdWx0IGV4Y2hhbmdlIHJhdGUgYmFzZSBjdXJyZW5jeSAoZWcgXCJVU0RcIiksIHdoaWNoIGFsbCB0aGUgZXhjaGFuZ2UgcmF0ZXMgYXJlIHJlbGF0aXZlIHRvXG5cdGZ4LmJhc2UgPSBmeFNldHVwLmJhc2U7XG5cblx0Ly8gRGVmYXVsdCBmcm9tIC8gdG8gY3VycmVuY2llcyBmb3IgY29udmVyc2lvbiB2aWEgZnguY29udmVydCgpOlxuXHRmeC5zZXR0aW5ncyA9IHtcblx0XHRmcm9tIDogZnhTZXR1cC5mcm9tIHx8IGZ4LmJhc2UsXG5cdFx0dG8gOiBmeFNldHVwLnRvIHx8IGZ4LmJhc2Vcblx0fTtcblxuXG5cdC8qIC0tLSBDb252ZXJzaW9uIC0tLSAqL1xuXG5cdC8vIFRoZSBiYXNlIGZ1bmN0aW9uIG9mIHRoZSBsaWJyYXJ5OiBjb252ZXJ0cyBhIHZhbHVlIGZyb20gb25lIGN1cnJlbmN5IHRvIGFub3RoZXJcblx0dmFyIGNvbnZlcnQgPSBmeC5jb252ZXJ0ID0gZnVuY3Rpb24odmFsLCBvcHRzKSB7XG5cdFx0Ly8gQ29udmVydCBhcnJheXMgcmVjdXJzaXZlbHlcblx0XHRpZiAodHlwZW9mIHZhbCA9PT0gJ29iamVjdCcgJiYgdmFsLmxlbmd0aCkge1xuXHRcdFx0Zm9yICh2YXIgaSA9IDA7IGk8IHZhbC5sZW5ndGg7IGkrKyApIHtcblx0XHRcdFx0dmFsW2ldID0gY29udmVydCh2YWxbaV0sIG9wdHMpO1xuXHRcdFx0fVxuXHRcdFx0cmV0dXJuIHZhbDtcblx0XHR9XG5cblx0XHQvLyBNYWtlIHN1cmUgd2UgZ290cyBzb21lIG9wdHNcblx0XHRvcHRzID0gb3B0cyB8fCB7fTtcblxuXHRcdC8vIFdlIG5lZWQgdG8ga25vdyB0aGUgYGZyb21gIGFuZCBgdG9gIGN1cnJlbmNpZXNcblx0XHRpZiggIW9wdHMuZnJvbSApIG9wdHMuZnJvbSA9IGZ4LnNldHRpbmdzLmZyb207XG5cdFx0aWYoICFvcHRzLnRvICkgb3B0cy50byA9IGZ4LnNldHRpbmdzLnRvO1xuXG5cdFx0Ly8gTXVsdGlwbGUgdGhlIHZhbHVlIGJ5IHRoZSBleGNoYW5nZSByYXRlXG5cdFx0cmV0dXJuIHZhbCAqIGdldFJhdGUoIG9wdHMudG8sIG9wdHMuZnJvbSApO1xuXHR9O1xuXG5cdC8vIFJldHVybnMgdGhlIGV4Y2hhbmdlIHJhdGUgdG8gYHRhcmdldGAgY3VycmVuY3kgZnJvbSBgYmFzZWAgY3VycmVuY3lcblx0dmFyIGdldFJhdGUgPSBmdW5jdGlvbih0bywgZnJvbSkge1xuXHRcdC8vIFNhdmUgYnl0ZXMgaW4gbWluaWZpZWQgdmVyc2lvblxuXHRcdHZhciByYXRlcyA9IGZ4LnJhdGVzO1xuXG5cdFx0Ly8gTWFrZSBzdXJlIHRoZSBiYXNlIHJhdGUgaXMgaW4gdGhlIHJhdGVzIG9iamVjdDpcblx0XHRyYXRlc1tmeC5iYXNlXSA9IDE7XG5cblx0XHQvLyBUaHJvdyBhbiBlcnJvciBpZiBlaXRoZXIgcmF0ZSBpc24ndCBpbiB0aGUgcmF0ZXMgYXJyYXlcblx0XHRpZiAoICFyYXRlc1t0b10gfHwgIXJhdGVzW2Zyb21dICkgdGhyb3cgXCJmeCBlcnJvclwiO1xuXG5cdFx0Ly8gSWYgYGZyb21gIGN1cnJlbmN5ID09PSBmeC5iYXNlLCByZXR1cm4gdGhlIGJhc2ljIGV4Y2hhbmdlIHJhdGUgZm9yIHRoZSBgdG9gIGN1cnJlbmN5XG5cdFx0aWYgKCBmcm9tID09PSBmeC5iYXNlICkge1xuXHRcdFx0cmV0dXJuIHJhdGVzW3RvXTtcblx0XHR9XG5cblx0XHQvLyBJZiBgdG9gIGN1cnJlbmN5ID09PSBmeC5iYXNlLCByZXR1cm4gdGhlIGJhc2ljIGludmVyc2UgcmF0ZSBvZiB0aGUgYGZyb21gIGN1cnJlbmN5XG5cdFx0aWYgKCB0byA9PT0gZnguYmFzZSApIHtcblx0XHRcdHJldHVybiAxIC8gcmF0ZXNbZnJvbV07XG5cdFx0fVxuXG5cdFx0Ly8gT3RoZXJ3aXNlLCByZXR1cm4gdGhlIGB0b2AgcmF0ZSBtdWx0aXBsZWQgYnkgdGhlIGludmVyc2Ugb2YgdGhlIGBmcm9tYCByYXRlIHRvIGdldCB0aGVcblx0XHQvLyByZWxhdGl2ZSBleGNoYW5nZSByYXRlIGJldHdlZW4gdGhlIHR3byBjdXJyZW5jaWVzXG5cdFx0cmV0dXJuIHJhdGVzW3RvXSAqICgxIC8gcmF0ZXNbZnJvbV0pO1xuXHR9O1xuXG5cblx0LyogLS0tIE9PUCB3cmFwcGVyIGFuZCBjaGFpbmluZyAtLS0gKi9cblxuXHQvLyBJZiBmeCh2YWwpIGlzIGNhbGxlZCBhcyBhIGZ1bmN0aW9uLCBpdCByZXR1cm5zIGEgd3JhcHBlZCBvYmplY3QgdGhhdCBjYW4gYmUgdXNlZCBPTy1zdHlsZVxuXHR2YXIgZnhXcmFwcGVyID0gZnVuY3Rpb24odmFsKSB7XG5cdFx0Ly8gRXhwZXJpbWVudGFsOiBwYXJzZSBzdHJpbmdzIHRvIHB1bGwgb3V0IGN1cnJlbmN5IGNvZGUgYW5kIHZhbHVlOlxuXHRcdGlmICggdHlwZW9mXHR2YWwgPT09IFwic3RyaW5nXCIgKSB7XG5cdFx0XHR0aGlzLl92ID0gcGFyc2VGbG9hdCh2YWwucmVwbGFjZSgvW14wLTktLl0vZywgXCJcIikpO1xuXHRcdFx0dGhpcy5fZnggPSB2YWwucmVwbGFjZSgvKFteQS1aYS16XSkvZywgXCJcIik7XG5cdFx0fSBlbHNlIHtcblx0XHRcdHRoaXMuX3YgPSB2YWw7XG5cdFx0fVxuXHR9O1xuXG5cdC8vIEV4cG9zZSBgd3JhcHBlci5wcm90b3R5cGVgIGFzIGBmeC5wcm90b3R5cGVgXG5cdHZhciBmeFByb3RvID0gZngucHJvdG90eXBlID0gZnhXcmFwcGVyLnByb3RvdHlwZTtcblxuXHQvLyBmeCh2YWwpLmNvbnZlcnQob3B0cykgZG9lcyB0aGUgc2FtZSB0aGluZyBhcyBmeC5jb252ZXJ0KHZhbCwgb3B0cylcblx0ZnhQcm90by5jb252ZXJ0ID0gZnVuY3Rpb24oKSB7XG5cdFx0dmFyIGFyZ3MgPSBBcnJheS5wcm90b3R5cGUuc2xpY2UuY2FsbChhcmd1bWVudHMpO1xuXHRcdGFyZ3MudW5zaGlmdCh0aGlzLl92KTtcblx0XHRyZXR1cm4gY29udmVydC5hcHBseShmeCwgYXJncyk7XG5cdH07XG5cblx0Ly8gZngodmFsKS5mcm9tKGN1cnJlbmN5KSByZXR1cm5zIGEgd3JhcHBlZCBgZnhgIHdoZXJlIHRoZSB2YWx1ZSBoYXMgYmVlbiBjb252ZXJ0ZWQgZnJvbVxuXHQvLyBgY3VycmVuY3lgIHRvIHRoZSBgZnguYmFzZWAgY3VycmVuY3kuIFNob3VsZCBiZSBmb2xsb3dlZCBieSBgLnRvKG90aGVyQ3VycmVuY3kpYFxuXHRmeFByb3RvLmZyb20gPSBmdW5jdGlvbihjdXJyZW5jeSkge1xuXHRcdHZhciB3cmFwcGVkID0gZngoY29udmVydCh0aGlzLl92LCB7ZnJvbTogY3VycmVuY3ksIHRvOiBmeC5iYXNlfSkpO1xuXHRcdHdyYXBwZWQuX2Z4ID0gZnguYmFzZTtcblx0XHRyZXR1cm4gd3JhcHBlZDtcblx0fTtcblxuXHQvLyBmeCh2YWwpLnRvKGN1cnJlbmN5KSByZXR1cm5zIHRoZSB2YWx1ZSwgY29udmVydGVkIGZyb20gYGZ4LmJhc2VgIHRvIGBjdXJyZW5jeWBcblx0ZnhQcm90by50byA9IGZ1bmN0aW9uKGN1cnJlbmN5KSB7XG5cdFx0cmV0dXJuIGNvbnZlcnQodGhpcy5fdiwge2Zyb206IHRoaXMuX2Z4ID8gdGhpcy5fZnggOiBmeC5zZXR0aW5ncy5mcm9tLCB0bzogY3VycmVuY3l9KTtcblx0fTtcblxuXG5cdC8qIC0tLSBNb2R1bGUgRGVmaW5pdGlvbiAtLS0gKi9cblxuXHQvLyBFeHBvcnQgdGhlIGZ4IG9iamVjdCBmb3IgQ29tbW9uSlMuIElmIGJlaW5nIGxvYWRlZCBhcyBhbiBBTUQgbW9kdWxlLCBkZWZpbmUgaXQgYXMgc3VjaC5cblx0Ly8gT3RoZXJ3aXNlLCBqdXN0IGFkZCBgZnhgIHRvIHRoZSBnbG9iYWwgb2JqZWN0XG5cdGlmICh0eXBlb2YgZXhwb3J0cyAhPT0gJ3VuZGVmaW5lZCcpIHtcblx0XHRpZiAodHlwZW9mIG1vZHVsZSAhPT0gJ3VuZGVmaW5lZCcgJiYgbW9kdWxlLmV4cG9ydHMpIHtcblx0XHRcdGV4cG9ydHMgPSBtb2R1bGUuZXhwb3J0cyA9IGZ4O1xuXHRcdH1cblx0XHRleHBvcnRzLmZ4ID0gZng7XG5cdH0gZWxzZSBpZiAodHlwZW9mIGRlZmluZSA9PT0gJ2Z1bmN0aW9uJyAmJiBkZWZpbmUuYW1kKSB7XG5cdFx0Ly8gUmV0dXJuIHRoZSBsaWJyYXJ5IGFzIGFuIEFNRCBtb2R1bGU6XG5cdFx0ZGVmaW5lKFtdLCBmdW5jdGlvbigpIHtcblx0XHRcdHJldHVybiBmeDtcblx0XHR9KTtcblx0fSBlbHNlIHtcblx0XHQvLyBVc2UgZngubm9Db25mbGljdCB0byByZXN0b3JlIGBmeGAgYmFjayB0byBpdHMgb3JpZ2luYWwgdmFsdWUgYmVmb3JlIG1vbmV5LmpzIGxvYWRlZC5cblx0XHQvLyBSZXR1cm5zIGEgcmVmZXJlbmNlIHRvIHRoZSBsaWJyYXJ5J3MgYGZ4YCBvYmplY3Q7IGUuZy4gYHZhciBtb25leSA9IGZ4Lm5vQ29uZmxpY3QoKTtgXG5cdFx0Zngubm9Db25mbGljdCA9IChmdW5jdGlvbihwcmV2aW91c0Z4KSB7XG5cdFx0XHRyZXR1cm4gZnVuY3Rpb24oKSB7XG5cdFx0XHRcdC8vIFJlc2V0IHRoZSB2YWx1ZSBvZiB0aGUgcm9vdCdzIGBmeGAgdmFyaWFibGU6XG5cdFx0XHRcdHJvb3QuZnggPSBwcmV2aW91c0Z4O1xuXHRcdFx0XHQvLyBEZWxldGUgdGhlIG5vQ29uZmxpY3QgZnVuY3Rpb246XG5cdFx0XHRcdGZ4Lm5vQ29uZmxpY3QgPSB1bmRlZmluZWQ7XG5cdFx0XHRcdC8vIFJldHVybiByZWZlcmVuY2UgdG8gdGhlIGxpYnJhcnkgdG8gcmUtYXNzaWduIGl0OlxuXHRcdFx0XHRyZXR1cm4gZng7XG5cdFx0XHR9O1xuXHRcdH0pKHJvb3QuZngpO1xuXG5cdFx0Ly8gRGVjbGFyZSBgZnhgIG9uIHRoZSByb290IChnbG9iYWwvd2luZG93KSBvYmplY3Q6XG5cdFx0cm9vdFsnZngnXSA9IGZ4O1xuXHR9XG5cblx0Ly8gUm9vdCB3aWxsIGJlIGB3aW5kb3dgIGluIGJyb3dzZXIgb3IgYGdsb2JhbGAgb24gdGhlIHNlcnZlcjpcbn0odGhpcykpO1xuIl19"}