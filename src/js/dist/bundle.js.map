{"version":3,"sources":["../../../../../../home/agalan/.npm-global/lib/node_modules/browserify/node_modules/browser-pack/_prelude.js","main.js","node_modules/money/money.js"],"names":[],"mappings":"AAAA;ACAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC7jCA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"bundle.js","sourcesContent":["(function(){function r(e,n,t){function o(i,f){if(!n[i]){if(!e[i]){var c=\"function\"==typeof require&&require;if(!f&&c)return c(i,!0);if(u)return u(i,!0);var a=new Error(\"Cannot find module '\"+i+\"'\");throw a.code=\"MODULE_NOT_FOUND\",a}var p=n[i]={exports:{}};e[i][0].call(p.exports,function(r){var n=e[i][1][r];return o(n||r)},p,p.exports,r,e,n,t)}return n[i].exports}for(var u=\"function\"==typeof require&&require,i=0;i<t.length;i++)o(t[i]);return o}return r})()","//\n// function saveintobrowser(filename,html){\n//\n// // filename=$( \"#tittle\" ).val()\n// // html=evt.editor.getData()\n// // lack of sync into the server\n//   var db = new Dexie(\"m13\");\n//   db.version(1).stores({\n//     files: \"filename,html\"\n//   });\n//\n//   db.open().catch(function (e) {\n//      alert (\"Open failed: \" + e);});\n//\n//\n//   db.transaction(\"rw\", db.files, function () {\n//       // Update the register if exists if not add\n//      db.files.where(\"filename\").equals(filename).modify({html: html}).then(function(updated)\n//      {\n//        if (updated)\n//            console.log (\"pedro found and update\");\n//        else\n//        {\n//        console.log (\"pedro not found \");\n//        db.files.add({filename: $( \"#tittle\" ).val(), html:  evt.editor.getData()});} });   });\n//\n// };\n\n\nvar ctrlI = false;\nvar fx = require('money');\n// require('ckeditor');\n// CKEDITOR.replace( 'editor' );\n\n\n// Add an event listener\ndocument.addEventListener(\"name-of-event\", function(e) {\n    // console.log(e.detail); // Prints \"Example of an event\"\n});\n\n\n// $(\".videolink\").click(function(){\n\n//     var src = $(this).attr(\"value\");\n//    // alert(src);\n// // console.log(evt);\n// // console.log($(this));\n// // console.log(\"clicked videolink in ckeditor\");\n// loadVideo(src);\n\n\n// })\n\n// function loadVideo2(){\n\n//     console.log('clicked loadVideo2');\n// }\n\n\n$(document).ready(function() {\n\n    // var b1 = document.getElementById(\"MW\");\n    // b1.tabIndex = 5; //change the default tabindex\n\n\n\n    $('.jieba').on('click touchstart', function() {\n       // console.log('hello')\n\n         \n    // text=\"展示的时候\"\n    text=$(this).text()\n\n           console.log(text)\n        lang = 'zh'\n        langto = 'en'\n            console.log('doing translation')\n\n        fanyi(text, lang, langto).then(function(aa) {\n            console.log(aa.src)\n            aa.dst = aa.pinyin + \"<br>\" + aa.translate + aa.handi\n            var trad = '<div class=\"audiofanyi\">' + aa.audio + '</div>' +aa.src + ': </br> ' + aa.dst ;\n            $('#fanyi55').html(trad)\n        });\n\n    }); \n\n\n\n\n    var url = getParameterByName('url');\n    if (url) {\n\n        // console.log(url);\n\n        $(\"#tittle\").val(url);\n        $(\"#rename\").val(url);\n        //  read();\n        //$(\".first_editor\").focus();\n        // $(\"#tittle\").focus().select();\n    } else {\n        $(\"#tittle\").focus().select();\n    }\n\n\n    // loadautosearch(\"/resources/files2.json\");\n\n\n    // $( \".first_editor h3\" ).click(function() {\n    //   alert('clicked');\n    //   $(this).nextUntil( \".first_editor h3, .first_editor h2\" ).toggle();\n    // });\n    // $( \".first_editor h4\" ).click(function() {\n    //   $(this).nextUntil( \".first_editor h4, .first_editor h3 \" ).toggle();\n    // });\n    //\n    // $( \"h2\" ).click(function() {\n    //   $(this).next( \"h2, h1\" ).toggle();\n    // });\n    //\n    // $( \"h1\" ).click(function() {\n    //   $(this).next( \"h1\" ).toggle();\n    // });\n\n\n\n\n\nwindow.addEventListener(\"keydown\", function (event) {\n  if (event.defaultPrevented) {\n    return; // Do nothing if the event was already processed\n  }\n\n  switch (event.key) {\n    case \"ArrowDown\":\n      // Do something for \"down arrow\" key press.\n      break;\n    case \"ArrowUp\":\n      // Do something for \"up arrow\" key press.\n      break;\n    case \"ArrowLeft\":\n      // Do something for \"left arrow\" key press.\n      break;\n    case \"ArrowRight\":\n      // Do something for \"right arrow\" key press.\n      break;\n    case \"Enter\":\n      // Do something for \"enter\" or \"return\" key press.\n      break;\n    case \"Escape\":\n      // Do something for \"esc\" key press.\n      console.log('press escape')\n             translate_select();\n      break;\n    default:\n      return; // Quit when this doesn't handle the key event.\n  }\n\n  // Cancel the default action to avoid it being handled twice\n  event.preventDefault();\n}, true);\n\n\nfunction translate_select(){\n\n\n        text = window.getSelection().toString()\n                console.log(text)\n        lang = 'zh'\n        langto = 'en'\n            console.log('doing translation')\n\n        fanyi(text, lang, langto).then(function(aa) {\n            console.log(aa.src)\n            aa.dst = aa.pinyin + \"<br>\" + aa.translate + aa.handi\n            var trad = '<div class=\"audiofanyi\">' + aa.audio + '</div>' +aa.src + ': </br> ' + aa.dst ;\n            $('#fanyi55').html(trad)\n        });\n\n}\n\n\n    $(\".jieba\").dblclick(function() {\n  \n\ntranslate_select()\n\n\n    })\n\n\n\n\n\n\n\n\n    $(\"button#puttogether\").click(function() {\n        sel = editor.extractSelectedHtml()\n        aa = sel.getHtml().replace(/<br>/gm, '')\n        editor.insertHtml(aa);\n    })\n\n    $(\"button#autotrans\").click(function() {\n        $(\"span[lang='zh-cn']\").css('color', 'red')\n        let lang = 'zh'\n        let langto = 'en'\n        let bb = $(\"span[lang='zh-cn']:eq(1)\").text()\n        console.log(`to translate: ${bb}`)\n        fanyi(bb, 'zh', 'en').then(function(aa) {\n            let translation = \"<span class='original' lang='\" + lang + \"' data-pseudo-content='\" + aa.src + \"' >&nbsp;</span><span class='translate'  lang='\" + langto + \"' >\" + aa.translate + \"</span>\"\n            console.log(aa.i)\n            $(\"span[lang='zh-cn']:eq(1)\").html(translation)\n            $(\"span[lang='zh-cn']:eq(1)\").attr('lang', '')\n        })\n\n    })\n\n\n\n    $(\"button#position\").click(function() {\n        console.log('clicked save position')\n        $(\"#scrollArea\").scrollTop()\n\n\n    });\n\n    $(\"button#trans\").click(function() {\n        console.log('clicked translate')\n        $(\".translate\").show();\n        $(\".original\").hide();\n\n\n    });\n\n    $(\"button#showtranslate\").click(function() {\n        console.log('clicked showtranslate')\n        $(\".translate\").show();\n        $(\".original\").show();\n\n    });\n\n\n    $(\"button#addabsolutepath\").click(function() {\n\n        console.log('clicked addabsolutepath2')\n\n\n        $('img').each(function(i, v) {\n            if ($(this).attr('src').includes(\"http\")) {\n                console.log('not change')\n\n            } else {\n                var aaa = document.location.origin + $(this).attr('src');\n                $(this).attr('src', aaa);\n                console.log($(this).attr('src'))\n            }\n        });\n\n    });\n\n    $(\"button#sharelink\").click(function() {\n\n\n        console.log('clicked sharelink ')\n        console.log(document.location.origin +\"/ebrain?url=\" + $('#tittle').val())\n\n        $.getJSON('ebrain?url=' + $('#tittle').val(),\n            function(data) {\n\n                $('#sharelink').attr('href', document.location.origin +'/view.php?url=' + data.hash)\n\n            })\n\n\n    });\n\n    $(\"button#updatecost\").click(function() {\n        console.log('clicked updatedcost ')\n\n        $.getJSON(\n            // NB: using Open Exchange Rates here, but you can use any source!\n            'https://openexchangerates.org/api/latest.json?app_id=960f0b8dca9344328b13ef816957d810',\n            function(data) {\n                // Check money.js has finished loading:\n                if (typeof fx !== \"undefined\" && fx.rates) {\n                    fx.rates = data.rates;\n                    fx.base = data.base;\n\n\n                    console.log('updating cost...')\n\n                    $('.cost').each(function(i, v) {\n                        aa = $(this).attr('data-cost')\n                        total = Math.round(fx(aa).from(\"CNY\").to(\"EUR\") / 0.0095) / 100;\n                        console.log(\"converting CNY into EUR\" + fx(1).from(\"CNY\").to(\"EUR\"));\n                        $(this).text(total)\n                    });\n\n                } else {\n                    // If not, apply  to fxSetup global:\n                    var fxSetup = {\n                        rates: data.rates,\n                        base: data.base\n                    }\n\n                }\n                var d = new Date();\n                var datetime = d.getFullYear() + '-' + d.getMonth() + '-' + d.getDate();\n                editor.insertHtml(\"<span class='information'> date: \" + datetime + \" CNY to EUR Convert rate is  \" + fx(1).from(\"CNY\").to(\"EUR\") + \"</span>\")\n            }\n        );\n\n\n\n\n\n\n    });\n    // https://openexchangerates.github.io/money.js/#download\n\n\n    $(\"#tittle\").focusout(function() {\n        // console.log('1');\n\n        console.log($(\"#tittle\").val());\n        $(\"#rename\").val($(\"#tittle\").val());\n        $('.first_editor').attr('id', $(\"#tittle\").val());\n        $('.first_editor').attr(\"contenteditable\", \"true\");\n        $('.first_editor').focus();\n        read();\n        // editor.setData($( \"#hidden\" ).html());  // load data in the editor\n\n        // hljs.initHighlightingOnLoad();\n\n    });\n\n\n\n\n    $(\"#rename\").focusout(function() {\n        // console.log('2');\n\n        if ($(\"#tittle\").val() == $(\"#rename\").val())\n\n            // editor.setData($( \"#hidden\" ).html());  // load data in the editor\n            read();\n        else {\n            rename();\n        }\n\n\n    });\n\n\n\n\n\n    CKEDITOR.instances['introduction'].destroy();\n    var editor = CKEDITOR.inline(\"introduction\");\n\n\n\n\n    document.addEventListener('paste', function(e) {\n        //    var html = e.clipboardData.getData (\"Text\");\n        // e.preventDefault();\n        //      if ( ctrlI ){\n        //        // CKEDITOR.instances['introduction'].destroy();\n        //        //\n        //        //    var editor = CKEDITOR.inline(\"introduction\");\n        //\n        //        console.log (\"paste event\");\n        //        // editor.insertHtml(html);\n        //      }\n        //    // var html = e.clipboardData.getData('text/html');\n        //    console.log(html);\n        //    // Whatever you want to do with the html\n    });\n\n\n    editor.on('paste', function(evt) {\n        evt.stop();\n        var data = evt.data.dataValue;\n\n        if (window.chrome || window.safari) {\n            // removing span wrapper on webkit browsers.\n            data = $(data).html();\n        }\n        evt.editor.insertHtml(data);\n    });\n\n\n\n    editor.on('key', function(evt) {\n        // console.log('3');\n        //http://stackoverflow.com/questions/4401469/how-to-select-a-text-range-in-ckeditor-programatically\n\n        var charCode = evt.data.keyCode; // at the moment this is wrong, keyCode needs to be properly converted to charCode\n        // var clipboardData = evt.data.dataValue;\n        console.log(charCode);\n        var tag = \"h1\";\n        //  console.log(selectedText);\n        switch (charCode) {\n            case 1114161: // Ctrl 1\n                tag = \"<h1></h1>\";\n                break;\n            case 1114162: // Ctrl 2\n                tag = \"<h2></h2>\";\n                break;\n            case 1114163: // Ctrl 3\n                tag = \"<h3></h3>\";\n                break;\n            case 1114164: // Ctrl 4\n                tag = \"<h4></h4>\";\n                break;\n            case 1114166: // Ctrl 6\n                tag = \"<h5></h5>\";\n                break;\n            case 1114169: // Ctrl 6\n                editor.insertHtml(\"<div class='savetofile'>put text</div>\");\n                break;\n\n            case 1114300: // Ctrl ,\n                console.log('convert Coin');\n\n                sel = editor.getSelection().getSelectedText()\n                console.log(sel)\n\n                editor.insertHtml(convertCoin(sel, \"yuan\", \"euro\"))\n                $('p:has(span.cost)').addClass('middle');\n\n                break;\n\n\n            case 1114304: // Ctrl `\n                console.log('request fanyi');\n                let lang = $(\"#lang\").val(),\n                    langto = $(\"#langto\").val()\n\n\n\n                sel = editor.getSelection().getSelectedText().replace(/(\\r\\n\\t|\\n|\\r\\t)/gm, \"\");\n                if (sel.length > 0) {\n                    fanyi(sel, lang, langto).then(function(aa) {\n                        let translation = \"<span class='original' lang='\" + lang + \"' data-pseudo-content='\" + aa.src + \"' >&nbsp;</span><span class='translate'  lang='\" + langto + \"' >\" + aa.translate + \"</span>\"\n                        editor.insertHtml(translation);\n                    })\n                }\n\n\n\n                break;\n\n\n\n\n            case 5570638: // Ctrl Alt N\n                // tag=\"<b></b>\";\n                tag = \"<em></em>\"; //emphasis\n                break;\n\n            case 5570637: // Ctrl Alt M\n                tag = \"<mark></mark>\";\n                break;\n            case 5570628: // Ctrl Alt D\n                var d = new Date();\n                var datetime = d.getFullYear() + '-' + d.getMonth() + '-' + d.getDate();\n                tag = \"<del datetime=\" + datetime + \" title=\" + datetime + \"></div>\"; //del text\n                break;\n            case 5570633: // Ctrl Alt I\n                tag = \"<em></em>\"; //emphasis\n                break;\n            case 2228314: // Shift Z   Test\n                $(\"#cke_3_top\").toggle();\n                break;\n            case 3342408: // CTRL Shift H  Hide/show tool bar\n                // evt.data.stopPropagation();\n                // evt.data.preventDefault();\n                $(\"#cke_3_top\").toggle();\n                break;\n            case 1114195: //Ctrl S save a version\n                version();\n                if ($('.savetofile').length > 0)\n                    save(evt, \"savetofile\");\n\n                break;\n\n            case 3342404: // Ctrl Shift D  Insert detail/Summary html\n                var sel = editor.getSelection().getSelectedText();\n                if (sel.length > 0) {\n                    var details = new CKEDITOR.dom.element('details');\n                    details.setHtml(' <summary>' + sel + '</summary><p>More info about the details.</p>');\n                    editor.insertElement(details);\n                }\n                break;\n            case 1114191: // Ctrl O  Open codeSnippet dialog\n                editor.execCommand('codeSnippet'); //widget\n                break;\n\n            case 1114185: // Ctrl I  Inserthtml\n                // var sel = editor.getSelection().getSelectedText();\n                ctrlI = !ctrlI;\n\n                // evt.data.dataValue = evt.data.dataValue\n                // editor.fire( 'paste',editor);\n                // console.log(e.clipboardData.getData('text/html'));\n\n                // This code obviously will not preserve the case of the first and last letters.\n                // Let it be an exercise for the reader ;).\n                // editor.execCommand( 'inserthtml4x');  //widget\n\n                break;\n\n            case 1114182: // Ctrl F open dialog Find and replace\n                editor.execCommand('find');\n                break;\n\n            case 3342402: // Ctrl Shift B\n                editor.insertHtml(\"<br/>\");\n                break;\n                // case 7798868:// Ctrl ALT SHIT T\n                //   editor.insertHtml( \"<table class=table1Class' > <tbody> \\\n                //      <tr><td>1</td><td>2</td></tr><tr><td>1</td><td>2</td></tr> \\\n                //      </tbody></table>\");\n                //   //  editor.insertHtml( clipboardData);\n                //     // console.log(clipboardData);\n                //    break;\n            case 3342422: // Ctrol shift V\n                texto = 'Crtl + SHIFT V'; // Ctrl 1\n                // text = window.clipboardData.getData(\"Text\");\n                // console.log(texto);\n                // editor.insertHtml( clipboardData);\n                // console.log(texto);\n                break;\n            default:\n                texto = 'Other key';\n        }\n\n\n        var keypress = [1114161, 1114162, 1114163, 1114164, 1114166, 1114169, 5570637, 5570628, 5570633, 5570638];\n        // console.log(keypress.indexOf(charCode));\n        if (keypress.indexOf(charCode) > -1) { // retag the select area\n            var sel = editor.getSelection().getSelectedText();\n            if (sel.length > 0) {\n                //  var newElement = new CKEDITOR.dom.element(tag);\n                var newElement = CKEDITOR.dom.element.createFromHtml(tag)\n                // newElement.setAttributes({style: ''});\n                newElement.setText(sel);\n                editor.insertElement(newElement);\n            } else {\n                var newElement = new CKEDITOR.dom.element(tag);\n                // newElement.setAttributes({style: ''});\n                newElement.setText(sel);\n                //  editor.insertElement(newElement).selectElement();\n                //  editor.getSelection().selectElement(newElement);\n\n            }\n        }\n\n\n    });\n\n\n\n\n\n    // override shortcut firefox keyboard\n    $('.first_editor').keypress(function(event) {\n\n        // console.log('4');\n\n\n        // console.log('evento es: '+ event.key +'shift: '+event.ctrlKey + 'crtl: '+ event.ctrlKey);\n        var a = event.key;\n        var b = event.ctrlKey;\n        var c = event.shiftKey;\n        var d = event.altKey;\n        var response = event.key + event.ctrlKey + event.shiftKey + event.altKey;\n        //  console.log(response);\n        // console.log(b);\n        switch (true) {\n\n\n            case (a == 'F' && b && c && d):\n                var sel = editor.getSelection().getSelectedText();\n                sel = sel.replace(/\\s+/g, '+');; //replace any space with +\n                openInNewTab('https://en.wikipedia.org/w/index.php?search=' + sel);\n                // console.log(sel);\n                break;\n\n            case (a == 'F' && b && c):\n                var sel = editor.getSelection().getSelectedText();\n                sel = sel.replace(/\\s+/g, '+');; //replace any space with +\n                openInNewTab('https://www.google.com/search?q=' + sel);\n                // console.log(sel);\n                break;\n\n\n            case (a == 'H' && b && c):\n            case (a == 's' && b):\n                event.preventDefault(); //avoid other shortcut keys\n                break;\n\n                // case (a == 'L' && b  && c) : // Ctrl Shift L\n                //      event.preventDefault(); //avoid other shortcut keys\n                //     text = editor.getClipboardData(\"Text\");\n                //\n                //      console.log(text);\n                //\n                // break;\n\n\n\n\n            case (a == 'i' && b && d): //Ctrl Alt i\n                editor.execCommand('mathjax'); //widget\n                break;\n\n            case (a == 'i' && b):\n                // console.log('press ctrl I');\n                event.preventDefault(); //avoid other shortcut keys\n\n                editor.execCommand('inserthtml4x'); //widget\n                break;\n\n\n\n        }\n\n\n        // if (event.key === 'H' && event.ctrlKey && event.shiftKey  )\n        //     event.preventDefault();\n        // if (event.key === 's' && event.ctrlKey  )\n        //     event.preventDefault();\n    });\n\n\n    editor.on('paste', function(evt) {\n\n        //\n        // if ( ctrlI == 1){\n        //\n        //   // var html = editor.getClipboardData(\"Text\");\n        //   // console.log (\"paste event\" + html);\n        //   // editor.insertHtml(html);\n        //   ctrlI=0;\n        //   editor.getClipboardData( { title: 'Get my data' }, function( data ) {\n        //       if ( data )\n        //           console.log( 'data is: ' + data.dataValue );\n        //   } );\n        //\n        // }\n        //\n\n\n\n\n        // highlightjsworkers();\n    });\n\n\n    editor.on('focus', function(evt) {\n        // highlightjsworkers();\n    });\n\n    editor.on('click', function(evt) {\n\n        console.log('click');\n\n    });\n\n    editor.on('doubleclick', function(evt) {\n        var element = evt.data.element;\n        //console.log('doubleclick');\n        classe = element.getAttribute(\"class\");\n        console.log('doubleclick in class ' + classe)\n        if (classe == 'jieba'){\n\n           translate_select();\n\n\n\n        }\n        if (classe == 'videolink') {\n            loadVideo(element);\n        }\n        classe = element.getAttribute(\"class\");\n        if (classe == 'videolink') {\n            loadVideo(element);\n        }\n        var tag = element.getName();\n        // console.log(tag);\n        if (tag == 'a') {\n            url = element.getAttribute(\"href\");\n            openInNewTab(url);\n            // console.log ('click link'+ url);\n\n        }\n\n    });\n\n\n\n\n    editor.on('blur', function(evt) {\n\n        console.log(\"blurr\");\n\n        save(evt, \"save\");\n        // editor.focus();\n\n    });\n\n\n    //change event\n    editor.on('change', function(evt) {\n        // console.log( 'Total bytes: ' + evt.editor.getData().length );\n        // console.log('saved'+$( \"#tittle\" ).val());\n        // $.post( \"/inc/save.php\", { editabledata: evt.editor.getData(), editorID: $( \"#tittle\" ).val() } );\n\n    });\n\n});\n\n\nfunction openInNewTab(url) {\n    var win = window.open(url, '_blank');\n    win.focus();\n}\n\nfunction hashCode(str) {\n    var hash = 0;\n    if (str.length == 0) return hash;\n    for (i = 0; i < str.length; i++) {\n        char = str.charCodeAt(i);\n        hash = ((hash << 5) - hash) + char;\n        hash = hash & hash; // Convert to 32bit integer\n    }\n    return hash;\n}\n\n\nfunction convertCoin(value, coin, tocoin) {\n    console.log('convertCoin')\n\n    let aa = \"<span data-cost='\" + value + \"' data-coin='\" + coin + \"' data-coin-convert='\" + tocoin + \"' class='cost'>To convert \" + coin + \" into \" + tocoin + \" \" + value + \"</span>\"\n    // $('td p:has(span.cost)').addClass('middle');\n    return aa\n}\n\n\nfunction doSomething() {\n    return new Promise((resolve, reject) => {\n        console.log(\"It is done.\");\n        // Succeed half of the time.\n        if (Math.random() > .5) {\n            resolve(\"SUCCESS\")\n        } else {\n            reject(\"FAILURE\")\n        }\n    })\n}\n\nfunction fanyi(text, lang, langto) {\n    return new Promise((resolve, reject) => {\n        console.log(`It is done. ${text} ${lang} ${langto}`);\n        // Succeed half of the time.\n        // lang = 'zh'\n        // langto = 'en'\n        var url = document.location.origin +'/fanyi'\n        var headers = {\n            \"Content-Type\": \"application/json\"\n        };\n        var data = {\n            \"from\": lang,\n            \"to\": langto,\n            \"src\": text,\n            \"i\": '1'\n        };\n        console.log('this is the text to translate ' + text)\n\n        var encode_params = $.param(data, true)\n        var url = url + '?' + encode_params\n\n        $.getJSON(url, function(data) {\n\n            resolve(data)\n        });\n\n\n    })\n\n}\n\n\n\n\n\n\nfunction message(str) {\n\n    $(\"#textinfo\").html(str).css({ opacity: 0.99 });\n    $(\"#textinfo\").animate({ opacity: 0 }, 1200);\n}\n\nfunction basename(path, suffix) {\n    var b = path\n    var lastChar = b.charAt(b.length - 1)\n\n    if (lastChar === '/' || lastChar === '\\\\') {\n        b = b.slice(0, -1)\n    }\n\n    b = b.replace(/^.*[\\/\\\\]/g, '')\n\n    if (typeof suffix === 'string' && b.substr(b.length - suffix.length) === suffix) {\n        b = b.substr(0, b.length - suffix.length)\n    }\n\n    return b\n}\n\n\nfunction dirname(path) {\n    return path.replace(/\\\\/g, '/').replace(/\\/[^\\/]*\\/?$/, '')\n}\n\nfunction agregatext(selector) {\n    var texts = '';\n\n    $(\".first_editor\").children(selector).each(function() {\n\n        $(this).children(\"p\").each(function() {\n\n            texts += $(this).text() + \"\\r\\n\";\n\n        });\n\n        var allListElements = $(\"li br\");\n\n        $(\".first_editor\").find(allListElements).each(function()\n            // $(this).nextAll(\"li\").each(function()\n            {\n                texts += \"  \" + $(this).contents().get(0).nodeValue + \"\\r\\n\";\n\n            });\n\n\n\n\n\n    });\n\n\n    return texts;\n}\n\n\n\n\n\n\nfunction save(evt, action) {\n\n\n    switch (action) {\n        case \"save\": // editor save content\n            console.log(\"editor save 2\");\n            $.post(\"/inc/save.php\", { action: \"save\", data: evt.editor.getData(), path: \"/data/rw1/m1\", file: $(\"#tittle\").val() });\n            //  to prevent time consuming\n            //  read();\n            message(\"file saved\");\n\n\n\n\n            break;\n        case \"savetofile\":\n            console.log(\"save text\");\n            var file = $(\".first_editor\").children(\".path\").text();\n            console.log(file);\n            message(\"file saved \" + file);\n\n\n            // var file = \"/data/m3/mm.mm\";\n            var path = dirname(file);\n            var file = basename(file, '');\n            // var data='';\n            // $(\"#savetofile\").each(function() {\n            //    data = data  +  $(this).val();\n            //    //code\n            // });\n            data = agregatext(\".savetofile\");\n            //  data=\"test\";\n            console.log(data);\n            console.log(path);\n            console.log(file);\n\n            $.post(\"/inc/save.php\", { action: \"save\", data: data, path: path, file: file });\n\n\n            // console.log(path.basename(str, '.html'));\n\n            break;\n        default:\n\n\n            console.log(\"save default\");\n\n    }\n\n\n\n\n    //  console.log(\"hascode is is: \" + hashCode($( \"#hidden\" ).text()));\n    // console.log (\"1 \" +hashCode($( \"#hidden\" ).text()));\n    // console.log (\"2 \" +$( \"#hash\" ).text());\n\n}\n\n\nfunction read() {\n\n\n\n    $.get('/m1/' + $(\"#tittle\").val(), { \"_\": $.now() }, function(data2) {\n        console.log(\"reading file \" + '/m1/' + $(\"#tittle\").val());\n\n\n        // console.log(data);\n        //  $('#hidden').html(data2);\n        $('.first_editor').html(data2);\n\n        highlightjsworkers();\n\n\n        // $('.first_editor').html(data);\n\n    }).done(function() {\n\n\n        // if (hashCode($( \"#hidden\" ).text()) == $( \"#hash\" ).text()   )\n        // message(\"no modifiations\");\n        // else {\n        //   message (\"saved!\")\n        //   $( \"#hash\" ).html(hashCode($( \"#hidden\" ).text()));}\n        //\n    }).fail(function() {\n        //$('.first_editor').html(\"<h1>error 404 no file</h1>\"); // or whatever\n    }, 'text');\n\n}\n\nfunction highlightjsworkers() {\n\n    // hljs.initHighlightingOnLoad();\n    $('pre code').each(function(i, block) {\n        hljs.highlightBlock(block);\n    });\n\n    //  var code = document.querySelector('pre code');\n    //  var worker = new Worker('/js/worker.js');\n    //  if (!worker.onmessage) {//avoid null object in case doesnt exists\n    //  worker.onmessage = function(event) { code.innerHTML = event.data; }\n    // // worker.postMessage(code.textContent);\n    // }\n};\n\n\n//rename file\nfunction rename() {\n\n    console.log(\"change this file: \" + $(\"#tittle\").val() + \" by this file: \" + $(\"#rename\").val());\n    $.post(\"/inc/save.php\", { action: \"rename\", file: $(\"#tittle\").val(), path: \"/data/rw1/m1\", fileout: $(\"#rename\").val() }, function() {\n            $(\"#tittle\").val($(\"#rename\").val());\n        })\n        .done(function() {\n            message(\"file renamed to \" + $(\"#rename\").val());\n        })\n        .fail(function() {\n            alert(\"error\");\n        });\n\n};\n\n\n//rename file\nfunction version() {\n\n    console.log(\"creating a new version of this: \" + $(\"#tittle\").val());\n\n    $.post(\"/inc/save.php\", { action: \"version\", file: $(\"#tittle\").val(), path: \"/data/rw1/m1\", fileout: $(\"#rename\").val() }, function() {\n            $(\"#tittle\").val($(\"#rename\").val());\n        })\n        .done(function() {\n            message(\"New version backed\");\n        })\n        .fail(function() {\n            alert(\"error\");\n        });\n\n};\n\n\n\n\n\n\nfunction loadautosearch(source) {\n\n    var options = {\n        url: source,\n        getValue: \"filename\",\n        // minLength: 3,\n        //  autoFocus: true,\n        //  my : \"100 100\",\n        //  at: \"bottom\" ,\n        //  of:\"#tittle\",\n\n        template: {\n            type: \"description\",\n            fields: {\n                // description: \"email\"\n            }\n        },\n        list: {\n            match: {\n                enabled: true\n            }\n        },\n\n        theme: \"plate-dark\"\n    };\n\n    $(\"#tittle\").easyAutocomplete(options);\n\n};\n\n\n\n\nfunction loadVideo(element) {\n\n    console.log('element is videolink');\n    console.log(element.getAttribute(\"value\"));\n    src = element.getAttribute(\"value\");\n    // $('video.videoread source').attr('src', src);\n    $('#my-player_html5_api').attr('src', src);\n    $('#my-player_html5_api').load();\n    $('#my-player_html5_api').play();\n    // $(\"video.videoread\")[0].load();\n    // $(\"video.videoread\")[0].play();\n    // evt.data.dialog = 'tableProperties'   ;\n\n}\n\n\n\nfunction getParameterByName(name, url) {\n    if (!url) url = window.location.href;\n    name = name.replace(/[\\[\\]]/g, \"\\\\$&\");\n    var regex = new RegExp(\"[?&]\" + name + \"(=([^&#]*)|&|#|$)\"),\n        results = regex.exec(url);\n    if (!results) return null;\n    if (!results[2]) return '';\n    return decodeURIComponent(results[2].replace(/\\+/g, \" \"));\n}\n\n\nfunction insertBaidumap() {\n\n\n    var map = new BMap.Map(\"allmap\"); // 创建Map实例\n    map.centerAndZoom(new BMap.Point(116.404, 39.915), 11); // 初始化地图,设置中心点坐标和地图级别\n    //添加地图类型控件\n    map.addControl(new BMap.MapTypeControl({\n        mapTypes: [\n            BMAP_NORMAL_MAP,\n            BMAP_HYBRID_MAP\n        ]\n    }));\n    map.setCurrentCity(\"北京\"); // 设置地图显示的城市 此项是必须设置的\n    map.enableScrollWheelZoom(true); //开启鼠标滚轮缩放\n\n}","/*!\n * money.js / fx() v0.2\n * Copyright 2014 Open Exchange Rates\n *\n * JavaScript library for realtime currency conversion and exchange rate calculation.\n *\n * Freely distributable under the MIT license.\n * Portions of money.js are inspired by or borrowed from underscore.js\n *\n * For details, examples and documentation:\n * http://openexchangerates.github.io/money.js/\n */\n(function(root, undefined) {\n\n\t// Create a safe reference to the money.js object for use below.\n\tvar fx = function(obj) {\n\t\treturn new fxWrapper(obj);\n\t};\n\n\t// Current version.\n\tfx.version = '0.2';\n\n\n\t/* --- Setup --- */\n\n\t// fxSetup can be defined before loading money.js, to set the exchange rates and the base\n\t// (and default from/to) currencies - or the rates can be loaded in later if needed.\n\tvar fxSetup = root.fxSetup || {\n\t\trates : {},\n\t\tbase : \"\"\n\t};\n\n\t// Object containing exchange rates relative to the fx.base currency, eg { \"GBP\" : \"0.64\" }\n\tfx.rates = fxSetup.rates;\n\n\t// Default exchange rate base currency (eg \"USD\"), which all the exchange rates are relative to\n\tfx.base = fxSetup.base;\n\n\t// Default from / to currencies for conversion via fx.convert():\n\tfx.settings = {\n\t\tfrom : fxSetup.from || fx.base,\n\t\tto : fxSetup.to || fx.base\n\t};\n\n\n\t/* --- Conversion --- */\n\n\t// The base function of the library: converts a value from one currency to another\n\tvar convert = fx.convert = function(val, opts) {\n\t\t// Convert arrays recursively\n\t\tif (typeof val === 'object' && val.length) {\n\t\t\tfor (var i = 0; i< val.length; i++ ) {\n\t\t\t\tval[i] = convert(val[i], opts);\n\t\t\t}\n\t\t\treturn val;\n\t\t}\n\n\t\t// Make sure we gots some opts\n\t\topts = opts || {};\n\n\t\t// We need to know the `from` and `to` currencies\n\t\tif( !opts.from ) opts.from = fx.settings.from;\n\t\tif( !opts.to ) opts.to = fx.settings.to;\n\n\t\t// Multiple the value by the exchange rate\n\t\treturn val * getRate( opts.to, opts.from );\n\t};\n\n\t// Returns the exchange rate to `target` currency from `base` currency\n\tvar getRate = function(to, from) {\n\t\t// Save bytes in minified version\n\t\tvar rates = fx.rates;\n\n\t\t// Make sure the base rate is in the rates object:\n\t\trates[fx.base] = 1;\n\n\t\t// Throw an error if either rate isn't in the rates array\n\t\tif ( !rates[to] || !rates[from] ) throw \"fx error\";\n\n\t\t// If `from` currency === fx.base, return the basic exchange rate for the `to` currency\n\t\tif ( from === fx.base ) {\n\t\t\treturn rates[to];\n\t\t}\n\n\t\t// If `to` currency === fx.base, return the basic inverse rate of the `from` currency\n\t\tif ( to === fx.base ) {\n\t\t\treturn 1 / rates[from];\n\t\t}\n\n\t\t// Otherwise, return the `to` rate multipled by the inverse of the `from` rate to get the\n\t\t// relative exchange rate between the two currencies\n\t\treturn rates[to] * (1 / rates[from]);\n\t};\n\n\n\t/* --- OOP wrapper and chaining --- */\n\n\t// If fx(val) is called as a function, it returns a wrapped object that can be used OO-style\n\tvar fxWrapper = function(val) {\n\t\t// Experimental: parse strings to pull out currency code and value:\n\t\tif ( typeof\tval === \"string\" ) {\n\t\t\tthis._v = parseFloat(val.replace(/[^0-9-.]/g, \"\"));\n\t\t\tthis._fx = val.replace(/([^A-Za-z])/g, \"\");\n\t\t} else {\n\t\t\tthis._v = val;\n\t\t}\n\t};\n\n\t// Expose `wrapper.prototype` as `fx.prototype`\n\tvar fxProto = fx.prototype = fxWrapper.prototype;\n\n\t// fx(val).convert(opts) does the same thing as fx.convert(val, opts)\n\tfxProto.convert = function() {\n\t\tvar args = Array.prototype.slice.call(arguments);\n\t\targs.unshift(this._v);\n\t\treturn convert.apply(fx, args);\n\t};\n\n\t// fx(val).from(currency) returns a wrapped `fx` where the value has been converted from\n\t// `currency` to the `fx.base` currency. Should be followed by `.to(otherCurrency)`\n\tfxProto.from = function(currency) {\n\t\tvar wrapped = fx(convert(this._v, {from: currency, to: fx.base}));\n\t\twrapped._fx = fx.base;\n\t\treturn wrapped;\n\t};\n\n\t// fx(val).to(currency) returns the value, converted from `fx.base` to `currency`\n\tfxProto.to = function(currency) {\n\t\treturn convert(this._v, {from: this._fx ? this._fx : fx.settings.from, to: currency});\n\t};\n\n\n\t/* --- Module Definition --- */\n\n\t// Export the fx object for CommonJS. If being loaded as an AMD module, define it as such.\n\t// Otherwise, just add `fx` to the global object\n\tif (typeof exports !== 'undefined') {\n\t\tif (typeof module !== 'undefined' && module.exports) {\n\t\t\texports = module.exports = fx;\n\t\t}\n\t\texports.fx = fx;\n\t} else if (typeof define === 'function' && define.amd) {\n\t\t// Return the library as an AMD module:\n\t\tdefine([], function() {\n\t\t\treturn fx;\n\t\t});\n\t} else {\n\t\t// Use fx.noConflict to restore `fx` back to its original value before money.js loaded.\n\t\t// Returns a reference to the library's `fx` object; e.g. `var money = fx.noConflict();`\n\t\tfx.noConflict = (function(previousFx) {\n\t\t\treturn function() {\n\t\t\t\t// Reset the value of the root's `fx` variable:\n\t\t\t\troot.fx = previousFx;\n\t\t\t\t// Delete the noConflict function:\n\t\t\t\tfx.noConflict = undefined;\n\t\t\t\t// Return reference to the library to re-assign it:\n\t\t\t\treturn fx;\n\t\t\t};\n\t\t})(root.fx);\n\n\t\t// Declare `fx` on the root (global/window) object:\n\t\troot['fx'] = fx;\n\t}\n\n\t// Root will be `window` in browser or `global` on the server:\n}(this));\n"],"preExistingComment":"//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uLy4uLy4uLy4uLy4uL2hvbWUvYWdhbGFuLy5ucG0tZ2xvYmFsL2xpYi9ub2RlX21vZHVsZXMvYnJvd3NlcmlmeS9ub2RlX21vZHVsZXMvYnJvd3Nlci1wYWNrL19wcmVsdWRlLmpzIiwibWFpbi5qcyIsIm5vZGVfbW9kdWxlcy9tb25leS9tb25leS5qcyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQTtBQ0FBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUM3akNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EiLCJmaWxlIjoiZ2VuZXJhdGVkLmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXNDb250ZW50IjpbIihmdW5jdGlvbigpe2Z1bmN0aW9uIHIoZSxuLHQpe2Z1bmN0aW9uIG8oaSxmKXtpZighbltpXSl7aWYoIWVbaV0pe3ZhciBjPVwiZnVuY3Rpb25cIj09dHlwZW9mIHJlcXVpcmUmJnJlcXVpcmU7aWYoIWYmJmMpcmV0dXJuIGMoaSwhMCk7aWYodSlyZXR1cm4gdShpLCEwKTt2YXIgYT1uZXcgRXJyb3IoXCJDYW5ub3QgZmluZCBtb2R1bGUgJ1wiK2krXCInXCIpO3Rocm93IGEuY29kZT1cIk1PRFVMRV9OT1RfRk9VTkRcIixhfXZhciBwPW5baV09e2V4cG9ydHM6e319O2VbaV1bMF0uY2FsbChwLmV4cG9ydHMsZnVuY3Rpb24ocil7dmFyIG49ZVtpXVsxXVtyXTtyZXR1cm4gbyhufHxyKX0scCxwLmV4cG9ydHMscixlLG4sdCl9cmV0dXJuIG5baV0uZXhwb3J0c31mb3IodmFyIHU9XCJmdW5jdGlvblwiPT10eXBlb2YgcmVxdWlyZSYmcmVxdWlyZSxpPTA7aTx0Lmxlbmd0aDtpKyspbyh0W2ldKTtyZXR1cm4gb31yZXR1cm4gcn0pKCkiLCIvL1xuLy8gZnVuY3Rpb24gc2F2ZWludG9icm93c2VyKGZpbGVuYW1lLGh0bWwpe1xuLy9cbi8vIC8vIGZpbGVuYW1lPSQoIFwiI3RpdHRsZVwiICkudmFsKClcbi8vIC8vIGh0bWw9ZXZ0LmVkaXRvci5nZXREYXRhKClcbi8vIC8vIGxhY2sgb2Ygc3luYyBpbnRvIHRoZSBzZXJ2ZXJcbi8vICAgdmFyIGRiID0gbmV3IERleGllKFwibTEzXCIpO1xuLy8gICBkYi52ZXJzaW9uKDEpLnN0b3Jlcyh7XG4vLyAgICAgZmlsZXM6IFwiZmlsZW5hbWUsaHRtbFwiXG4vLyAgIH0pO1xuLy9cbi8vICAgZGIub3BlbigpLmNhdGNoKGZ1bmN0aW9uIChlKSB7XG4vLyAgICAgIGFsZXJ0IChcIk9wZW4gZmFpbGVkOiBcIiArIGUpO30pO1xuLy9cbi8vXG4vLyAgIGRiLnRyYW5zYWN0aW9uKFwicndcIiwgZGIuZmlsZXMsIGZ1bmN0aW9uICgpIHtcbi8vICAgICAgIC8vIFVwZGF0ZSB0aGUgcmVnaXN0ZXIgaWYgZXhpc3RzIGlmIG5vdCBhZGRcbi8vICAgICAgZGIuZmlsZXMud2hlcmUoXCJmaWxlbmFtZVwiKS5lcXVhbHMoZmlsZW5hbWUpLm1vZGlmeSh7aHRtbDogaHRtbH0pLnRoZW4oZnVuY3Rpb24odXBkYXRlZClcbi8vICAgICAge1xuLy8gICAgICAgIGlmICh1cGRhdGVkKVxuLy8gICAgICAgICAgICBjb25zb2xlLmxvZyAoXCJwZWRybyBmb3VuZCBhbmQgdXBkYXRlXCIpO1xuLy8gICAgICAgIGVsc2Vcbi8vICAgICAgICB7XG4vLyAgICAgICAgY29uc29sZS5sb2cgKFwicGVkcm8gbm90IGZvdW5kIFwiKTtcbi8vICAgICAgICBkYi5maWxlcy5hZGQoe2ZpbGVuYW1lOiAkKCBcIiN0aXR0bGVcIiApLnZhbCgpLCBodG1sOiAgZXZ0LmVkaXRvci5nZXREYXRhKCl9KTt9IH0pOyAgIH0pO1xuLy9cbi8vIH07XG5cblxudmFyIGN0cmxJID0gZmFsc2U7XG52YXIgZnggPSByZXF1aXJlKCdtb25leScpO1xuLy8gcmVxdWlyZSgnY2tlZGl0b3InKTtcbi8vIENLRURJVE9SLnJlcGxhY2UoICdlZGl0b3InICk7XG5cblxuLy8gQWRkIGFuIGV2ZW50IGxpc3RlbmVyXG5kb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKFwibmFtZS1vZi1ldmVudFwiLCBmdW5jdGlvbihlKSB7XG4gICAgLy8gY29uc29sZS5sb2coZS5kZXRhaWwpOyAvLyBQcmludHMgXCJFeGFtcGxlIG9mIGFuIGV2ZW50XCJcbn0pO1xuXG5cbi8vICQoXCIudmlkZW9saW5rXCIpLmNsaWNrKGZ1bmN0aW9uKCl7XG5cbi8vICAgICB2YXIgc3JjID0gJCh0aGlzKS5hdHRyKFwidmFsdWVcIik7XG4vLyAgICAvLyBhbGVydChzcmMpO1xuLy8gLy8gY29uc29sZS5sb2coZXZ0KTtcbi8vIC8vIGNvbnNvbGUubG9nKCQodGhpcykpO1xuLy8gLy8gY29uc29sZS5sb2coXCJjbGlja2VkIHZpZGVvbGluayBpbiBja2VkaXRvclwiKTtcbi8vIGxvYWRWaWRlbyhzcmMpO1xuXG5cbi8vIH0pXG5cbi8vIGZ1bmN0aW9uIGxvYWRWaWRlbzIoKXtcblxuLy8gICAgIGNvbnNvbGUubG9nKCdjbGlja2VkIGxvYWRWaWRlbzInKTtcbi8vIH1cblxuXG4kKGRvY3VtZW50KS5yZWFkeShmdW5jdGlvbigpIHtcblxuICAgIC8vIHZhciBiMSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwiTVdcIik7XG4gICAgLy8gYjEudGFiSW5kZXggPSA1OyAvL2NoYW5nZSB0aGUgZGVmYXVsdCB0YWJpbmRleFxuXG5cblxuICAgICQoJy5qaWViYScpLm9uKCdjbGljayB0b3VjaHN0YXJ0JywgZnVuY3Rpb24oKSB7XG4gICAgICAgLy8gY29uc29sZS5sb2coJ2hlbGxvJylcblxuICAgICAgICAgXG4gICAgLy8gdGV4dD1cIuWxleekuueahOaXtuWAmVwiXG4gICAgdGV4dD0kKHRoaXMpLnRleHQoKVxuXG4gICAgICAgICAgIGNvbnNvbGUubG9nKHRleHQpXG4gICAgICAgIGxhbmcgPSAnemgnXG4gICAgICAgIGxhbmd0byA9ICdlbidcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKCdkb2luZyB0cmFuc2xhdGlvbicpXG5cbiAgICAgICAgZmFueWkodGV4dCwgbGFuZywgbGFuZ3RvKS50aGVuKGZ1bmN0aW9uKGFhKSB7XG4gICAgICAgICAgICBjb25zb2xlLmxvZyhhYS5zcmMpXG4gICAgICAgICAgICBhYS5kc3QgPSBhYS5waW55aW4gKyBcIjxicj5cIiArIGFhLnRyYW5zbGF0ZSArIGFhLmhhbmRpXG4gICAgICAgICAgICB2YXIgdHJhZCA9ICc8ZGl2IGNsYXNzPVwiYXVkaW9mYW55aVwiPicgKyBhYS5hdWRpbyArICc8L2Rpdj4nICthYS5zcmMgKyAnOiA8L2JyPiAnICsgYWEuZHN0IDtcbiAgICAgICAgICAgICQoJyNmYW55aTU1JykuaHRtbCh0cmFkKVxuICAgICAgICB9KTtcblxuICAgIH0pOyBcblxuXG5cblxuICAgIHZhciB1cmwgPSBnZXRQYXJhbWV0ZXJCeU5hbWUoJ3VybCcpO1xuICAgIGlmICh1cmwpIHtcblxuICAgICAgICAvLyBjb25zb2xlLmxvZyh1cmwpO1xuXG4gICAgICAgICQoXCIjdGl0dGxlXCIpLnZhbCh1cmwpO1xuICAgICAgICAkKFwiI3JlbmFtZVwiKS52YWwodXJsKTtcbiAgICAgICAgLy8gIHJlYWQoKTtcbiAgICAgICAgLy8kKFwiLmZpcnN0X2VkaXRvclwiKS5mb2N1cygpO1xuICAgICAgICAvLyAkKFwiI3RpdHRsZVwiKS5mb2N1cygpLnNlbGVjdCgpO1xuICAgIH0gZWxzZSB7XG4gICAgICAgICQoXCIjdGl0dGxlXCIpLmZvY3VzKCkuc2VsZWN0KCk7XG4gICAgfVxuXG5cbiAgICAvLyBsb2FkYXV0b3NlYXJjaChcIi9yZXNvdXJjZXMvZmlsZXMyLmpzb25cIik7XG5cblxuICAgIC8vICQoIFwiLmZpcnN0X2VkaXRvciBoM1wiICkuY2xpY2soZnVuY3Rpb24oKSB7XG4gICAgLy8gICBhbGVydCgnY2xpY2tlZCcpO1xuICAgIC8vICAgJCh0aGlzKS5uZXh0VW50aWwoIFwiLmZpcnN0X2VkaXRvciBoMywgLmZpcnN0X2VkaXRvciBoMlwiICkudG9nZ2xlKCk7XG4gICAgLy8gfSk7XG4gICAgLy8gJCggXCIuZmlyc3RfZWRpdG9yIGg0XCIgKS5jbGljayhmdW5jdGlvbigpIHtcbiAgICAvLyAgICQodGhpcykubmV4dFVudGlsKCBcIi5maXJzdF9lZGl0b3IgaDQsIC5maXJzdF9lZGl0b3IgaDMgXCIgKS50b2dnbGUoKTtcbiAgICAvLyB9KTtcbiAgICAvL1xuICAgIC8vICQoIFwiaDJcIiApLmNsaWNrKGZ1bmN0aW9uKCkge1xuICAgIC8vICAgJCh0aGlzKS5uZXh0KCBcImgyLCBoMVwiICkudG9nZ2xlKCk7XG4gICAgLy8gfSk7XG4gICAgLy9cbiAgICAvLyAkKCBcImgxXCIgKS5jbGljayhmdW5jdGlvbigpIHtcbiAgICAvLyAgICQodGhpcykubmV4dCggXCJoMVwiICkudG9nZ2xlKCk7XG4gICAgLy8gfSk7XG5cblxuXG5cblxud2luZG93LmFkZEV2ZW50TGlzdGVuZXIoXCJrZXlkb3duXCIsIGZ1bmN0aW9uIChldmVudCkge1xuICBpZiAoZXZlbnQuZGVmYXVsdFByZXZlbnRlZCkge1xuICAgIHJldHVybjsgLy8gRG8gbm90aGluZyBpZiB0aGUgZXZlbnQgd2FzIGFscmVhZHkgcHJvY2Vzc2VkXG4gIH1cblxuICBzd2l0Y2ggKGV2ZW50LmtleSkge1xuICAgIGNhc2UgXCJBcnJvd0Rvd25cIjpcbiAgICAgIC8vIERvIHNvbWV0aGluZyBmb3IgXCJkb3duIGFycm93XCIga2V5IHByZXNzLlxuICAgICAgYnJlYWs7XG4gICAgY2FzZSBcIkFycm93VXBcIjpcbiAgICAgIC8vIERvIHNvbWV0aGluZyBmb3IgXCJ1cCBhcnJvd1wiIGtleSBwcmVzcy5cbiAgICAgIGJyZWFrO1xuICAgIGNhc2UgXCJBcnJvd0xlZnRcIjpcbiAgICAgIC8vIERvIHNvbWV0aGluZyBmb3IgXCJsZWZ0IGFycm93XCIga2V5IHByZXNzLlxuICAgICAgYnJlYWs7XG4gICAgY2FzZSBcIkFycm93UmlnaHRcIjpcbiAgICAgIC8vIERvIHNvbWV0aGluZyBmb3IgXCJyaWdodCBhcnJvd1wiIGtleSBwcmVzcy5cbiAgICAgIGJyZWFrO1xuICAgIGNhc2UgXCJFbnRlclwiOlxuICAgICAgLy8gRG8gc29tZXRoaW5nIGZvciBcImVudGVyXCIgb3IgXCJyZXR1cm5cIiBrZXkgcHJlc3MuXG4gICAgICBicmVhaztcbiAgICBjYXNlIFwiRXNjYXBlXCI6XG4gICAgICAvLyBEbyBzb21ldGhpbmcgZm9yIFwiZXNjXCIga2V5IHByZXNzLlxuICAgICAgY29uc29sZS5sb2coJ3ByZXNzIGVzY2FwZScpXG4gICAgICAgICAgICAgdHJhbnNsYXRlX3NlbGVjdCgpO1xuICAgICAgYnJlYWs7XG4gICAgZGVmYXVsdDpcbiAgICAgIHJldHVybjsgLy8gUXVpdCB3aGVuIHRoaXMgZG9lc24ndCBoYW5kbGUgdGhlIGtleSBldmVudC5cbiAgfVxuXG4gIC8vIENhbmNlbCB0aGUgZGVmYXVsdCBhY3Rpb24gdG8gYXZvaWQgaXQgYmVpbmcgaGFuZGxlZCB0d2ljZVxuICBldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xufSwgdHJ1ZSk7XG5cblxuZnVuY3Rpb24gdHJhbnNsYXRlX3NlbGVjdCgpe1xuXG5cbiAgICAgICAgdGV4dCA9IHdpbmRvdy5nZXRTZWxlY3Rpb24oKS50b1N0cmluZygpXG4gICAgICAgICAgICAgICAgY29uc29sZS5sb2codGV4dClcbiAgICAgICAgbGFuZyA9ICd6aCdcbiAgICAgICAgbGFuZ3RvID0gJ2VuJ1xuICAgICAgICAgICAgY29uc29sZS5sb2coJ2RvaW5nIHRyYW5zbGF0aW9uJylcblxuICAgICAgICBmYW55aSh0ZXh0LCBsYW5nLCBsYW5ndG8pLnRoZW4oZnVuY3Rpb24oYWEpIHtcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKGFhLnNyYylcbiAgICAgICAgICAgIGFhLmRzdCA9IGFhLnBpbnlpbiArIFwiPGJyPlwiICsgYWEudHJhbnNsYXRlICsgYWEuaGFuZGlcbiAgICAgICAgICAgIHZhciB0cmFkID0gJzxkaXYgY2xhc3M9XCJhdWRpb2ZhbnlpXCI+JyArIGFhLmF1ZGlvICsgJzwvZGl2PicgK2FhLnNyYyArICc6IDwvYnI+ICcgKyBhYS5kc3QgO1xuICAgICAgICAgICAgJCgnI2ZhbnlpNTUnKS5odG1sKHRyYWQpXG4gICAgICAgIH0pO1xuXG59XG5cblxuICAgICQoXCIuamllYmFcIikuZGJsY2xpY2soZnVuY3Rpb24oKSB7XG4gIFxuXG50cmFuc2xhdGVfc2VsZWN0KClcblxuXG4gICAgfSlcblxuXG5cblxuXG5cblxuXG4gICAgJChcImJ1dHRvbiNwdXR0b2dldGhlclwiKS5jbGljayhmdW5jdGlvbigpIHtcbiAgICAgICAgc2VsID0gZWRpdG9yLmV4dHJhY3RTZWxlY3RlZEh0bWwoKVxuICAgICAgICBhYSA9IHNlbC5nZXRIdG1sKCkucmVwbGFjZSgvPGJyPi9nbSwgJycpXG4gICAgICAgIGVkaXRvci5pbnNlcnRIdG1sKGFhKTtcbiAgICB9KVxuXG4gICAgJChcImJ1dHRvbiNhdXRvdHJhbnNcIikuY2xpY2soZnVuY3Rpb24oKSB7XG4gICAgICAgICQoXCJzcGFuW2xhbmc9J3poLWNuJ11cIikuY3NzKCdjb2xvcicsICdyZWQnKVxuICAgICAgICBsZXQgbGFuZyA9ICd6aCdcbiAgICAgICAgbGV0IGxhbmd0byA9ICdlbidcbiAgICAgICAgbGV0IGJiID0gJChcInNwYW5bbGFuZz0nemgtY24nXTplcSgxKVwiKS50ZXh0KClcbiAgICAgICAgY29uc29sZS5sb2coYHRvIHRyYW5zbGF0ZTogJHtiYn1gKVxuICAgICAgICBmYW55aShiYiwgJ3poJywgJ2VuJykudGhlbihmdW5jdGlvbihhYSkge1xuICAgICAgICAgICAgbGV0IHRyYW5zbGF0aW9uID0gXCI8c3BhbiBjbGFzcz0nb3JpZ2luYWwnIGxhbmc9J1wiICsgbGFuZyArIFwiJyBkYXRhLXBzZXVkby1jb250ZW50PSdcIiArIGFhLnNyYyArIFwiJyA+Jm5ic3A7PC9zcGFuPjxzcGFuIGNsYXNzPSd0cmFuc2xhdGUnICBsYW5nPSdcIiArIGxhbmd0byArIFwiJyA+XCIgKyBhYS50cmFuc2xhdGUgKyBcIjwvc3Bhbj5cIlxuICAgICAgICAgICAgY29uc29sZS5sb2coYWEuaSlcbiAgICAgICAgICAgICQoXCJzcGFuW2xhbmc9J3poLWNuJ106ZXEoMSlcIikuaHRtbCh0cmFuc2xhdGlvbilcbiAgICAgICAgICAgICQoXCJzcGFuW2xhbmc9J3poLWNuJ106ZXEoMSlcIikuYXR0cignbGFuZycsICcnKVxuICAgICAgICB9KVxuXG4gICAgfSlcblxuXG5cbiAgICAkKFwiYnV0dG9uI3Bvc2l0aW9uXCIpLmNsaWNrKGZ1bmN0aW9uKCkge1xuICAgICAgICBjb25zb2xlLmxvZygnY2xpY2tlZCBzYXZlIHBvc2l0aW9uJylcbiAgICAgICAgJChcIiNzY3JvbGxBcmVhXCIpLnNjcm9sbFRvcCgpXG5cblxuICAgIH0pO1xuXG4gICAgJChcImJ1dHRvbiN0cmFuc1wiKS5jbGljayhmdW5jdGlvbigpIHtcbiAgICAgICAgY29uc29sZS5sb2coJ2NsaWNrZWQgdHJhbnNsYXRlJylcbiAgICAgICAgJChcIi50cmFuc2xhdGVcIikuc2hvdygpO1xuICAgICAgICAkKFwiLm9yaWdpbmFsXCIpLmhpZGUoKTtcblxuXG4gICAgfSk7XG5cbiAgICAkKFwiYnV0dG9uI3Nob3d0cmFuc2xhdGVcIikuY2xpY2soZnVuY3Rpb24oKSB7XG4gICAgICAgIGNvbnNvbGUubG9nKCdjbGlja2VkIHNob3d0cmFuc2xhdGUnKVxuICAgICAgICAkKFwiLnRyYW5zbGF0ZVwiKS5zaG93KCk7XG4gICAgICAgICQoXCIub3JpZ2luYWxcIikuc2hvdygpO1xuXG4gICAgfSk7XG5cblxuICAgICQoXCJidXR0b24jYWRkYWJzb2x1dGVwYXRoXCIpLmNsaWNrKGZ1bmN0aW9uKCkge1xuXG4gICAgICAgIGNvbnNvbGUubG9nKCdjbGlja2VkIGFkZGFic29sdXRlcGF0aDInKVxuXG5cbiAgICAgICAgJCgnaW1nJykuZWFjaChmdW5jdGlvbihpLCB2KSB7XG4gICAgICAgICAgICBpZiAoJCh0aGlzKS5hdHRyKCdzcmMnKS5pbmNsdWRlcyhcImh0dHBcIikpIHtcbiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZygnbm90IGNoYW5nZScpXG5cbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgdmFyIGFhYSA9IGRvY3VtZW50LmxvY2F0aW9uLm9yaWdpbiArICQodGhpcykuYXR0cignc3JjJyk7XG4gICAgICAgICAgICAgICAgJCh0aGlzKS5hdHRyKCdzcmMnLCBhYWEpO1xuICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKCQodGhpcykuYXR0cignc3JjJykpXG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuXG4gICAgfSk7XG5cbiAgICAkKFwiYnV0dG9uI3NoYXJlbGlua1wiKS5jbGljayhmdW5jdGlvbigpIHtcblxuXG4gICAgICAgIGNvbnNvbGUubG9nKCdjbGlja2VkIHNoYXJlbGluayAnKVxuICAgICAgICBjb25zb2xlLmxvZyhkb2N1bWVudC5sb2NhdGlvbi5vcmlnaW4gK1wiL2VicmFpbj91cmw9XCIgKyAkKCcjdGl0dGxlJykudmFsKCkpXG5cbiAgICAgICAgJC5nZXRKU09OKCdlYnJhaW4/dXJsPScgKyAkKCcjdGl0dGxlJykudmFsKCksXG4gICAgICAgICAgICBmdW5jdGlvbihkYXRhKSB7XG5cbiAgICAgICAgICAgICAgICAkKCcjc2hhcmVsaW5rJykuYXR0cignaHJlZicsIGRvY3VtZW50LmxvY2F0aW9uLm9yaWdpbiArJy92aWV3LnBocD91cmw9JyArIGRhdGEuaGFzaClcblxuICAgICAgICAgICAgfSlcblxuXG4gICAgfSk7XG5cbiAgICAkKFwiYnV0dG9uI3VwZGF0ZWNvc3RcIikuY2xpY2soZnVuY3Rpb24oKSB7XG4gICAgICAgIGNvbnNvbGUubG9nKCdjbGlja2VkIHVwZGF0ZWRjb3N0ICcpXG5cbiAgICAgICAgJC5nZXRKU09OKFxuICAgICAgICAgICAgLy8gTkI6IHVzaW5nIE9wZW4gRXhjaGFuZ2UgUmF0ZXMgaGVyZSwgYnV0IHlvdSBjYW4gdXNlIGFueSBzb3VyY2UhXG4gICAgICAgICAgICAnaHR0cHM6Ly9vcGVuZXhjaGFuZ2VyYXRlcy5vcmcvYXBpL2xhdGVzdC5qc29uP2FwcF9pZD05NjBmMGI4ZGNhOTM0NDMyOGIxM2VmODE2OTU3ZDgxMCcsXG4gICAgICAgICAgICBmdW5jdGlvbihkYXRhKSB7XG4gICAgICAgICAgICAgICAgLy8gQ2hlY2sgbW9uZXkuanMgaGFzIGZpbmlzaGVkIGxvYWRpbmc6XG4gICAgICAgICAgICAgICAgaWYgKHR5cGVvZiBmeCAhPT0gXCJ1bmRlZmluZWRcIiAmJiBmeC5yYXRlcykge1xuICAgICAgICAgICAgICAgICAgICBmeC5yYXRlcyA9IGRhdGEucmF0ZXM7XG4gICAgICAgICAgICAgICAgICAgIGZ4LmJhc2UgPSBkYXRhLmJhc2U7XG5cblxuICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZygndXBkYXRpbmcgY29zdC4uLicpXG5cbiAgICAgICAgICAgICAgICAgICAgJCgnLmNvc3QnKS5lYWNoKGZ1bmN0aW9uKGksIHYpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGFhID0gJCh0aGlzKS5hdHRyKCdkYXRhLWNvc3QnKVxuICAgICAgICAgICAgICAgICAgICAgICAgdG90YWwgPSBNYXRoLnJvdW5kKGZ4KGFhKS5mcm9tKFwiQ05ZXCIpLnRvKFwiRVVSXCIpIC8gMC4wMDk1KSAvIDEwMDtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKFwiY29udmVydGluZyBDTlkgaW50byBFVVJcIiArIGZ4KDEpLmZyb20oXCJDTllcIikudG8oXCJFVVJcIikpO1xuICAgICAgICAgICAgICAgICAgICAgICAgJCh0aGlzKS50ZXh0KHRvdGFsKVxuICAgICAgICAgICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIC8vIElmIG5vdCwgYXBwbHkgIHRvIGZ4U2V0dXAgZ2xvYmFsOlxuICAgICAgICAgICAgICAgICAgICB2YXIgZnhTZXR1cCA9IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJhdGVzOiBkYXRhLnJhdGVzLFxuICAgICAgICAgICAgICAgICAgICAgICAgYmFzZTogZGF0YS5iYXNlXG4gICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB2YXIgZCA9IG5ldyBEYXRlKCk7XG4gICAgICAgICAgICAgICAgdmFyIGRhdGV0aW1lID0gZC5nZXRGdWxsWWVhcigpICsgJy0nICsgZC5nZXRNb250aCgpICsgJy0nICsgZC5nZXREYXRlKCk7XG4gICAgICAgICAgICAgICAgZWRpdG9yLmluc2VydEh0bWwoXCI8c3BhbiBjbGFzcz0naW5mb3JtYXRpb24nPiBkYXRlOiBcIiArIGRhdGV0aW1lICsgXCIgQ05ZIHRvIEVVUiBDb252ZXJ0IHJhdGUgaXMgIFwiICsgZngoMSkuZnJvbShcIkNOWVwiKS50byhcIkVVUlwiKSArIFwiPC9zcGFuPlwiKVxuICAgICAgICAgICAgfVxuICAgICAgICApO1xuXG5cblxuXG5cblxuICAgIH0pO1xuICAgIC8vIGh0dHBzOi8vb3BlbmV4Y2hhbmdlcmF0ZXMuZ2l0aHViLmlvL21vbmV5LmpzLyNkb3dubG9hZFxuXG5cbiAgICAkKFwiI3RpdHRsZVwiKS5mb2N1c291dChmdW5jdGlvbigpIHtcbiAgICAgICAgLy8gY29uc29sZS5sb2coJzEnKTtcblxuICAgICAgICBjb25zb2xlLmxvZygkKFwiI3RpdHRsZVwiKS52YWwoKSk7XG4gICAgICAgICQoXCIjcmVuYW1lXCIpLnZhbCgkKFwiI3RpdHRsZVwiKS52YWwoKSk7XG4gICAgICAgICQoJy5maXJzdF9lZGl0b3InKS5hdHRyKCdpZCcsICQoXCIjdGl0dGxlXCIpLnZhbCgpKTtcbiAgICAgICAgJCgnLmZpcnN0X2VkaXRvcicpLmF0dHIoXCJjb250ZW50ZWRpdGFibGVcIiwgXCJ0cnVlXCIpO1xuICAgICAgICAkKCcuZmlyc3RfZWRpdG9yJykuZm9jdXMoKTtcbiAgICAgICAgcmVhZCgpO1xuICAgICAgICAvLyBlZGl0b3Iuc2V0RGF0YSgkKCBcIiNoaWRkZW5cIiApLmh0bWwoKSk7ICAvLyBsb2FkIGRhdGEgaW4gdGhlIGVkaXRvclxuXG4gICAgICAgIC8vIGhsanMuaW5pdEhpZ2hsaWdodGluZ09uTG9hZCgpO1xuXG4gICAgfSk7XG5cblxuXG5cbiAgICAkKFwiI3JlbmFtZVwiKS5mb2N1c291dChmdW5jdGlvbigpIHtcbiAgICAgICAgLy8gY29uc29sZS5sb2coJzInKTtcblxuICAgICAgICBpZiAoJChcIiN0aXR0bGVcIikudmFsKCkgPT0gJChcIiNyZW5hbWVcIikudmFsKCkpXG5cbiAgICAgICAgICAgIC8vIGVkaXRvci5zZXREYXRhKCQoIFwiI2hpZGRlblwiICkuaHRtbCgpKTsgIC8vIGxvYWQgZGF0YSBpbiB0aGUgZWRpdG9yXG4gICAgICAgICAgICByZWFkKCk7XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgcmVuYW1lKCk7XG4gICAgICAgIH1cblxuXG4gICAgfSk7XG5cblxuXG5cblxuICAgIENLRURJVE9SLmluc3RhbmNlc1snaW50cm9kdWN0aW9uJ10uZGVzdHJveSgpO1xuICAgIHZhciBlZGl0b3IgPSBDS0VESVRPUi5pbmxpbmUoXCJpbnRyb2R1Y3Rpb25cIik7XG5cblxuXG5cbiAgICBkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKCdwYXN0ZScsIGZ1bmN0aW9uKGUpIHtcbiAgICAgICAgLy8gICAgdmFyIGh0bWwgPSBlLmNsaXBib2FyZERhdGEuZ2V0RGF0YSAoXCJUZXh0XCIpO1xuICAgICAgICAvLyBlLnByZXZlbnREZWZhdWx0KCk7XG4gICAgICAgIC8vICAgICAgaWYgKCBjdHJsSSApe1xuICAgICAgICAvLyAgICAgICAgLy8gQ0tFRElUT1IuaW5zdGFuY2VzWydpbnRyb2R1Y3Rpb24nXS5kZXN0cm95KCk7XG4gICAgICAgIC8vICAgICAgICAvL1xuICAgICAgICAvLyAgICAgICAgLy8gICAgdmFyIGVkaXRvciA9IENLRURJVE9SLmlubGluZShcImludHJvZHVjdGlvblwiKTtcbiAgICAgICAgLy9cbiAgICAgICAgLy8gICAgICAgIGNvbnNvbGUubG9nIChcInBhc3RlIGV2ZW50XCIpO1xuICAgICAgICAvLyAgICAgICAgLy8gZWRpdG9yLmluc2VydEh0bWwoaHRtbCk7XG4gICAgICAgIC8vICAgICAgfVxuICAgICAgICAvLyAgICAvLyB2YXIgaHRtbCA9IGUuY2xpcGJvYXJkRGF0YS5nZXREYXRhKCd0ZXh0L2h0bWwnKTtcbiAgICAgICAgLy8gICAgY29uc29sZS5sb2coaHRtbCk7XG4gICAgICAgIC8vICAgIC8vIFdoYXRldmVyIHlvdSB3YW50IHRvIGRvIHdpdGggdGhlIGh0bWxcbiAgICB9KTtcblxuXG4gICAgZWRpdG9yLm9uKCdwYXN0ZScsIGZ1bmN0aW9uKGV2dCkge1xuICAgICAgICBldnQuc3RvcCgpO1xuICAgICAgICB2YXIgZGF0YSA9IGV2dC5kYXRhLmRhdGFWYWx1ZTtcblxuICAgICAgICBpZiAod2luZG93LmNocm9tZSB8fCB3aW5kb3cuc2FmYXJpKSB7XG4gICAgICAgICAgICAvLyByZW1vdmluZyBzcGFuIHdyYXBwZXIgb24gd2Via2l0IGJyb3dzZXJzLlxuICAgICAgICAgICAgZGF0YSA9ICQoZGF0YSkuaHRtbCgpO1xuICAgICAgICB9XG4gICAgICAgIGV2dC5lZGl0b3IuaW5zZXJ0SHRtbChkYXRhKTtcbiAgICB9KTtcblxuXG5cbiAgICBlZGl0b3Iub24oJ2tleScsIGZ1bmN0aW9uKGV2dCkge1xuICAgICAgICAvLyBjb25zb2xlLmxvZygnMycpO1xuICAgICAgICAvL2h0dHA6Ly9zdGFja292ZXJmbG93LmNvbS9xdWVzdGlvbnMvNDQwMTQ2OS9ob3ctdG8tc2VsZWN0LWEtdGV4dC1yYW5nZS1pbi1ja2VkaXRvci1wcm9ncmFtYXRpY2FsbHlcblxuICAgICAgICB2YXIgY2hhckNvZGUgPSBldnQuZGF0YS5rZXlDb2RlOyAvLyBhdCB0aGUgbW9tZW50IHRoaXMgaXMgd3JvbmcsIGtleUNvZGUgbmVlZHMgdG8gYmUgcHJvcGVybHkgY29udmVydGVkIHRvIGNoYXJDb2RlXG4gICAgICAgIC8vIHZhciBjbGlwYm9hcmREYXRhID0gZXZ0LmRhdGEuZGF0YVZhbHVlO1xuICAgICAgICBjb25zb2xlLmxvZyhjaGFyQ29kZSk7XG4gICAgICAgIHZhciB0YWcgPSBcImgxXCI7XG4gICAgICAgIC8vICBjb25zb2xlLmxvZyhzZWxlY3RlZFRleHQpO1xuICAgICAgICBzd2l0Y2ggKGNoYXJDb2RlKSB7XG4gICAgICAgICAgICBjYXNlIDExMTQxNjE6IC8vIEN0cmwgMVxuICAgICAgICAgICAgICAgIHRhZyA9IFwiPGgxPjwvaDE+XCI7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICBjYXNlIDExMTQxNjI6IC8vIEN0cmwgMlxuICAgICAgICAgICAgICAgIHRhZyA9IFwiPGgyPjwvaDI+XCI7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICBjYXNlIDExMTQxNjM6IC8vIEN0cmwgM1xuICAgICAgICAgICAgICAgIHRhZyA9IFwiPGgzPjwvaDM+XCI7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICBjYXNlIDExMTQxNjQ6IC8vIEN0cmwgNFxuICAgICAgICAgICAgICAgIHRhZyA9IFwiPGg0PjwvaDQ+XCI7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICBjYXNlIDExMTQxNjY6IC8vIEN0cmwgNlxuICAgICAgICAgICAgICAgIHRhZyA9IFwiPGg1PjwvaDU+XCI7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICBjYXNlIDExMTQxNjk6IC8vIEN0cmwgNlxuICAgICAgICAgICAgICAgIGVkaXRvci5pbnNlcnRIdG1sKFwiPGRpdiBjbGFzcz0nc2F2ZXRvZmlsZSc+cHV0IHRleHQ8L2Rpdj5cIik7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG5cbiAgICAgICAgICAgIGNhc2UgMTExNDMwMDogLy8gQ3RybCAsXG4gICAgICAgICAgICAgICAgY29uc29sZS5sb2coJ2NvbnZlcnQgQ29pbicpO1xuXG4gICAgICAgICAgICAgICAgc2VsID0gZWRpdG9yLmdldFNlbGVjdGlvbigpLmdldFNlbGVjdGVkVGV4dCgpXG4gICAgICAgICAgICAgICAgY29uc29sZS5sb2coc2VsKVxuXG4gICAgICAgICAgICAgICAgZWRpdG9yLmluc2VydEh0bWwoY29udmVydENvaW4oc2VsLCBcInl1YW5cIiwgXCJldXJvXCIpKVxuICAgICAgICAgICAgICAgICQoJ3A6aGFzKHNwYW4uY29zdCknKS5hZGRDbGFzcygnbWlkZGxlJyk7XG5cbiAgICAgICAgICAgICAgICBicmVhaztcblxuXG4gICAgICAgICAgICBjYXNlIDExMTQzMDQ6IC8vIEN0cmwgYFxuICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKCdyZXF1ZXN0IGZhbnlpJyk7XG4gICAgICAgICAgICAgICAgbGV0IGxhbmcgPSAkKFwiI2xhbmdcIikudmFsKCksXG4gICAgICAgICAgICAgICAgICAgIGxhbmd0byA9ICQoXCIjbGFuZ3RvXCIpLnZhbCgpXG5cblxuXG4gICAgICAgICAgICAgICAgc2VsID0gZWRpdG9yLmdldFNlbGVjdGlvbigpLmdldFNlbGVjdGVkVGV4dCgpLnJlcGxhY2UoLyhcXHJcXG5cXHR8XFxufFxcclxcdCkvZ20sIFwiXCIpO1xuICAgICAgICAgICAgICAgIGlmIChzZWwubGVuZ3RoID4gMCkge1xuICAgICAgICAgICAgICAgICAgICBmYW55aShzZWwsIGxhbmcsIGxhbmd0bykudGhlbihmdW5jdGlvbihhYSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgbGV0IHRyYW5zbGF0aW9uID0gXCI8c3BhbiBjbGFzcz0nb3JpZ2luYWwnIGxhbmc9J1wiICsgbGFuZyArIFwiJyBkYXRhLXBzZXVkby1jb250ZW50PSdcIiArIGFhLnNyYyArIFwiJyA+Jm5ic3A7PC9zcGFuPjxzcGFuIGNsYXNzPSd0cmFuc2xhdGUnICBsYW5nPSdcIiArIGxhbmd0byArIFwiJyA+XCIgKyBhYS50cmFuc2xhdGUgKyBcIjwvc3Bhbj5cIlxuICAgICAgICAgICAgICAgICAgICAgICAgZWRpdG9yLmluc2VydEh0bWwodHJhbnNsYXRpb24pO1xuICAgICAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAgIH1cblxuXG5cbiAgICAgICAgICAgICAgICBicmVhaztcblxuXG5cblxuICAgICAgICAgICAgY2FzZSA1NTcwNjM4OiAvLyBDdHJsIEFsdCBOXG4gICAgICAgICAgICAgICAgLy8gdGFnPVwiPGI+PC9iPlwiO1xuICAgICAgICAgICAgICAgIHRhZyA9IFwiPGVtPjwvZW0+XCI7IC8vZW1waGFzaXNcbiAgICAgICAgICAgICAgICBicmVhaztcblxuICAgICAgICAgICAgY2FzZSA1NTcwNjM3OiAvLyBDdHJsIEFsdCBNXG4gICAgICAgICAgICAgICAgdGFnID0gXCI8bWFyaz48L21hcms+XCI7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICBjYXNlIDU1NzA2Mjg6IC8vIEN0cmwgQWx0IERcbiAgICAgICAgICAgICAgICB2YXIgZCA9IG5ldyBEYXRlKCk7XG4gICAgICAgICAgICAgICAgdmFyIGRhdGV0aW1lID0gZC5nZXRGdWxsWWVhcigpICsgJy0nICsgZC5nZXRNb250aCgpICsgJy0nICsgZC5nZXREYXRlKCk7XG4gICAgICAgICAgICAgICAgdGFnID0gXCI8ZGVsIGRhdGV0aW1lPVwiICsgZGF0ZXRpbWUgKyBcIiB0aXRsZT1cIiArIGRhdGV0aW1lICsgXCI+PC9kaXY+XCI7IC8vZGVsIHRleHRcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIGNhc2UgNTU3MDYzMzogLy8gQ3RybCBBbHQgSVxuICAgICAgICAgICAgICAgIHRhZyA9IFwiPGVtPjwvZW0+XCI7IC8vZW1waGFzaXNcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIGNhc2UgMjIyODMxNDogLy8gU2hpZnQgWiAgIFRlc3RcbiAgICAgICAgICAgICAgICAkKFwiI2NrZV8zX3RvcFwiKS50b2dnbGUoKTtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIGNhc2UgMzM0MjQwODogLy8gQ1RSTCBTaGlmdCBIICBIaWRlL3Nob3cgdG9vbCBiYXJcbiAgICAgICAgICAgICAgICAvLyBldnQuZGF0YS5zdG9wUHJvcGFnYXRpb24oKTtcbiAgICAgICAgICAgICAgICAvLyBldnQuZGF0YS5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgICAgICAgICAgICQoXCIjY2tlXzNfdG9wXCIpLnRvZ2dsZSgpO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgY2FzZSAxMTE0MTk1OiAvL0N0cmwgUyBzYXZlIGEgdmVyc2lvblxuICAgICAgICAgICAgICAgIHZlcnNpb24oKTtcbiAgICAgICAgICAgICAgICBpZiAoJCgnLnNhdmV0b2ZpbGUnKS5sZW5ndGggPiAwKVxuICAgICAgICAgICAgICAgICAgICBzYXZlKGV2dCwgXCJzYXZldG9maWxlXCIpO1xuXG4gICAgICAgICAgICAgICAgYnJlYWs7XG5cbiAgICAgICAgICAgIGNhc2UgMzM0MjQwNDogLy8gQ3RybCBTaGlmdCBEICBJbnNlcnQgZGV0YWlsL1N1bW1hcnkgaHRtbFxuICAgICAgICAgICAgICAgIHZhciBzZWwgPSBlZGl0b3IuZ2V0U2VsZWN0aW9uKCkuZ2V0U2VsZWN0ZWRUZXh0KCk7XG4gICAgICAgICAgICAgICAgaWYgKHNlbC5sZW5ndGggPiAwKSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciBkZXRhaWxzID0gbmV3IENLRURJVE9SLmRvbS5lbGVtZW50KCdkZXRhaWxzJyk7XG4gICAgICAgICAgICAgICAgICAgIGRldGFpbHMuc2V0SHRtbCgnIDxzdW1tYXJ5PicgKyBzZWwgKyAnPC9zdW1tYXJ5PjxwPk1vcmUgaW5mbyBhYm91dCB0aGUgZGV0YWlscy48L3A+Jyk7XG4gICAgICAgICAgICAgICAgICAgIGVkaXRvci5pbnNlcnRFbGVtZW50KGRldGFpbHMpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIGNhc2UgMTExNDE5MTogLy8gQ3RybCBPICBPcGVuIGNvZGVTbmlwcGV0IGRpYWxvZ1xuICAgICAgICAgICAgICAgIGVkaXRvci5leGVjQ29tbWFuZCgnY29kZVNuaXBwZXQnKTsgLy93aWRnZXRcbiAgICAgICAgICAgICAgICBicmVhaztcblxuICAgICAgICAgICAgY2FzZSAxMTE0MTg1OiAvLyBDdHJsIEkgIEluc2VydGh0bWxcbiAgICAgICAgICAgICAgICAvLyB2YXIgc2VsID0gZWRpdG9yLmdldFNlbGVjdGlvbigpLmdldFNlbGVjdGVkVGV4dCgpO1xuICAgICAgICAgICAgICAgIGN0cmxJID0gIWN0cmxJO1xuXG4gICAgICAgICAgICAgICAgLy8gZXZ0LmRhdGEuZGF0YVZhbHVlID0gZXZ0LmRhdGEuZGF0YVZhbHVlXG4gICAgICAgICAgICAgICAgLy8gZWRpdG9yLmZpcmUoICdwYXN0ZScsZWRpdG9yKTtcbiAgICAgICAgICAgICAgICAvLyBjb25zb2xlLmxvZyhlLmNsaXBib2FyZERhdGEuZ2V0RGF0YSgndGV4dC9odG1sJykpO1xuXG4gICAgICAgICAgICAgICAgLy8gVGhpcyBjb2RlIG9idmlvdXNseSB3aWxsIG5vdCBwcmVzZXJ2ZSB0aGUgY2FzZSBvZiB0aGUgZmlyc3QgYW5kIGxhc3QgbGV0dGVycy5cbiAgICAgICAgICAgICAgICAvLyBMZXQgaXQgYmUgYW4gZXhlcmNpc2UgZm9yIHRoZSByZWFkZXIgOykuXG4gICAgICAgICAgICAgICAgLy8gZWRpdG9yLmV4ZWNDb21tYW5kKCAnaW5zZXJ0aHRtbDR4Jyk7ICAvL3dpZGdldFxuXG4gICAgICAgICAgICAgICAgYnJlYWs7XG5cbiAgICAgICAgICAgIGNhc2UgMTExNDE4MjogLy8gQ3RybCBGIG9wZW4gZGlhbG9nIEZpbmQgYW5kIHJlcGxhY2VcbiAgICAgICAgICAgICAgICBlZGl0b3IuZXhlY0NvbW1hbmQoJ2ZpbmQnKTtcbiAgICAgICAgICAgICAgICBicmVhaztcblxuICAgICAgICAgICAgY2FzZSAzMzQyNDAyOiAvLyBDdHJsIFNoaWZ0IEJcbiAgICAgICAgICAgICAgICBlZGl0b3IuaW5zZXJ0SHRtbChcIjxici8+XCIpO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgIC8vIGNhc2UgNzc5ODg2ODovLyBDdHJsIEFMVCBTSElUIFRcbiAgICAgICAgICAgICAgICAvLyAgIGVkaXRvci5pbnNlcnRIdG1sKCBcIjx0YWJsZSBjbGFzcz10YWJsZTFDbGFzcycgPiA8dGJvZHk+IFxcXG4gICAgICAgICAgICAgICAgLy8gICAgICA8dHI+PHRkPjE8L3RkPjx0ZD4yPC90ZD48L3RyPjx0cj48dGQ+MTwvdGQ+PHRkPjI8L3RkPjwvdHI+IFxcXG4gICAgICAgICAgICAgICAgLy8gICAgICA8L3Rib2R5PjwvdGFibGU+XCIpO1xuICAgICAgICAgICAgICAgIC8vICAgLy8gIGVkaXRvci5pbnNlcnRIdG1sKCBjbGlwYm9hcmREYXRhKTtcbiAgICAgICAgICAgICAgICAvLyAgICAgLy8gY29uc29sZS5sb2coY2xpcGJvYXJkRGF0YSk7XG4gICAgICAgICAgICAgICAgLy8gICAgYnJlYWs7XG4gICAgICAgICAgICBjYXNlIDMzNDI0MjI6IC8vIEN0cm9sIHNoaWZ0IFZcbiAgICAgICAgICAgICAgICB0ZXh0byA9ICdDcnRsICsgU0hJRlQgVic7IC8vIEN0cmwgMVxuICAgICAgICAgICAgICAgIC8vIHRleHQgPSB3aW5kb3cuY2xpcGJvYXJkRGF0YS5nZXREYXRhKFwiVGV4dFwiKTtcbiAgICAgICAgICAgICAgICAvLyBjb25zb2xlLmxvZyh0ZXh0byk7XG4gICAgICAgICAgICAgICAgLy8gZWRpdG9yLmluc2VydEh0bWwoIGNsaXBib2FyZERhdGEpO1xuICAgICAgICAgICAgICAgIC8vIGNvbnNvbGUubG9nKHRleHRvKTtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgICAgICAgdGV4dG8gPSAnT3RoZXIga2V5JztcbiAgICAgICAgfVxuXG5cbiAgICAgICAgdmFyIGtleXByZXNzID0gWzExMTQxNjEsIDExMTQxNjIsIDExMTQxNjMsIDExMTQxNjQsIDExMTQxNjYsIDExMTQxNjksIDU1NzA2MzcsIDU1NzA2MjgsIDU1NzA2MzMsIDU1NzA2MzhdO1xuICAgICAgICAvLyBjb25zb2xlLmxvZyhrZXlwcmVzcy5pbmRleE9mKGNoYXJDb2RlKSk7XG4gICAgICAgIGlmIChrZXlwcmVzcy5pbmRleE9mKGNoYXJDb2RlKSA+IC0xKSB7IC8vIHJldGFnIHRoZSBzZWxlY3QgYXJlYVxuICAgICAgICAgICAgdmFyIHNlbCA9IGVkaXRvci5nZXRTZWxlY3Rpb24oKS5nZXRTZWxlY3RlZFRleHQoKTtcbiAgICAgICAgICAgIGlmIChzZWwubGVuZ3RoID4gMCkge1xuICAgICAgICAgICAgICAgIC8vICB2YXIgbmV3RWxlbWVudCA9IG5ldyBDS0VESVRPUi5kb20uZWxlbWVudCh0YWcpO1xuICAgICAgICAgICAgICAgIHZhciBuZXdFbGVtZW50ID0gQ0tFRElUT1IuZG9tLmVsZW1lbnQuY3JlYXRlRnJvbUh0bWwodGFnKVxuICAgICAgICAgICAgICAgIC8vIG5ld0VsZW1lbnQuc2V0QXR0cmlidXRlcyh7c3R5bGU6ICcnfSk7XG4gICAgICAgICAgICAgICAgbmV3RWxlbWVudC5zZXRUZXh0KHNlbCk7XG4gICAgICAgICAgICAgICAgZWRpdG9yLmluc2VydEVsZW1lbnQobmV3RWxlbWVudCk7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIHZhciBuZXdFbGVtZW50ID0gbmV3IENLRURJVE9SLmRvbS5lbGVtZW50KHRhZyk7XG4gICAgICAgICAgICAgICAgLy8gbmV3RWxlbWVudC5zZXRBdHRyaWJ1dGVzKHtzdHlsZTogJyd9KTtcbiAgICAgICAgICAgICAgICBuZXdFbGVtZW50LnNldFRleHQoc2VsKTtcbiAgICAgICAgICAgICAgICAvLyAgZWRpdG9yLmluc2VydEVsZW1lbnQobmV3RWxlbWVudCkuc2VsZWN0RWxlbWVudCgpO1xuICAgICAgICAgICAgICAgIC8vICBlZGl0b3IuZ2V0U2VsZWN0aW9uKCkuc2VsZWN0RWxlbWVudChuZXdFbGVtZW50KTtcblxuICAgICAgICAgICAgfVxuICAgICAgICB9XG5cblxuICAgIH0pO1xuXG5cblxuXG5cbiAgICAvLyBvdmVycmlkZSBzaG9ydGN1dCBmaXJlZm94IGtleWJvYXJkXG4gICAgJCgnLmZpcnN0X2VkaXRvcicpLmtleXByZXNzKGZ1bmN0aW9uKGV2ZW50KSB7XG5cbiAgICAgICAgLy8gY29uc29sZS5sb2coJzQnKTtcblxuXG4gICAgICAgIC8vIGNvbnNvbGUubG9nKCdldmVudG8gZXM6ICcrIGV2ZW50LmtleSArJ3NoaWZ0OiAnK2V2ZW50LmN0cmxLZXkgKyAnY3J0bDogJysgZXZlbnQuY3RybEtleSk7XG4gICAgICAgIHZhciBhID0gZXZlbnQua2V5O1xuICAgICAgICB2YXIgYiA9IGV2ZW50LmN0cmxLZXk7XG4gICAgICAgIHZhciBjID0gZXZlbnQuc2hpZnRLZXk7XG4gICAgICAgIHZhciBkID0gZXZlbnQuYWx0S2V5O1xuICAgICAgICB2YXIgcmVzcG9uc2UgPSBldmVudC5rZXkgKyBldmVudC5jdHJsS2V5ICsgZXZlbnQuc2hpZnRLZXkgKyBldmVudC5hbHRLZXk7XG4gICAgICAgIC8vICBjb25zb2xlLmxvZyhyZXNwb25zZSk7XG4gICAgICAgIC8vIGNvbnNvbGUubG9nKGIpO1xuICAgICAgICBzd2l0Y2ggKHRydWUpIHtcblxuXG4gICAgICAgICAgICBjYXNlIChhID09ICdGJyAmJiBiICYmIGMgJiYgZCk6XG4gICAgICAgICAgICAgICAgdmFyIHNlbCA9IGVkaXRvci5nZXRTZWxlY3Rpb24oKS5nZXRTZWxlY3RlZFRleHQoKTtcbiAgICAgICAgICAgICAgICBzZWwgPSBzZWwucmVwbGFjZSgvXFxzKy9nLCAnKycpOzsgLy9yZXBsYWNlIGFueSBzcGFjZSB3aXRoICtcbiAgICAgICAgICAgICAgICBvcGVuSW5OZXdUYWIoJ2h0dHBzOi8vZW4ud2lraXBlZGlhLm9yZy93L2luZGV4LnBocD9zZWFyY2g9JyArIHNlbCk7XG4gICAgICAgICAgICAgICAgLy8gY29uc29sZS5sb2coc2VsKTtcbiAgICAgICAgICAgICAgICBicmVhaztcblxuICAgICAgICAgICAgY2FzZSAoYSA9PSAnRicgJiYgYiAmJiBjKTpcbiAgICAgICAgICAgICAgICB2YXIgc2VsID0gZWRpdG9yLmdldFNlbGVjdGlvbigpLmdldFNlbGVjdGVkVGV4dCgpO1xuICAgICAgICAgICAgICAgIHNlbCA9IHNlbC5yZXBsYWNlKC9cXHMrL2csICcrJyk7OyAvL3JlcGxhY2UgYW55IHNwYWNlIHdpdGggK1xuICAgICAgICAgICAgICAgIG9wZW5Jbk5ld1RhYignaHR0cHM6Ly93d3cuZ29vZ2xlLmNvbS9zZWFyY2g/cT0nICsgc2VsKTtcbiAgICAgICAgICAgICAgICAvLyBjb25zb2xlLmxvZyhzZWwpO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuXG5cbiAgICAgICAgICAgIGNhc2UgKGEgPT0gJ0gnICYmIGIgJiYgYyk6XG4gICAgICAgICAgICBjYXNlIChhID09ICdzJyAmJiBiKTpcbiAgICAgICAgICAgICAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpOyAvL2F2b2lkIG90aGVyIHNob3J0Y3V0IGtleXNcbiAgICAgICAgICAgICAgICBicmVhaztcblxuICAgICAgICAgICAgICAgIC8vIGNhc2UgKGEgPT0gJ0wnICYmIGIgICYmIGMpIDogLy8gQ3RybCBTaGlmdCBMXG4gICAgICAgICAgICAgICAgLy8gICAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpOyAvL2F2b2lkIG90aGVyIHNob3J0Y3V0IGtleXNcbiAgICAgICAgICAgICAgICAvLyAgICAgdGV4dCA9IGVkaXRvci5nZXRDbGlwYm9hcmREYXRhKFwiVGV4dFwiKTtcbiAgICAgICAgICAgICAgICAvL1xuICAgICAgICAgICAgICAgIC8vICAgICAgY29uc29sZS5sb2codGV4dCk7XG4gICAgICAgICAgICAgICAgLy9cbiAgICAgICAgICAgICAgICAvLyBicmVhaztcblxuXG5cblxuICAgICAgICAgICAgY2FzZSAoYSA9PSAnaScgJiYgYiAmJiBkKTogLy9DdHJsIEFsdCBpXG4gICAgICAgICAgICAgICAgZWRpdG9yLmV4ZWNDb21tYW5kKCdtYXRoamF4Jyk7IC8vd2lkZ2V0XG4gICAgICAgICAgICAgICAgYnJlYWs7XG5cbiAgICAgICAgICAgIGNhc2UgKGEgPT0gJ2knICYmIGIpOlxuICAgICAgICAgICAgICAgIC8vIGNvbnNvbGUubG9nKCdwcmVzcyBjdHJsIEknKTtcbiAgICAgICAgICAgICAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpOyAvL2F2b2lkIG90aGVyIHNob3J0Y3V0IGtleXNcblxuICAgICAgICAgICAgICAgIGVkaXRvci5leGVjQ29tbWFuZCgnaW5zZXJ0aHRtbDR4Jyk7IC8vd2lkZ2V0XG4gICAgICAgICAgICAgICAgYnJlYWs7XG5cblxuXG4gICAgICAgIH1cblxuXG4gICAgICAgIC8vIGlmIChldmVudC5rZXkgPT09ICdIJyAmJiBldmVudC5jdHJsS2V5ICYmIGV2ZW50LnNoaWZ0S2V5ICApXG4gICAgICAgIC8vICAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgICAvLyBpZiAoZXZlbnQua2V5ID09PSAncycgJiYgZXZlbnQuY3RybEtleSAgKVxuICAgICAgICAvLyAgICAgZXZlbnQucHJldmVudERlZmF1bHQoKTtcbiAgICB9KTtcblxuXG4gICAgZWRpdG9yLm9uKCdwYXN0ZScsIGZ1bmN0aW9uKGV2dCkge1xuXG4gICAgICAgIC8vXG4gICAgICAgIC8vIGlmICggY3RybEkgPT0gMSl7XG4gICAgICAgIC8vXG4gICAgICAgIC8vICAgLy8gdmFyIGh0bWwgPSBlZGl0b3IuZ2V0Q2xpcGJvYXJkRGF0YShcIlRleHRcIik7XG4gICAgICAgIC8vICAgLy8gY29uc29sZS5sb2cgKFwicGFzdGUgZXZlbnRcIiArIGh0bWwpO1xuICAgICAgICAvLyAgIC8vIGVkaXRvci5pbnNlcnRIdG1sKGh0bWwpO1xuICAgICAgICAvLyAgIGN0cmxJPTA7XG4gICAgICAgIC8vICAgZWRpdG9yLmdldENsaXBib2FyZERhdGEoIHsgdGl0bGU6ICdHZXQgbXkgZGF0YScgfSwgZnVuY3Rpb24oIGRhdGEgKSB7XG4gICAgICAgIC8vICAgICAgIGlmICggZGF0YSApXG4gICAgICAgIC8vICAgICAgICAgICBjb25zb2xlLmxvZyggJ2RhdGEgaXM6ICcgKyBkYXRhLmRhdGFWYWx1ZSApO1xuICAgICAgICAvLyAgIH0gKTtcbiAgICAgICAgLy9cbiAgICAgICAgLy8gfVxuICAgICAgICAvL1xuXG5cblxuXG4gICAgICAgIC8vIGhpZ2hsaWdodGpzd29ya2VycygpO1xuICAgIH0pO1xuXG5cbiAgICBlZGl0b3Iub24oJ2ZvY3VzJywgZnVuY3Rpb24oZXZ0KSB7XG4gICAgICAgIC8vIGhpZ2hsaWdodGpzd29ya2VycygpO1xuICAgIH0pO1xuXG4gICAgZWRpdG9yLm9uKCdjbGljaycsIGZ1bmN0aW9uKGV2dCkge1xuXG4gICAgICAgIGNvbnNvbGUubG9nKCdjbGljaycpO1xuXG4gICAgfSk7XG5cbiAgICBlZGl0b3Iub24oJ2RvdWJsZWNsaWNrJywgZnVuY3Rpb24oZXZ0KSB7XG4gICAgICAgIHZhciBlbGVtZW50ID0gZXZ0LmRhdGEuZWxlbWVudDtcbiAgICAgICAgLy9jb25zb2xlLmxvZygnZG91YmxlY2xpY2snKTtcbiAgICAgICAgY2xhc3NlID0gZWxlbWVudC5nZXRBdHRyaWJ1dGUoXCJjbGFzc1wiKTtcbiAgICAgICAgY29uc29sZS5sb2coJ2RvdWJsZWNsaWNrIGluIGNsYXNzICcgKyBjbGFzc2UpXG4gICAgICAgIGlmIChjbGFzc2UgPT0gJ2ppZWJhJyl7XG5cbiAgICAgICAgICAgdHJhbnNsYXRlX3NlbGVjdCgpO1xuXG5cblxuICAgICAgICB9XG4gICAgICAgIGlmIChjbGFzc2UgPT0gJ3ZpZGVvbGluaycpIHtcbiAgICAgICAgICAgIGxvYWRWaWRlbyhlbGVtZW50KTtcbiAgICAgICAgfVxuICAgICAgICBjbGFzc2UgPSBlbGVtZW50LmdldEF0dHJpYnV0ZShcImNsYXNzXCIpO1xuICAgICAgICBpZiAoY2xhc3NlID09ICd2aWRlb2xpbmsnKSB7XG4gICAgICAgICAgICBsb2FkVmlkZW8oZWxlbWVudCk7XG4gICAgICAgIH1cbiAgICAgICAgdmFyIHRhZyA9IGVsZW1lbnQuZ2V0TmFtZSgpO1xuICAgICAgICAvLyBjb25zb2xlLmxvZyh0YWcpO1xuICAgICAgICBpZiAodGFnID09ICdhJykge1xuICAgICAgICAgICAgdXJsID0gZWxlbWVudC5nZXRBdHRyaWJ1dGUoXCJocmVmXCIpO1xuICAgICAgICAgICAgb3BlbkluTmV3VGFiKHVybCk7XG4gICAgICAgICAgICAvLyBjb25zb2xlLmxvZyAoJ2NsaWNrIGxpbmsnKyB1cmwpO1xuXG4gICAgICAgIH1cblxuICAgIH0pO1xuXG5cblxuXG4gICAgZWRpdG9yLm9uKCdibHVyJywgZnVuY3Rpb24oZXZ0KSB7XG5cbiAgICAgICAgY29uc29sZS5sb2coXCJibHVyclwiKTtcblxuICAgICAgICBzYXZlKGV2dCwgXCJzYXZlXCIpO1xuICAgICAgICAvLyBlZGl0b3IuZm9jdXMoKTtcblxuICAgIH0pO1xuXG5cbiAgICAvL2NoYW5nZSBldmVudFxuICAgIGVkaXRvci5vbignY2hhbmdlJywgZnVuY3Rpb24oZXZ0KSB7XG4gICAgICAgIC8vIGNvbnNvbGUubG9nKCAnVG90YWwgYnl0ZXM6ICcgKyBldnQuZWRpdG9yLmdldERhdGEoKS5sZW5ndGggKTtcbiAgICAgICAgLy8gY29uc29sZS5sb2coJ3NhdmVkJyskKCBcIiN0aXR0bGVcIiApLnZhbCgpKTtcbiAgICAgICAgLy8gJC5wb3N0KCBcIi9pbmMvc2F2ZS5waHBcIiwgeyBlZGl0YWJsZWRhdGE6IGV2dC5lZGl0b3IuZ2V0RGF0YSgpLCBlZGl0b3JJRDogJCggXCIjdGl0dGxlXCIgKS52YWwoKSB9ICk7XG5cbiAgICB9KTtcblxufSk7XG5cblxuZnVuY3Rpb24gb3BlbkluTmV3VGFiKHVybCkge1xuICAgIHZhciB3aW4gPSB3aW5kb3cub3Blbih1cmwsICdfYmxhbmsnKTtcbiAgICB3aW4uZm9jdXMoKTtcbn1cblxuZnVuY3Rpb24gaGFzaENvZGUoc3RyKSB7XG4gICAgdmFyIGhhc2ggPSAwO1xuICAgIGlmIChzdHIubGVuZ3RoID09IDApIHJldHVybiBoYXNoO1xuICAgIGZvciAoaSA9IDA7IGkgPCBzdHIubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgY2hhciA9IHN0ci5jaGFyQ29kZUF0KGkpO1xuICAgICAgICBoYXNoID0gKChoYXNoIDw8IDUpIC0gaGFzaCkgKyBjaGFyO1xuICAgICAgICBoYXNoID0gaGFzaCAmIGhhc2g7IC8vIENvbnZlcnQgdG8gMzJiaXQgaW50ZWdlclxuICAgIH1cbiAgICByZXR1cm4gaGFzaDtcbn1cblxuXG5mdW5jdGlvbiBjb252ZXJ0Q29pbih2YWx1ZSwgY29pbiwgdG9jb2luKSB7XG4gICAgY29uc29sZS5sb2coJ2NvbnZlcnRDb2luJylcblxuICAgIGxldCBhYSA9IFwiPHNwYW4gZGF0YS1jb3N0PSdcIiArIHZhbHVlICsgXCInIGRhdGEtY29pbj0nXCIgKyBjb2luICsgXCInIGRhdGEtY29pbi1jb252ZXJ0PSdcIiArIHRvY29pbiArIFwiJyBjbGFzcz0nY29zdCc+VG8gY29udmVydCBcIiArIGNvaW4gKyBcIiBpbnRvIFwiICsgdG9jb2luICsgXCIgXCIgKyB2YWx1ZSArIFwiPC9zcGFuPlwiXG4gICAgLy8gJCgndGQgcDpoYXMoc3Bhbi5jb3N0KScpLmFkZENsYXNzKCdtaWRkbGUnKTtcbiAgICByZXR1cm4gYWFcbn1cblxuXG5mdW5jdGlvbiBkb1NvbWV0aGluZygpIHtcbiAgICByZXR1cm4gbmV3IFByb21pc2UoKHJlc29sdmUsIHJlamVjdCkgPT4ge1xuICAgICAgICBjb25zb2xlLmxvZyhcIkl0IGlzIGRvbmUuXCIpO1xuICAgICAgICAvLyBTdWNjZWVkIGhhbGYgb2YgdGhlIHRpbWUuXG4gICAgICAgIGlmIChNYXRoLnJhbmRvbSgpID4gLjUpIHtcbiAgICAgICAgICAgIHJlc29sdmUoXCJTVUNDRVNTXCIpXG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICByZWplY3QoXCJGQUlMVVJFXCIpXG4gICAgICAgIH1cbiAgICB9KVxufVxuXG5mdW5jdGlvbiBmYW55aSh0ZXh0LCBsYW5nLCBsYW5ndG8pIHtcbiAgICByZXR1cm4gbmV3IFByb21pc2UoKHJlc29sdmUsIHJlamVjdCkgPT4ge1xuICAgICAgICBjb25zb2xlLmxvZyhgSXQgaXMgZG9uZS4gJHt0ZXh0fSAke2xhbmd9ICR7bGFuZ3RvfWApO1xuICAgICAgICAvLyBTdWNjZWVkIGhhbGYgb2YgdGhlIHRpbWUuXG4gICAgICAgIC8vIGxhbmcgPSAnemgnXG4gICAgICAgIC8vIGxhbmd0byA9ICdlbidcbiAgICAgICAgdmFyIHVybCA9IGRvY3VtZW50LmxvY2F0aW9uLm9yaWdpbiArJy9mYW55aSdcbiAgICAgICAgdmFyIGhlYWRlcnMgPSB7XG4gICAgICAgICAgICBcIkNvbnRlbnQtVHlwZVwiOiBcImFwcGxpY2F0aW9uL2pzb25cIlxuICAgICAgICB9O1xuICAgICAgICB2YXIgZGF0YSA9IHtcbiAgICAgICAgICAgIFwiZnJvbVwiOiBsYW5nLFxuICAgICAgICAgICAgXCJ0b1wiOiBsYW5ndG8sXG4gICAgICAgICAgICBcInNyY1wiOiB0ZXh0LFxuICAgICAgICAgICAgXCJpXCI6ICcxJ1xuICAgICAgICB9O1xuICAgICAgICBjb25zb2xlLmxvZygndGhpcyBpcyB0aGUgdGV4dCB0byB0cmFuc2xhdGUgJyArIHRleHQpXG5cbiAgICAgICAgdmFyIGVuY29kZV9wYXJhbXMgPSAkLnBhcmFtKGRhdGEsIHRydWUpXG4gICAgICAgIHZhciB1cmwgPSB1cmwgKyAnPycgKyBlbmNvZGVfcGFyYW1zXG5cbiAgICAgICAgJC5nZXRKU09OKHVybCwgZnVuY3Rpb24oZGF0YSkge1xuXG4gICAgICAgICAgICByZXNvbHZlKGRhdGEpXG4gICAgICAgIH0pO1xuXG5cbiAgICB9KVxuXG59XG5cblxuXG5cblxuXG5mdW5jdGlvbiBtZXNzYWdlKHN0cikge1xuXG4gICAgJChcIiN0ZXh0aW5mb1wiKS5odG1sKHN0cikuY3NzKHsgb3BhY2l0eTogMC45OSB9KTtcbiAgICAkKFwiI3RleHRpbmZvXCIpLmFuaW1hdGUoeyBvcGFjaXR5OiAwIH0sIDEyMDApO1xufVxuXG5mdW5jdGlvbiBiYXNlbmFtZShwYXRoLCBzdWZmaXgpIHtcbiAgICB2YXIgYiA9IHBhdGhcbiAgICB2YXIgbGFzdENoYXIgPSBiLmNoYXJBdChiLmxlbmd0aCAtIDEpXG5cbiAgICBpZiAobGFzdENoYXIgPT09ICcvJyB8fCBsYXN0Q2hhciA9PT0gJ1xcXFwnKSB7XG4gICAgICAgIGIgPSBiLnNsaWNlKDAsIC0xKVxuICAgIH1cblxuICAgIGIgPSBiLnJlcGxhY2UoL14uKltcXC9cXFxcXS9nLCAnJylcblxuICAgIGlmICh0eXBlb2Ygc3VmZml4ID09PSAnc3RyaW5nJyAmJiBiLnN1YnN0cihiLmxlbmd0aCAtIHN1ZmZpeC5sZW5ndGgpID09PSBzdWZmaXgpIHtcbiAgICAgICAgYiA9IGIuc3Vic3RyKDAsIGIubGVuZ3RoIC0gc3VmZml4Lmxlbmd0aClcbiAgICB9XG5cbiAgICByZXR1cm4gYlxufVxuXG5cbmZ1bmN0aW9uIGRpcm5hbWUocGF0aCkge1xuICAgIHJldHVybiBwYXRoLnJlcGxhY2UoL1xcXFwvZywgJy8nKS5yZXBsYWNlKC9cXC9bXlxcL10qXFwvPyQvLCAnJylcbn1cblxuZnVuY3Rpb24gYWdyZWdhdGV4dChzZWxlY3Rvcikge1xuICAgIHZhciB0ZXh0cyA9ICcnO1xuXG4gICAgJChcIi5maXJzdF9lZGl0b3JcIikuY2hpbGRyZW4oc2VsZWN0b3IpLmVhY2goZnVuY3Rpb24oKSB7XG5cbiAgICAgICAgJCh0aGlzKS5jaGlsZHJlbihcInBcIikuZWFjaChmdW5jdGlvbigpIHtcblxuICAgICAgICAgICAgdGV4dHMgKz0gJCh0aGlzKS50ZXh0KCkgKyBcIlxcclxcblwiO1xuXG4gICAgICAgIH0pO1xuXG4gICAgICAgIHZhciBhbGxMaXN0RWxlbWVudHMgPSAkKFwibGkgYnJcIik7XG5cbiAgICAgICAgJChcIi5maXJzdF9lZGl0b3JcIikuZmluZChhbGxMaXN0RWxlbWVudHMpLmVhY2goZnVuY3Rpb24oKVxuICAgICAgICAgICAgLy8gJCh0aGlzKS5uZXh0QWxsKFwibGlcIikuZWFjaChmdW5jdGlvbigpXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgdGV4dHMgKz0gXCIgIFwiICsgJCh0aGlzKS5jb250ZW50cygpLmdldCgwKS5ub2RlVmFsdWUgKyBcIlxcclxcblwiO1xuXG4gICAgICAgICAgICB9KTtcblxuXG5cblxuXG4gICAgfSk7XG5cblxuICAgIHJldHVybiB0ZXh0cztcbn1cblxuXG5cblxuXG5cbmZ1bmN0aW9uIHNhdmUoZXZ0LCBhY3Rpb24pIHtcblxuXG4gICAgc3dpdGNoIChhY3Rpb24pIHtcbiAgICAgICAgY2FzZSBcInNhdmVcIjogLy8gZWRpdG9yIHNhdmUgY29udGVudFxuICAgICAgICAgICAgY29uc29sZS5sb2coXCJlZGl0b3Igc2F2ZSAyXCIpO1xuICAgICAgICAgICAgJC5wb3N0KFwiL2luYy9zYXZlLnBocFwiLCB7IGFjdGlvbjogXCJzYXZlXCIsIGRhdGE6IGV2dC5lZGl0b3IuZ2V0RGF0YSgpLCBwYXRoOiBcIi9kYXRhL3J3MS9tMVwiLCBmaWxlOiAkKFwiI3RpdHRsZVwiKS52YWwoKSB9KTtcbiAgICAgICAgICAgIC8vICB0byBwcmV2ZW50IHRpbWUgY29uc3VtaW5nXG4gICAgICAgICAgICAvLyAgcmVhZCgpO1xuICAgICAgICAgICAgbWVzc2FnZShcImZpbGUgc2F2ZWRcIik7XG5cblxuXG5cbiAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICBjYXNlIFwic2F2ZXRvZmlsZVwiOlxuICAgICAgICAgICAgY29uc29sZS5sb2coXCJzYXZlIHRleHRcIik7XG4gICAgICAgICAgICB2YXIgZmlsZSA9ICQoXCIuZmlyc3RfZWRpdG9yXCIpLmNoaWxkcmVuKFwiLnBhdGhcIikudGV4dCgpO1xuICAgICAgICAgICAgY29uc29sZS5sb2coZmlsZSk7XG4gICAgICAgICAgICBtZXNzYWdlKFwiZmlsZSBzYXZlZCBcIiArIGZpbGUpO1xuXG5cbiAgICAgICAgICAgIC8vIHZhciBmaWxlID0gXCIvZGF0YS9tMy9tbS5tbVwiO1xuICAgICAgICAgICAgdmFyIHBhdGggPSBkaXJuYW1lKGZpbGUpO1xuICAgICAgICAgICAgdmFyIGZpbGUgPSBiYXNlbmFtZShmaWxlLCAnJyk7XG4gICAgICAgICAgICAvLyB2YXIgZGF0YT0nJztcbiAgICAgICAgICAgIC8vICQoXCIjc2F2ZXRvZmlsZVwiKS5lYWNoKGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgLy8gICAgZGF0YSA9IGRhdGEgICsgICQodGhpcykudmFsKCk7XG4gICAgICAgICAgICAvLyAgICAvL2NvZGVcbiAgICAgICAgICAgIC8vIH0pO1xuICAgICAgICAgICAgZGF0YSA9IGFncmVnYXRleHQoXCIuc2F2ZXRvZmlsZVwiKTtcbiAgICAgICAgICAgIC8vICBkYXRhPVwidGVzdFwiO1xuICAgICAgICAgICAgY29uc29sZS5sb2coZGF0YSk7XG4gICAgICAgICAgICBjb25zb2xlLmxvZyhwYXRoKTtcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKGZpbGUpO1xuXG4gICAgICAgICAgICAkLnBvc3QoXCIvaW5jL3NhdmUucGhwXCIsIHsgYWN0aW9uOiBcInNhdmVcIiwgZGF0YTogZGF0YSwgcGF0aDogcGF0aCwgZmlsZTogZmlsZSB9KTtcblxuXG4gICAgICAgICAgICAvLyBjb25zb2xlLmxvZyhwYXRoLmJhc2VuYW1lKHN0ciwgJy5odG1sJykpO1xuXG4gICAgICAgICAgICBicmVhaztcbiAgICAgICAgZGVmYXVsdDpcblxuXG4gICAgICAgICAgICBjb25zb2xlLmxvZyhcInNhdmUgZGVmYXVsdFwiKTtcblxuICAgIH1cblxuXG5cblxuICAgIC8vICBjb25zb2xlLmxvZyhcImhhc2NvZGUgaXMgaXM6IFwiICsgaGFzaENvZGUoJCggXCIjaGlkZGVuXCIgKS50ZXh0KCkpKTtcbiAgICAvLyBjb25zb2xlLmxvZyAoXCIxIFwiICtoYXNoQ29kZSgkKCBcIiNoaWRkZW5cIiApLnRleHQoKSkpO1xuICAgIC8vIGNvbnNvbGUubG9nIChcIjIgXCIgKyQoIFwiI2hhc2hcIiApLnRleHQoKSk7XG5cbn1cblxuXG5mdW5jdGlvbiByZWFkKCkge1xuXG5cblxuICAgICQuZ2V0KCcvbTEvJyArICQoXCIjdGl0dGxlXCIpLnZhbCgpLCB7IFwiX1wiOiAkLm5vdygpIH0sIGZ1bmN0aW9uKGRhdGEyKSB7XG4gICAgICAgIGNvbnNvbGUubG9nKFwicmVhZGluZyBmaWxlIFwiICsgJy9tMS8nICsgJChcIiN0aXR0bGVcIikudmFsKCkpO1xuXG5cbiAgICAgICAgLy8gY29uc29sZS5sb2coZGF0YSk7XG4gICAgICAgIC8vICAkKCcjaGlkZGVuJykuaHRtbChkYXRhMik7XG4gICAgICAgICQoJy5maXJzdF9lZGl0b3InKS5odG1sKGRhdGEyKTtcblxuICAgICAgICBoaWdobGlnaHRqc3dvcmtlcnMoKTtcblxuXG4gICAgICAgIC8vICQoJy5maXJzdF9lZGl0b3InKS5odG1sKGRhdGEpO1xuXG4gICAgfSkuZG9uZShmdW5jdGlvbigpIHtcblxuXG4gICAgICAgIC8vIGlmIChoYXNoQ29kZSgkKCBcIiNoaWRkZW5cIiApLnRleHQoKSkgPT0gJCggXCIjaGFzaFwiICkudGV4dCgpICAgKVxuICAgICAgICAvLyBtZXNzYWdlKFwibm8gbW9kaWZpYXRpb25zXCIpO1xuICAgICAgICAvLyBlbHNlIHtcbiAgICAgICAgLy8gICBtZXNzYWdlIChcInNhdmVkIVwiKVxuICAgICAgICAvLyAgICQoIFwiI2hhc2hcIiApLmh0bWwoaGFzaENvZGUoJCggXCIjaGlkZGVuXCIgKS50ZXh0KCkpKTt9XG4gICAgICAgIC8vXG4gICAgfSkuZmFpbChmdW5jdGlvbigpIHtcbiAgICAgICAgLy8kKCcuZmlyc3RfZWRpdG9yJykuaHRtbChcIjxoMT5lcnJvciA0MDQgbm8gZmlsZTwvaDE+XCIpOyAvLyBvciB3aGF0ZXZlclxuICAgIH0sICd0ZXh0Jyk7XG5cbn1cblxuZnVuY3Rpb24gaGlnaGxpZ2h0anN3b3JrZXJzKCkge1xuXG4gICAgLy8gaGxqcy5pbml0SGlnaGxpZ2h0aW5nT25Mb2FkKCk7XG4gICAgJCgncHJlIGNvZGUnKS5lYWNoKGZ1bmN0aW9uKGksIGJsb2NrKSB7XG4gICAgICAgIGhsanMuaGlnaGxpZ2h0QmxvY2soYmxvY2spO1xuICAgIH0pO1xuXG4gICAgLy8gIHZhciBjb2RlID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcigncHJlIGNvZGUnKTtcbiAgICAvLyAgdmFyIHdvcmtlciA9IG5ldyBXb3JrZXIoJy9qcy93b3JrZXIuanMnKTtcbiAgICAvLyAgaWYgKCF3b3JrZXIub25tZXNzYWdlKSB7Ly9hdm9pZCBudWxsIG9iamVjdCBpbiBjYXNlIGRvZXNudCBleGlzdHNcbiAgICAvLyAgd29ya2VyLm9ubWVzc2FnZSA9IGZ1bmN0aW9uKGV2ZW50KSB7IGNvZGUuaW5uZXJIVE1MID0gZXZlbnQuZGF0YTsgfVxuICAgIC8vIC8vIHdvcmtlci5wb3N0TWVzc2FnZShjb2RlLnRleHRDb250ZW50KTtcbiAgICAvLyB9XG59O1xuXG5cbi8vcmVuYW1lIGZpbGVcbmZ1bmN0aW9uIHJlbmFtZSgpIHtcblxuICAgIGNvbnNvbGUubG9nKFwiY2hhbmdlIHRoaXMgZmlsZTogXCIgKyAkKFwiI3RpdHRsZVwiKS52YWwoKSArIFwiIGJ5IHRoaXMgZmlsZTogXCIgKyAkKFwiI3JlbmFtZVwiKS52YWwoKSk7XG4gICAgJC5wb3N0KFwiL2luYy9zYXZlLnBocFwiLCB7IGFjdGlvbjogXCJyZW5hbWVcIiwgZmlsZTogJChcIiN0aXR0bGVcIikudmFsKCksIHBhdGg6IFwiL2RhdGEvcncxL20xXCIsIGZpbGVvdXQ6ICQoXCIjcmVuYW1lXCIpLnZhbCgpIH0sIGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgJChcIiN0aXR0bGVcIikudmFsKCQoXCIjcmVuYW1lXCIpLnZhbCgpKTtcbiAgICAgICAgfSlcbiAgICAgICAgLmRvbmUoZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICBtZXNzYWdlKFwiZmlsZSByZW5hbWVkIHRvIFwiICsgJChcIiNyZW5hbWVcIikudmFsKCkpO1xuICAgICAgICB9KVxuICAgICAgICAuZmFpbChmdW5jdGlvbigpIHtcbiAgICAgICAgICAgIGFsZXJ0KFwiZXJyb3JcIik7XG4gICAgICAgIH0pO1xuXG59O1xuXG5cbi8vcmVuYW1lIGZpbGVcbmZ1bmN0aW9uIHZlcnNpb24oKSB7XG5cbiAgICBjb25zb2xlLmxvZyhcImNyZWF0aW5nIGEgbmV3IHZlcnNpb24gb2YgdGhpczogXCIgKyAkKFwiI3RpdHRsZVwiKS52YWwoKSk7XG5cbiAgICAkLnBvc3QoXCIvaW5jL3NhdmUucGhwXCIsIHsgYWN0aW9uOiBcInZlcnNpb25cIiwgZmlsZTogJChcIiN0aXR0bGVcIikudmFsKCksIHBhdGg6IFwiL2RhdGEvcncxL20xXCIsIGZpbGVvdXQ6ICQoXCIjcmVuYW1lXCIpLnZhbCgpIH0sIGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgJChcIiN0aXR0bGVcIikudmFsKCQoXCIjcmVuYW1lXCIpLnZhbCgpKTtcbiAgICAgICAgfSlcbiAgICAgICAgLmRvbmUoZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICBtZXNzYWdlKFwiTmV3IHZlcnNpb24gYmFja2VkXCIpO1xuICAgICAgICB9KVxuICAgICAgICAuZmFpbChmdW5jdGlvbigpIHtcbiAgICAgICAgICAgIGFsZXJ0KFwiZXJyb3JcIik7XG4gICAgICAgIH0pO1xuXG59O1xuXG5cblxuXG5cblxuZnVuY3Rpb24gbG9hZGF1dG9zZWFyY2goc291cmNlKSB7XG5cbiAgICB2YXIgb3B0aW9ucyA9IHtcbiAgICAgICAgdXJsOiBzb3VyY2UsXG4gICAgICAgIGdldFZhbHVlOiBcImZpbGVuYW1lXCIsXG4gICAgICAgIC8vIG1pbkxlbmd0aDogMyxcbiAgICAgICAgLy8gIGF1dG9Gb2N1czogdHJ1ZSxcbiAgICAgICAgLy8gIG15IDogXCIxMDAgMTAwXCIsXG4gICAgICAgIC8vICBhdDogXCJib3R0b21cIiAsXG4gICAgICAgIC8vICBvZjpcIiN0aXR0bGVcIixcblxuICAgICAgICB0ZW1wbGF0ZToge1xuICAgICAgICAgICAgdHlwZTogXCJkZXNjcmlwdGlvblwiLFxuICAgICAgICAgICAgZmllbGRzOiB7XG4gICAgICAgICAgICAgICAgLy8gZGVzY3JpcHRpb246IFwiZW1haWxcIlxuICAgICAgICAgICAgfVxuICAgICAgICB9LFxuICAgICAgICBsaXN0OiB7XG4gICAgICAgICAgICBtYXRjaDoge1xuICAgICAgICAgICAgICAgIGVuYWJsZWQ6IHRydWVcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSxcblxuICAgICAgICB0aGVtZTogXCJwbGF0ZS1kYXJrXCJcbiAgICB9O1xuXG4gICAgJChcIiN0aXR0bGVcIikuZWFzeUF1dG9jb21wbGV0ZShvcHRpb25zKTtcblxufTtcblxuXG5cblxuZnVuY3Rpb24gbG9hZFZpZGVvKGVsZW1lbnQpIHtcblxuICAgIGNvbnNvbGUubG9nKCdlbGVtZW50IGlzIHZpZGVvbGluaycpO1xuICAgIGNvbnNvbGUubG9nKGVsZW1lbnQuZ2V0QXR0cmlidXRlKFwidmFsdWVcIikpO1xuICAgIHNyYyA9IGVsZW1lbnQuZ2V0QXR0cmlidXRlKFwidmFsdWVcIik7XG4gICAgLy8gJCgndmlkZW8udmlkZW9yZWFkIHNvdXJjZScpLmF0dHIoJ3NyYycsIHNyYyk7XG4gICAgJCgnI215LXBsYXllcl9odG1sNV9hcGknKS5hdHRyKCdzcmMnLCBzcmMpO1xuICAgICQoJyNteS1wbGF5ZXJfaHRtbDVfYXBpJykubG9hZCgpO1xuICAgICQoJyNteS1wbGF5ZXJfaHRtbDVfYXBpJykucGxheSgpO1xuICAgIC8vICQoXCJ2aWRlby52aWRlb3JlYWRcIilbMF0ubG9hZCgpO1xuICAgIC8vICQoXCJ2aWRlby52aWRlb3JlYWRcIilbMF0ucGxheSgpO1xuICAgIC8vIGV2dC5kYXRhLmRpYWxvZyA9ICd0YWJsZVByb3BlcnRpZXMnICAgO1xuXG59XG5cblxuXG5mdW5jdGlvbiBnZXRQYXJhbWV0ZXJCeU5hbWUobmFtZSwgdXJsKSB7XG4gICAgaWYgKCF1cmwpIHVybCA9IHdpbmRvdy5sb2NhdGlvbi5ocmVmO1xuICAgIG5hbWUgPSBuYW1lLnJlcGxhY2UoL1tcXFtcXF1dL2csIFwiXFxcXCQmXCIpO1xuICAgIHZhciByZWdleCA9IG5ldyBSZWdFeHAoXCJbPyZdXCIgKyBuYW1lICsgXCIoPShbXiYjXSopfCZ8I3wkKVwiKSxcbiAgICAgICAgcmVzdWx0cyA9IHJlZ2V4LmV4ZWModXJsKTtcbiAgICBpZiAoIXJlc3VsdHMpIHJldHVybiBudWxsO1xuICAgIGlmICghcmVzdWx0c1syXSkgcmV0dXJuICcnO1xuICAgIHJldHVybiBkZWNvZGVVUklDb21wb25lbnQocmVzdWx0c1syXS5yZXBsYWNlKC9cXCsvZywgXCIgXCIpKTtcbn1cblxuXG5mdW5jdGlvbiBpbnNlcnRCYWlkdW1hcCgpIHtcblxuXG4gICAgdmFyIG1hcCA9IG5ldyBCTWFwLk1hcChcImFsbG1hcFwiKTsgLy8g5Yib5bu6TWFw5a6e5L6LXG4gICAgbWFwLmNlbnRlckFuZFpvb20obmV3IEJNYXAuUG9pbnQoMTE2LjQwNCwgMzkuOTE1KSwgMTEpOyAvLyDliJ3lp4vljJblnLDlm74s6K6+572u5Lit5b+D54K55Z2Q5qCH5ZKM5Zyw5Zu+57qn5YirXG4gICAgLy/mt7vliqDlnLDlm77nsbvlnovmjqfku7ZcbiAgICBtYXAuYWRkQ29udHJvbChuZXcgQk1hcC5NYXBUeXBlQ29udHJvbCh7XG4gICAgICAgIG1hcFR5cGVzOiBbXG4gICAgICAgICAgICBCTUFQX05PUk1BTF9NQVAsXG4gICAgICAgICAgICBCTUFQX0hZQlJJRF9NQVBcbiAgICAgICAgXVxuICAgIH0pKTtcbiAgICBtYXAuc2V0Q3VycmVudENpdHkoXCLljJfkuqxcIik7IC8vIOiuvue9ruWcsOWbvuaYvuekuueahOWfjuW4giDmraTpobnmmK/lv4Xpobvorr7nva7nmoRcbiAgICBtYXAuZW5hYmxlU2Nyb2xsV2hlZWxab29tKHRydWUpOyAvL+W8gOWQr+m8oOagh+a7mui9rue8qeaUvlxuXG59IiwiLyohXG4gKiBtb25leS5qcyAvIGZ4KCkgdjAuMlxuICogQ29weXJpZ2h0IDIwMTQgT3BlbiBFeGNoYW5nZSBSYXRlc1xuICpcbiAqIEphdmFTY3JpcHQgbGlicmFyeSBmb3IgcmVhbHRpbWUgY3VycmVuY3kgY29udmVyc2lvbiBhbmQgZXhjaGFuZ2UgcmF0ZSBjYWxjdWxhdGlvbi5cbiAqXG4gKiBGcmVlbHkgZGlzdHJpYnV0YWJsZSB1bmRlciB0aGUgTUlUIGxpY2Vuc2UuXG4gKiBQb3J0aW9ucyBvZiBtb25leS5qcyBhcmUgaW5zcGlyZWQgYnkgb3IgYm9ycm93ZWQgZnJvbSB1bmRlcnNjb3JlLmpzXG4gKlxuICogRm9yIGRldGFpbHMsIGV4YW1wbGVzIGFuZCBkb2N1bWVudGF0aW9uOlxuICogaHR0cDovL29wZW5leGNoYW5nZXJhdGVzLmdpdGh1Yi5pby9tb25leS5qcy9cbiAqL1xuKGZ1bmN0aW9uKHJvb3QsIHVuZGVmaW5lZCkge1xuXG5cdC8vIENyZWF0ZSBhIHNhZmUgcmVmZXJlbmNlIHRvIHRoZSBtb25leS5qcyBvYmplY3QgZm9yIHVzZSBiZWxvdy5cblx0dmFyIGZ4ID0gZnVuY3Rpb24ob2JqKSB7XG5cdFx0cmV0dXJuIG5ldyBmeFdyYXBwZXIob2JqKTtcblx0fTtcblxuXHQvLyBDdXJyZW50IHZlcnNpb24uXG5cdGZ4LnZlcnNpb24gPSAnMC4yJztcblxuXG5cdC8qIC0tLSBTZXR1cCAtLS0gKi9cblxuXHQvLyBmeFNldHVwIGNhbiBiZSBkZWZpbmVkIGJlZm9yZSBsb2FkaW5nIG1vbmV5LmpzLCB0byBzZXQgdGhlIGV4Y2hhbmdlIHJhdGVzIGFuZCB0aGUgYmFzZVxuXHQvLyAoYW5kIGRlZmF1bHQgZnJvbS90bykgY3VycmVuY2llcyAtIG9yIHRoZSByYXRlcyBjYW4gYmUgbG9hZGVkIGluIGxhdGVyIGlmIG5lZWRlZC5cblx0dmFyIGZ4U2V0dXAgPSByb290LmZ4U2V0dXAgfHwge1xuXHRcdHJhdGVzIDoge30sXG5cdFx0YmFzZSA6IFwiXCJcblx0fTtcblxuXHQvLyBPYmplY3QgY29udGFpbmluZyBleGNoYW5nZSByYXRlcyByZWxhdGl2ZSB0byB0aGUgZnguYmFzZSBjdXJyZW5jeSwgZWcgeyBcIkdCUFwiIDogXCIwLjY0XCIgfVxuXHRmeC5yYXRlcyA9IGZ4U2V0dXAucmF0ZXM7XG5cblx0Ly8gRGVmYXVsdCBleGNoYW5nZSByYXRlIGJhc2UgY3VycmVuY3kgKGVnIFwiVVNEXCIpLCB3aGljaCBhbGwgdGhlIGV4Y2hhbmdlIHJhdGVzIGFyZSByZWxhdGl2ZSB0b1xuXHRmeC5iYXNlID0gZnhTZXR1cC5iYXNlO1xuXG5cdC8vIERlZmF1bHQgZnJvbSAvIHRvIGN1cnJlbmNpZXMgZm9yIGNvbnZlcnNpb24gdmlhIGZ4LmNvbnZlcnQoKTpcblx0Znguc2V0dGluZ3MgPSB7XG5cdFx0ZnJvbSA6IGZ4U2V0dXAuZnJvbSB8fCBmeC5iYXNlLFxuXHRcdHRvIDogZnhTZXR1cC50byB8fCBmeC5iYXNlXG5cdH07XG5cblxuXHQvKiAtLS0gQ29udmVyc2lvbiAtLS0gKi9cblxuXHQvLyBUaGUgYmFzZSBmdW5jdGlvbiBvZiB0aGUgbGlicmFyeTogY29udmVydHMgYSB2YWx1ZSBmcm9tIG9uZSBjdXJyZW5jeSB0byBhbm90aGVyXG5cdHZhciBjb252ZXJ0ID0gZnguY29udmVydCA9IGZ1bmN0aW9uKHZhbCwgb3B0cykge1xuXHRcdC8vIENvbnZlcnQgYXJyYXlzIHJlY3Vyc2l2ZWx5XG5cdFx0aWYgKHR5cGVvZiB2YWwgPT09ICdvYmplY3QnICYmIHZhbC5sZW5ndGgpIHtcblx0XHRcdGZvciAodmFyIGkgPSAwOyBpPCB2YWwubGVuZ3RoOyBpKysgKSB7XG5cdFx0XHRcdHZhbFtpXSA9IGNvbnZlcnQodmFsW2ldLCBvcHRzKTtcblx0XHRcdH1cblx0XHRcdHJldHVybiB2YWw7XG5cdFx0fVxuXG5cdFx0Ly8gTWFrZSBzdXJlIHdlIGdvdHMgc29tZSBvcHRzXG5cdFx0b3B0cyA9IG9wdHMgfHwge307XG5cblx0XHQvLyBXZSBuZWVkIHRvIGtub3cgdGhlIGBmcm9tYCBhbmQgYHRvYCBjdXJyZW5jaWVzXG5cdFx0aWYoICFvcHRzLmZyb20gKSBvcHRzLmZyb20gPSBmeC5zZXR0aW5ncy5mcm9tO1xuXHRcdGlmKCAhb3B0cy50byApIG9wdHMudG8gPSBmeC5zZXR0aW5ncy50bztcblxuXHRcdC8vIE11bHRpcGxlIHRoZSB2YWx1ZSBieSB0aGUgZXhjaGFuZ2UgcmF0ZVxuXHRcdHJldHVybiB2YWwgKiBnZXRSYXRlKCBvcHRzLnRvLCBvcHRzLmZyb20gKTtcblx0fTtcblxuXHQvLyBSZXR1cm5zIHRoZSBleGNoYW5nZSByYXRlIHRvIGB0YXJnZXRgIGN1cnJlbmN5IGZyb20gYGJhc2VgIGN1cnJlbmN5XG5cdHZhciBnZXRSYXRlID0gZnVuY3Rpb24odG8sIGZyb20pIHtcblx0XHQvLyBTYXZlIGJ5dGVzIGluIG1pbmlmaWVkIHZlcnNpb25cblx0XHR2YXIgcmF0ZXMgPSBmeC5yYXRlcztcblxuXHRcdC8vIE1ha2Ugc3VyZSB0aGUgYmFzZSByYXRlIGlzIGluIHRoZSByYXRlcyBvYmplY3Q6XG5cdFx0cmF0ZXNbZnguYmFzZV0gPSAxO1xuXG5cdFx0Ly8gVGhyb3cgYW4gZXJyb3IgaWYgZWl0aGVyIHJhdGUgaXNuJ3QgaW4gdGhlIHJhdGVzIGFycmF5XG5cdFx0aWYgKCAhcmF0ZXNbdG9dIHx8ICFyYXRlc1tmcm9tXSApIHRocm93IFwiZnggZXJyb3JcIjtcblxuXHRcdC8vIElmIGBmcm9tYCBjdXJyZW5jeSA9PT0gZnguYmFzZSwgcmV0dXJuIHRoZSBiYXNpYyBleGNoYW5nZSByYXRlIGZvciB0aGUgYHRvYCBjdXJyZW5jeVxuXHRcdGlmICggZnJvbSA9PT0gZnguYmFzZSApIHtcblx0XHRcdHJldHVybiByYXRlc1t0b107XG5cdFx0fVxuXG5cdFx0Ly8gSWYgYHRvYCBjdXJyZW5jeSA9PT0gZnguYmFzZSwgcmV0dXJuIHRoZSBiYXNpYyBpbnZlcnNlIHJhdGUgb2YgdGhlIGBmcm9tYCBjdXJyZW5jeVxuXHRcdGlmICggdG8gPT09IGZ4LmJhc2UgKSB7XG5cdFx0XHRyZXR1cm4gMSAvIHJhdGVzW2Zyb21dO1xuXHRcdH1cblxuXHRcdC8vIE90aGVyd2lzZSwgcmV0dXJuIHRoZSBgdG9gIHJhdGUgbXVsdGlwbGVkIGJ5IHRoZSBpbnZlcnNlIG9mIHRoZSBgZnJvbWAgcmF0ZSB0byBnZXQgdGhlXG5cdFx0Ly8gcmVsYXRpdmUgZXhjaGFuZ2UgcmF0ZSBiZXR3ZWVuIHRoZSB0d28gY3VycmVuY2llc1xuXHRcdHJldHVybiByYXRlc1t0b10gKiAoMSAvIHJhdGVzW2Zyb21dKTtcblx0fTtcblxuXG5cdC8qIC0tLSBPT1Agd3JhcHBlciBhbmQgY2hhaW5pbmcgLS0tICovXG5cblx0Ly8gSWYgZngodmFsKSBpcyBjYWxsZWQgYXMgYSBmdW5jdGlvbiwgaXQgcmV0dXJucyBhIHdyYXBwZWQgb2JqZWN0IHRoYXQgY2FuIGJlIHVzZWQgT08tc3R5bGVcblx0dmFyIGZ4V3JhcHBlciA9IGZ1bmN0aW9uKHZhbCkge1xuXHRcdC8vIEV4cGVyaW1lbnRhbDogcGFyc2Ugc3RyaW5ncyB0byBwdWxsIG91dCBjdXJyZW5jeSBjb2RlIGFuZCB2YWx1ZTpcblx0XHRpZiAoIHR5cGVvZlx0dmFsID09PSBcInN0cmluZ1wiICkge1xuXHRcdFx0dGhpcy5fdiA9IHBhcnNlRmxvYXQodmFsLnJlcGxhY2UoL1teMC05LS5dL2csIFwiXCIpKTtcblx0XHRcdHRoaXMuX2Z4ID0gdmFsLnJlcGxhY2UoLyhbXkEtWmEtel0pL2csIFwiXCIpO1xuXHRcdH0gZWxzZSB7XG5cdFx0XHR0aGlzLl92ID0gdmFsO1xuXHRcdH1cblx0fTtcblxuXHQvLyBFeHBvc2UgYHdyYXBwZXIucHJvdG90eXBlYCBhcyBgZngucHJvdG90eXBlYFxuXHR2YXIgZnhQcm90byA9IGZ4LnByb3RvdHlwZSA9IGZ4V3JhcHBlci5wcm90b3R5cGU7XG5cblx0Ly8gZngodmFsKS5jb252ZXJ0KG9wdHMpIGRvZXMgdGhlIHNhbWUgdGhpbmcgYXMgZnguY29udmVydCh2YWwsIG9wdHMpXG5cdGZ4UHJvdG8uY29udmVydCA9IGZ1bmN0aW9uKCkge1xuXHRcdHZhciBhcmdzID0gQXJyYXkucHJvdG90eXBlLnNsaWNlLmNhbGwoYXJndW1lbnRzKTtcblx0XHRhcmdzLnVuc2hpZnQodGhpcy5fdik7XG5cdFx0cmV0dXJuIGNvbnZlcnQuYXBwbHkoZngsIGFyZ3MpO1xuXHR9O1xuXG5cdC8vIGZ4KHZhbCkuZnJvbShjdXJyZW5jeSkgcmV0dXJucyBhIHdyYXBwZWQgYGZ4YCB3aGVyZSB0aGUgdmFsdWUgaGFzIGJlZW4gY29udmVydGVkIGZyb21cblx0Ly8gYGN1cnJlbmN5YCB0byB0aGUgYGZ4LmJhc2VgIGN1cnJlbmN5LiBTaG91bGQgYmUgZm9sbG93ZWQgYnkgYC50byhvdGhlckN1cnJlbmN5KWBcblx0ZnhQcm90by5mcm9tID0gZnVuY3Rpb24oY3VycmVuY3kpIHtcblx0XHR2YXIgd3JhcHBlZCA9IGZ4KGNvbnZlcnQodGhpcy5fdiwge2Zyb206IGN1cnJlbmN5LCB0bzogZnguYmFzZX0pKTtcblx0XHR3cmFwcGVkLl9meCA9IGZ4LmJhc2U7XG5cdFx0cmV0dXJuIHdyYXBwZWQ7XG5cdH07XG5cblx0Ly8gZngodmFsKS50byhjdXJyZW5jeSkgcmV0dXJucyB0aGUgdmFsdWUsIGNvbnZlcnRlZCBmcm9tIGBmeC5iYXNlYCB0byBgY3VycmVuY3lgXG5cdGZ4UHJvdG8udG8gPSBmdW5jdGlvbihjdXJyZW5jeSkge1xuXHRcdHJldHVybiBjb252ZXJ0KHRoaXMuX3YsIHtmcm9tOiB0aGlzLl9meCA/IHRoaXMuX2Z4IDogZnguc2V0dGluZ3MuZnJvbSwgdG86IGN1cnJlbmN5fSk7XG5cdH07XG5cblxuXHQvKiAtLS0gTW9kdWxlIERlZmluaXRpb24gLS0tICovXG5cblx0Ly8gRXhwb3J0IHRoZSBmeCBvYmplY3QgZm9yIENvbW1vbkpTLiBJZiBiZWluZyBsb2FkZWQgYXMgYW4gQU1EIG1vZHVsZSwgZGVmaW5lIGl0IGFzIHN1Y2guXG5cdC8vIE90aGVyd2lzZSwganVzdCBhZGQgYGZ4YCB0byB0aGUgZ2xvYmFsIG9iamVjdFxuXHRpZiAodHlwZW9mIGV4cG9ydHMgIT09ICd1bmRlZmluZWQnKSB7XG5cdFx0aWYgKHR5cGVvZiBtb2R1bGUgIT09ICd1bmRlZmluZWQnICYmIG1vZHVsZS5leHBvcnRzKSB7XG5cdFx0XHRleHBvcnRzID0gbW9kdWxlLmV4cG9ydHMgPSBmeDtcblx0XHR9XG5cdFx0ZXhwb3J0cy5meCA9IGZ4O1xuXHR9IGVsc2UgaWYgKHR5cGVvZiBkZWZpbmUgPT09ICdmdW5jdGlvbicgJiYgZGVmaW5lLmFtZCkge1xuXHRcdC8vIFJldHVybiB0aGUgbGlicmFyeSBhcyBhbiBBTUQgbW9kdWxlOlxuXHRcdGRlZmluZShbXSwgZnVuY3Rpb24oKSB7XG5cdFx0XHRyZXR1cm4gZng7XG5cdFx0fSk7XG5cdH0gZWxzZSB7XG5cdFx0Ly8gVXNlIGZ4Lm5vQ29uZmxpY3QgdG8gcmVzdG9yZSBgZnhgIGJhY2sgdG8gaXRzIG9yaWdpbmFsIHZhbHVlIGJlZm9yZSBtb25leS5qcyBsb2FkZWQuXG5cdFx0Ly8gUmV0dXJucyBhIHJlZmVyZW5jZSB0byB0aGUgbGlicmFyeSdzIGBmeGAgb2JqZWN0OyBlLmcuIGB2YXIgbW9uZXkgPSBmeC5ub0NvbmZsaWN0KCk7YFxuXHRcdGZ4Lm5vQ29uZmxpY3QgPSAoZnVuY3Rpb24ocHJldmlvdXNGeCkge1xuXHRcdFx0cmV0dXJuIGZ1bmN0aW9uKCkge1xuXHRcdFx0XHQvLyBSZXNldCB0aGUgdmFsdWUgb2YgdGhlIHJvb3QncyBgZnhgIHZhcmlhYmxlOlxuXHRcdFx0XHRyb290LmZ4ID0gcHJldmlvdXNGeDtcblx0XHRcdFx0Ly8gRGVsZXRlIHRoZSBub0NvbmZsaWN0IGZ1bmN0aW9uOlxuXHRcdFx0XHRmeC5ub0NvbmZsaWN0ID0gdW5kZWZpbmVkO1xuXHRcdFx0XHQvLyBSZXR1cm4gcmVmZXJlbmNlIHRvIHRoZSBsaWJyYXJ5IHRvIHJlLWFzc2lnbiBpdDpcblx0XHRcdFx0cmV0dXJuIGZ4O1xuXHRcdFx0fTtcblx0XHR9KShyb290LmZ4KTtcblxuXHRcdC8vIERlY2xhcmUgYGZ4YCBvbiB0aGUgcm9vdCAoZ2xvYmFsL3dpbmRvdykgb2JqZWN0OlxuXHRcdHJvb3RbJ2Z4J10gPSBmeDtcblx0fVxuXG5cdC8vIFJvb3Qgd2lsbCBiZSBgd2luZG93YCBpbiBicm93c2VyIG9yIGBnbG9iYWxgIG9uIHRoZSBzZXJ2ZXI6XG59KHRoaXMpKTtcbiJdfQ=="}